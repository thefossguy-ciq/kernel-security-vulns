From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39714: media: usbtv: Lock resolution while streaming

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

media: usbtv: Lock resolution while streaming

When an program is streaming (ffplay) and another program (qv4l2)
changes the TV standard from NTSC to PAL, the kernel crashes due to trying
to copy to unmapped memory.

Changing from NTSC to PAL increases the resolution in the usbtv struct,
but the video plane buffer isn't adjusted, so it overflows.

[hverkuil: call vb2_is_busy instead of vb2_is_streaming]

The Linux kernel CVE team has assigned CVE-2025-39714 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.14 with commit 0e0fe3958fdd13dbf55c3a787acafde6efd04272 and fixed in 5.4.297 with commit c35e7c7a004ef379a1ae7c7486d4829419acad1d
	Issue introduced in 3.14 with commit 0e0fe3958fdd13dbf55c3a787acafde6efd04272 and fixed in 5.10.241 with commit ee7bade8b9244834229b12b6e1e724939bedd484
	Issue introduced in 3.14 with commit 0e0fe3958fdd13dbf55c3a787acafde6efd04272 and fixed in 5.15.190 with commit 5427dda195d6baf23028196fd55a0c90f66ffa61
	Issue introduced in 3.14 with commit 0e0fe3958fdd13dbf55c3a787acafde6efd04272 and fixed in 6.1.149 with commit ef9b3c22405192afaa279077ddd45a51db90b83d
	Issue introduced in 3.14 with commit 0e0fe3958fdd13dbf55c3a787acafde6efd04272 and fixed in 6.6.103 with commit 3d83d0b5ae5045a7a246ed116b5f6c688a12f9e9
	Issue introduced in 3.14 with commit 0e0fe3958fdd13dbf55c3a787acafde6efd04272 and fixed in 6.12.44 with commit c3d75524e10021aa5c223d94da4996640aed46c0
	Issue introduced in 3.14 with commit 0e0fe3958fdd13dbf55c3a787acafde6efd04272 and fixed in 6.16.4 with commit 9f886d21e235c4bd038cb20f6696084304197ab3
	Issue introduced in 3.14 with commit 0e0fe3958fdd13dbf55c3a787acafde6efd04272 and fixed in 6.17 with commit 7e40e0bb778907b2441bff68d73c3eb6b6cd319f

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39714
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/media/usb/usbtv/usbtv-video.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c35e7c7a004ef379a1ae7c7486d4829419acad1d
	https://git.kernel.org/stable/c/ee7bade8b9244834229b12b6e1e724939bedd484
	https://git.kernel.org/stable/c/5427dda195d6baf23028196fd55a0c90f66ffa61
	https://git.kernel.org/stable/c/ef9b3c22405192afaa279077ddd45a51db90b83d
	https://git.kernel.org/stable/c/3d83d0b5ae5045a7a246ed116b5f6c688a12f9e9
	https://git.kernel.org/stable/c/c3d75524e10021aa5c223d94da4996640aed46c0
	https://git.kernel.org/stable/c/9f886d21e235c4bd038cb20f6696084304197ab3
	https://git.kernel.org/stable/c/7e40e0bb778907b2441bff68d73c3eb6b6cd319f
