From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71129: LoongArch: BPF: Sign extend kfunc call arguments

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

LoongArch: BPF: Sign extend kfunc call arguments

The kfunc calls are native calls so they should follow LoongArch calling
conventions. Sign extend its arguments properly to avoid kernel panic.
This is done by adding a new emit_abi_ext() helper. The emit_abi_ext()
helper performs extension in place meaning a value already store in the
target register (Note: this is different from the existing sign_extend()
helper and thus we can't reuse it).

The Linux kernel CVE team has assigned CVE-2025-71129 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.1 with commit 5dc615520c4dfb358245680f1904bad61116648e and fixed in 6.6.120 with commit fd43edf357a3a1f5ed1c4bf450b60001c9091c39
	Issue introduced in 6.1 with commit 5dc615520c4dfb358245680f1904bad61116648e and fixed in 6.12.64 with commit 0d666db731e95890e0eda7ea61bc925fd2be90c6
	Issue introduced in 6.1 with commit 5dc615520c4dfb358245680f1904bad61116648e and fixed in 6.18.4 with commit 321993a874f571a94b5a596f1132f798c663b56e
	Issue introduced in 6.1 with commit 5dc615520c4dfb358245680f1904bad61116648e and fixed in 6.19 with commit 3f5a238f24d7b75f9efe324d3539ad388f58536e

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71129
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/loongarch/net/bpf_jit.c
	arch/loongarch/net/bpf_jit.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/fd43edf357a3a1f5ed1c4bf450b60001c9091c39
	https://git.kernel.org/stable/c/0d666db731e95890e0eda7ea61bc925fd2be90c6
	https://git.kernel.org/stable/c/321993a874f571a94b5a596f1132f798c663b56e
	https://git.kernel.org/stable/c/3f5a238f24d7b75f9efe324d3539ad388f58536e
