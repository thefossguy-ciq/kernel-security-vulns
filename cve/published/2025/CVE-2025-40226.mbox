From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40226: firmware: arm_scmi: Account for failed debug initialization

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

firmware: arm_scmi: Account for failed debug initialization

When the SCMI debug subsystem fails to initialize, the related debug root
will be missing, and the underlying descriptor will be NULL.

Handle this fault condition in the SCMI debug helpers that maintain
metrics counters.

The Linux kernel CVE team has assigned CVE-2025-40226 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.6.92 with commit b38812942556819263256cb77fbdc9eae7aa5b1b and fixed in 6.6.115 with commit d719ce9f286c439795cd2beee4c91f12b84bc5a0
	Issue introduced in 6.12 with commit 0b3d48c4726e1b20dffd2ff81a9d94d5d930220b and fixed in 6.12.56 with commit e088efcd97cb7c7297d166bb52c3b87a29f6a0b1
	Issue introduced in 6.12 with commit 0b3d48c4726e1b20dffd2ff81a9d94d5d930220b and fixed in 6.17.6 with commit 554c9d5c6c695aedaecfb4365c187102709397b0
	Issue introduced in 6.12 with commit 0b3d48c4726e1b20dffd2ff81a9d94d5d930220b and fixed in 6.18 with commit 2290ab43b9d8eafb8046387f10a8dfa2b030ba46

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40226
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/firmware/arm_scmi/common.h
	drivers/firmware/arm_scmi/driver.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d719ce9f286c439795cd2beee4c91f12b84bc5a0
	https://git.kernel.org/stable/c/e088efcd97cb7c7297d166bb52c3b87a29f6a0b1
	https://git.kernel.org/stable/c/554c9d5c6c695aedaecfb4365c187102709397b0
	https://git.kernel.org/stable/c/2290ab43b9d8eafb8046387f10a8dfa2b030ba46
