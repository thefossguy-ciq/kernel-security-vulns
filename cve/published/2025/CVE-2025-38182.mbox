From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38182: ublk: santizize the arguments from userspace when adding a device

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ublk: santizize the arguments from userspace when adding a device

Sanity check the values for queue depth and number of queues
we get from userspace when adding a device.

The Linux kernel CVE team has assigned CVE-2025-38182 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.0 with commit 71f28f3136aff5890cd56de78abc673f8393cad9 and fixed in 6.6.95 with commit 3162d8235c8c4d585525cee8a59d1c180940a968
	Issue introduced in 6.0 with commit 71f28f3136aff5890cd56de78abc673f8393cad9 and fixed in 6.12.35 with commit 0f8df5d6f25ac17c52a8bc6418e60a3e63130550
	Issue introduced in 6.0 with commit 71f28f3136aff5890cd56de78abc673f8393cad9 and fixed in 6.15.4 with commit e2b2b7cf6368580114851cb3932f2ad9fbf23386
	Issue introduced in 6.0 with commit 71f28f3136aff5890cd56de78abc673f8393cad9 and fixed in 6.16 with commit 8c8472855884355caf3d8e0c50adf825f83454b2

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38182
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/block/ublk_drv.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3162d8235c8c4d585525cee8a59d1c180940a968
	https://git.kernel.org/stable/c/0f8df5d6f25ac17c52a8bc6418e60a3e63130550
	https://git.kernel.org/stable/c/e2b2b7cf6368580114851cb3932f2ad9fbf23386
	https://git.kernel.org/stable/c/8c8472855884355caf3d8e0c50adf825f83454b2
