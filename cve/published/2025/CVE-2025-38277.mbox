From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38277: mtd: nand: ecc-mxic: Fix use of uninitialized variable ret

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mtd: nand: ecc-mxic: Fix use of uninitialized variable ret

If ctx->steps is zero, the loop processing ECC steps is skipped,
and the variable ret remains uninitialized. It is later checked
and returned, which leads to undefined behavior and may cause
unpredictable results in user space or kernel crashes.

This scenario can be triggered in edge cases such as misconfigured
geometry, ECC engine misuse, or if ctx->steps is not validated
after initialization.

Initialize ret to zero before the loop to ensure correct and safe
behavior regardless of the ctx->steps value.

Found by Linux Verification Center (linuxtesting.org) with SVACE.

The Linux kernel CVE team has assigned CVE-2025-38277 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.18 with commit 48e6633a9fa2400b53a964358753769f291a7eb0 and fixed in 6.1.142 with commit 4d9d6e4be09472aa72953caca3dbefdc27846170
	Issue introduced in 5.18 with commit 48e6633a9fa2400b53a964358753769f291a7eb0 and fixed in 6.6.94 with commit a0d9d9b5a4634e146ae41cb25667322e5c7d74d2
	Issue introduced in 5.18 with commit 48e6633a9fa2400b53a964358753769f291a7eb0 and fixed in 6.12.34 with commit 7a23cc510ecaabab4f6df7e9d910d16e279b72ad
	Issue introduced in 5.18 with commit 48e6633a9fa2400b53a964358753769f291a7eb0 and fixed in 6.15.3 with commit 49482f4a39620f6afedcd3f6aa9e0d558b6a460b
	Issue introduced in 5.18 with commit 48e6633a9fa2400b53a964358753769f291a7eb0 and fixed in 6.16 with commit d95846350aac72303036a70c4cdc69ae314aa26d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38277
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/mtd/nand/ecc-mxic.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/4d9d6e4be09472aa72953caca3dbefdc27846170
	https://git.kernel.org/stable/c/a0d9d9b5a4634e146ae41cb25667322e5c7d74d2
	https://git.kernel.org/stable/c/7a23cc510ecaabab4f6df7e9d910d16e279b72ad
	https://git.kernel.org/stable/c/49482f4a39620f6afedcd3f6aa9e0d558b6a460b
	https://git.kernel.org/stable/c/d95846350aac72303036a70c4cdc69ae314aa26d
