From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71148: net/handshake: restore destructor on submit failure

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net/handshake: restore destructor on submit failure

handshake_req_submit() replaces sk->sk_destruct but never restores it when
submission fails before the request is hashed. handshake_sk_destruct() then
returns early and the original destructor never runs, leaking the socket.
Restore sk_destruct on the error path.

The Linux kernel CVE team has assigned CVE-2025-71148 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.4 with commit 3b3009ea8abb713b022d94fba95ec270cf6e7eae and fixed in 6.6.120 with commit cd8cf2be3717137554744233fda051ffc09d1d44
	Issue introduced in 6.4 with commit 3b3009ea8abb713b022d94fba95ec270cf6e7eae and fixed in 6.12.64 with commit 7b82a1d6ae869533d8bdb0282a3a78faed8e63dd
	Issue introduced in 6.4 with commit 3b3009ea8abb713b022d94fba95ec270cf6e7eae and fixed in 6.18.3 with commit b225325be7b247c7268e65eea6090db1fc786d1f
	Issue introduced in 6.4 with commit 3b3009ea8abb713b022d94fba95ec270cf6e7eae and fixed in 6.19-rc2 with commit 6af2a01d65f89e73c1cbb9267f8880d83a88cee4

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71148
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/handshake/request.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cd8cf2be3717137554744233fda051ffc09d1d44
	https://git.kernel.org/stable/c/7b82a1d6ae869533d8bdb0282a3a78faed8e63dd
	https://git.kernel.org/stable/c/b225325be7b247c7268e65eea6090db1fc786d1f
	https://git.kernel.org/stable/c/6af2a01d65f89e73c1cbb9267f8880d83a88cee4
