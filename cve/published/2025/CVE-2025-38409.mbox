From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38409: drm/msm: Fix another leak in the submit error path

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/msm: Fix another leak in the submit error path

put_unused_fd() doesn't free the installed file, if we've already done
fd_install().  So we need to also free the sync_file.

Patchwork: https://patchwork.freedesktop.org/patch/653583/

The Linux kernel CVE team has assigned CVE-2025-38409 to this issue.


Affected and fixed versions
===========================

	Fixed in 6.1.144 with commit 00b3401f692082ddf6342500d1be25560bba46d4
	Fixed in 6.6.97 with commit c40ad1c04d306f7fde26337fdcf8a5979657d93f
	Fixed in 6.12.37 with commit 3f6ce8433a9035b0aa810e1f5b708e9dc1c367b0
	Fixed in 6.15.6 with commit 30d3819b0b9173e31b84d662a592af8bad351427
	Fixed in 6.16 with commit f681c2aa8676a890eacc84044717ab0fd26e058f

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38409
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/msm/msm_gem_submit.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/00b3401f692082ddf6342500d1be25560bba46d4
	https://git.kernel.org/stable/c/c40ad1c04d306f7fde26337fdcf8a5979657d93f
	https://git.kernel.org/stable/c/3f6ce8433a9035b0aa810e1f5b708e9dc1c367b0
	https://git.kernel.org/stable/c/30d3819b0b9173e31b84d662a592af8bad351427
	https://git.kernel.org/stable/c/f681c2aa8676a890eacc84044717ab0fd26e058f
