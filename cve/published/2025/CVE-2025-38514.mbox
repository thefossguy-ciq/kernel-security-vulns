From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38514: rxrpc: Fix oops due to non-existence of prealloc backlog struct

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

rxrpc: Fix oops due to non-existence of prealloc backlog struct

If an AF_RXRPC service socket is opened and bound, but calls are
preallocated, then rxrpc_alloc_incoming_call() will oops because the
rxrpc_backlog struct doesn't get allocated until the first preallocation is
made.

Fix this by returning NULL from rxrpc_alloc_incoming_call() if there is no
backlog struct.  This will cause the incoming call to be aborted.

The Linux kernel CVE team has assigned CVE-2025-38514 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.296 with commit bf0ca6a1bc4fb904b598137c6718785a107e3adf
	Fixed in 5.10.240 with commit f7afb3ff01c42c49e8a143cdce400b95844bb506
	Fixed in 5.15.189 with commit f5e72b7824d08c206ce106d30cb37c4642900ccc
	Fixed in 6.1.146 with commit 0eef29385d715d4c7fd707b18d4a9b76c76dd5e6
	Fixed in 6.6.99 with commit efc1b2b7c1a308b60df8f36bc2d7ce16d3999364
	Fixed in 6.12.39 with commit d1ff5f9d2c5405681457262e23c720b08977c11f
	Fixed in 6.15.7 with commit 2c2e9ebeb036f9b1b09325ec5cfdfe0e78f357c3
	Fixed in 6.16 with commit 880a88f318cf1d2a0f4c0a7ff7b07e2062b434a4

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38514
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/rxrpc/call_accept.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/bf0ca6a1bc4fb904b598137c6718785a107e3adf
	https://git.kernel.org/stable/c/f7afb3ff01c42c49e8a143cdce400b95844bb506
	https://git.kernel.org/stable/c/f5e72b7824d08c206ce106d30cb37c4642900ccc
	https://git.kernel.org/stable/c/0eef29385d715d4c7fd707b18d4a9b76c76dd5e6
	https://git.kernel.org/stable/c/efc1b2b7c1a308b60df8f36bc2d7ce16d3999364
	https://git.kernel.org/stable/c/d1ff5f9d2c5405681457262e23c720b08977c11f
	https://git.kernel.org/stable/c/2c2e9ebeb036f9b1b09325ec5cfdfe0e78f357c3
	https://git.kernel.org/stable/c/880a88f318cf1d2a0f4c0a7ff7b07e2062b434a4
