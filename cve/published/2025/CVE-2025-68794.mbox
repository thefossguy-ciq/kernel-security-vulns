From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68794: iomap: adjust read range correctly for non-block-aligned positions

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

iomap: adjust read range correctly for non-block-aligned positions

iomap_adjust_read_range() assumes that the position and length passed in
are block-aligned. This is not always the case however, as shown in the
syzbot generated case for erofs. This causes too many bytes to be
skipped for uptodate blocks, which results in returning the incorrect
position and length to read in. If all the blocks are uptodate, this
underflows length and returns a position beyond the folio.

Fix the calculation to also take into account the block offset when
calculating how many bytes can be skipped for uptodate blocks.

The Linux kernel CVE team has assigned CVE-2025-68794 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19 with commit 9dc55f1389f9569acf9659e58dd836a9c70df217 and fixed in 6.6.120 with commit 82b60ffbb532d919959702768dca04c3c0500ae5
	Issue introduced in 4.19 with commit 9dc55f1389f9569acf9659e58dd836a9c70df217 and fixed in 6.12.64 with commit 12053695c8ef5410e8cc6c9ed4c0db9cd9c82b3e
	Issue introduced in 4.19 with commit 9dc55f1389f9569acf9659e58dd836a9c70df217 and fixed in 6.18.3 with commit 142194fb21afe964d2d194cab1fc357cbf87e899
	Issue introduced in 4.19 with commit 9dc55f1389f9569acf9659e58dd836a9c70df217 and fixed in 6.19 with commit 7aa6bc3e8766990824f66ca76c19596ce10daf3e

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68794
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/iomap/buffered-io.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/82b60ffbb532d919959702768dca04c3c0500ae5
	https://git.kernel.org/stable/c/12053695c8ef5410e8cc6c9ed4c0db9cd9c82b3e
	https://git.kernel.org/stable/c/142194fb21afe964d2d194cab1fc357cbf87e899
	https://git.kernel.org/stable/c/7aa6bc3e8766990824f66ca76c19596ce10daf3e
