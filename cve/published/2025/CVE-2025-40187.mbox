From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40187: net/sctp: fix a null dereference in sctp_disposition sctp_sf_do_5_1D_ce()
Message-Id: <2025111244-CVE-2025-40187-7826@gregkh>
Content-Length: 3320
Lines: 62
X-Developer-Signature: v=1; a=openpgp-sha256; l=3383;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=SHoHP6GNxxEOVa+PM+6lIaSXXOAETOM20TQfPId1KjQ=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJmizD0zfk9dEaSte9vfP6zmmdF73WL1EuFbCp4/LU5Pd
 72yzP9CRywLgyATg6yYIsuXbTxH91ccUvQytD0NM4eVCWQIAxenAExkSgTDfOcfN902fN1/19WK
 OftzdtKTG1ETdzPMlVNhKJI2/aQcveZolXdVgtSL1Co7AA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net/sctp: fix a null dereference in sctp_disposition sctp_sf_do_5_1D_ce()

If new_asoc->peer.adaptation_ind=0 and sctp_ulpevent_make_authkey=0
and sctp_ulpevent_make_authkey() returns 0, then the variable
ai_ev remains zero and the zero will be dereferenced
in the sctp_ulpevent_free() function.

The Linux kernel CVE team has assigned CVE-2025-40187 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.17 with commit 30f6ebf65bc46161c5aaff1db2e6e7c76aa4a06b and fixed in 5.4.301 with commit 1014b83778c8677f1d7a57c26dc728baa801ac62
	Issue introduced in 4.17 with commit 30f6ebf65bc46161c5aaff1db2e6e7c76aa4a06b and fixed in 5.10.246 with commit 7f702f85df0266ed7b5bab81ba50394c92f3c928
	Issue introduced in 4.17 with commit 30f6ebf65bc46161c5aaff1db2e6e7c76aa4a06b and fixed in 5.15.195 with commit dbceedc0213e75bf3e9f9f9e2f66b10699d004fe
	Issue introduced in 4.17 with commit 30f6ebf65bc46161c5aaff1db2e6e7c76aa4a06b and fixed in 6.1.157 with commit 025419f4e216a3ae0d0cec622262e98e8078c447
	Issue introduced in 4.17 with commit 30f6ebf65bc46161c5aaff1db2e6e7c76aa4a06b and fixed in 6.6.113 with commit c21f45cfa4a9526b34d76b397c9ef080668b6e73
	Issue introduced in 4.17 with commit 30f6ebf65bc46161c5aaff1db2e6e7c76aa4a06b and fixed in 6.12.54 with commit d0e8f1445c19b1786759ba72a38267e1449bab7e
	Issue introduced in 4.17 with commit 30f6ebf65bc46161c5aaff1db2e6e7c76aa4a06b and fixed in 6.17.4 with commit badbd79313e6591616c1b78e29a9b71efed7f035
	Issue introduced in 4.17 with commit 30f6ebf65bc46161c5aaff1db2e6e7c76aa4a06b and fixed in 6.18-rc1 with commit 2f3119686ef50319490ccaec81a575973da98815

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40187
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sctp/sm_statefuns.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/1014b83778c8677f1d7a57c26dc728baa801ac62
	https://git.kernel.org/stable/c/7f702f85df0266ed7b5bab81ba50394c92f3c928
	https://git.kernel.org/stable/c/dbceedc0213e75bf3e9f9f9e2f66b10699d004fe
	https://git.kernel.org/stable/c/025419f4e216a3ae0d0cec622262e98e8078c447
	https://git.kernel.org/stable/c/c21f45cfa4a9526b34d76b397c9ef080668b6e73
	https://git.kernel.org/stable/c/d0e8f1445c19b1786759ba72a38267e1449bab7e
	https://git.kernel.org/stable/c/badbd79313e6591616c1b78e29a9b71efed7f035
	https://git.kernel.org/stable/c/2f3119686ef50319490ccaec81a575973da98815
