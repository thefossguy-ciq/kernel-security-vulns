{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: qla2xxx: Delay module unload while fabric scan in progress\n\nSystem crash seen during load/unload test in a loop.\n\n[105954.384919] RBP: ffff914589838dc0 R08: 0000000000000000 R09: 0000000000000086\n[105954.384920] R10: 000000000000000f R11: ffffa31240904be5 R12: ffff914605f868e0\n[105954.384921] R13: ffff914605f86910 R14: 0000000000008010 R15: 00000000ddb7c000\n[105954.384923] FS:  0000000000000000(0000) GS:ffff9163fec40000(0000) knlGS:0000000000000000\n[105954.384925] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\n[105954.384926] CR2: 000055d31ce1d6a0 CR3: 0000000119f5e001 CR4: 0000000000770ee0\n[105954.384928] PKRU: 55555554\n[105954.384929] Call Trace:\n[105954.384931]  <IRQ>\n[105954.384934]  qla24xx_sp_unmap+0x1f3/0x2a0 [qla2xxx]\n[105954.384962]  ? qla_async_scan_sp_done+0x114/0x1f0 [qla2xxx]\n[105954.384980]  ? qla24xx_els_ct_entry+0x4de/0x760 [qla2xxx]\n[105954.384999]  ? __wake_up_common+0x80/0x190\n[105954.385004]  ? qla24xx_process_response_queue+0xc2/0xaa0 [qla2xxx]\n[105954.385023]  ? qla24xx_msix_rsp_q+0x44/0xb0 [qla2xxx]\n[105954.385040]  ? __handle_irq_event_percpu+0x3d/0x190\n[105954.385044]  ? handle_irq_event+0x58/0xb0\n[105954.385046]  ? handle_edge_irq+0x93/0x240\n[105954.385050]  ? __common_interrupt+0x41/0xa0\n[105954.385055]  ? common_interrupt+0x3e/0xa0\n[105954.385060]  ? asm_common_interrupt+0x22/0x40\n\nThe root cause of this was that there was a free (dma_free_attrs) in the\ninterrupt context.  There was a device discovery/fabric scan in\nprogress.  A module unload was issued which set the UNLOADING flag.  As\npart of the discovery, after receiving an interrupt a work queue was\nscheduled (which involved a work to be queued).  Since the UNLOADING\nflag is set, the work item was not allocated and the mapped memory had\nto be freed.  The free occurred in interrupt context leading to system\ncrash.  Delay the driver unload until the fabric scan is complete to\navoid the crash."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/scsi/qla2xxx/qla_os.c"
               ],
               "versions": [
                  {
                     "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
                     "lessThan": "d8af012f92eee021c6ebb7093e65813c926c336b",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
                     "lessThan": "891f9969a29e9767a453cef4811c8d2472ccab49",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
                     "lessThan": "984dc1a51bf6fc3ca4e726abe790ec38952935d8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
                     "lessThan": "528b2f1027edfb52af0171f0f4b227fb356dde05",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
                     "lessThan": "d70f71d4c92bcb8b6a21ac62d4ea3e87721f4f32",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
                     "lessThan": "c068ebbaf52820d6bdefb9b405a1e426663c635a",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
                     "lessThan": "7062eb0c488f35730334daad9495d9265c574853",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/scsi/qla2xxx/qla_os.c"
               ],
               "versions": [
                  {
                     "version": "5.10.251",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.201",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.164",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.125",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.72",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.18.11",
                     "lessThanOrEqual": "6.18.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.19.1",
                     "lessThanOrEqual": "6.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionEndExcluding": "5.10.251"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionEndExcluding": "5.15.201"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionEndExcluding": "6.1.164"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionEndExcluding": "6.6.125"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionEndExcluding": "6.12.72"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionEndExcluding": "6.18.11"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionEndExcluding": "6.19.1"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/d8af012f92eee021c6ebb7093e65813c926c336b"
            },
            {
               "url": "https://git.kernel.org/stable/c/891f9969a29e9767a453cef4811c8d2472ccab49"
            },
            {
               "url": "https://git.kernel.org/stable/c/984dc1a51bf6fc3ca4e726abe790ec38952935d8"
            },
            {
               "url": "https://git.kernel.org/stable/c/528b2f1027edfb52af0171f0f4b227fb356dde05"
            },
            {
               "url": "https://git.kernel.org/stable/c/d70f71d4c92bcb8b6a21ac62d4ea3e87721f4f32"
            },
            {
               "url": "https://git.kernel.org/stable/c/c068ebbaf52820d6bdefb9b405a1e426663c635a"
            },
            {
               "url": "https://git.kernel.org/stable/c/7062eb0c488f35730334daad9495d9265c574853"
            }
         ],
         "title": "scsi: qla2xxx: Delay module unload while fabric scan in progress",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-71235",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
