From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68374: md: fix rcu protection in md_wakeup_thread

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

md: fix rcu protection in md_wakeup_thread

We attempted to use RCU to protect the pointer 'thread', but directly
passed the value when calling md_wakeup_thread(). This means that the
RCU pointer has been acquired before rcu_read_lock(), which renders
rcu_read_lock() ineffective and could lead to a use-after-free.

The Linux kernel CVE team has assigned CVE-2025-68374 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.5 with commit 4469315439827290923fce4f3f672599cabeb366 and fixed in 6.12.63 with commit 21989cb5034c835b212385a2afadf279d8069da0
	Issue introduced in 6.5 with commit 4469315439827290923fce4f3f672599cabeb366 and fixed in 6.17.13 with commit a4bd1caf591faeae44cb10b6517e7dacb5139bda
	Issue introduced in 6.5 with commit 4469315439827290923fce4f3f672599cabeb366 and fixed in 6.18.2 with commit f98b191f78124405294481dea85f8a22a3eb0a59
	Issue introduced in 6.5 with commit 4469315439827290923fce4f3f672599cabeb366 and fixed in 6.19 with commit 0dc76205549b4c25705e54345f211b9f66e018a0

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68374
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/md/md.c
	drivers/md/md.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/21989cb5034c835b212385a2afadf279d8069da0
	https://git.kernel.org/stable/c/a4bd1caf591faeae44cb10b6517e7dacb5139bda
	https://git.kernel.org/stable/c/f98b191f78124405294481dea85f8a22a3eb0a59
	https://git.kernel.org/stable/c/0dc76205549b4c25705e54345f211b9f66e018a0
