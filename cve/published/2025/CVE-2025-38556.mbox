From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38556: HID: core: Harden s32ton() against conversion to 0 bits

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

HID: core: Harden s32ton() against conversion to 0 bits

Testing by the syzbot fuzzer showed that the HID core gets a
shift-out-of-bounds exception when it tries to convert a 32-bit
quantity to a 0-bit quantity.  Ideally this should never occur, but
there are buggy devices and some might have a report field with size
set to zero; we shouldn't reject the report or the device just because
of that.

Instead, harden the s32ton() routine so that it returns a reasonable
result instead of crashing when it is called with the number of bits
set to 0 -- the same as what snto32() does.

The Linux kernel CVE team has assigned CVE-2025-38556 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.20 with commit dde5845a529ff753364a6d1aea61180946270bfa and fixed in 5.10.248 with commit 6cdf6c708717c5c6897d0800a1793e83757c7491
	Issue introduced in 2.6.20 with commit dde5845a529ff753364a6d1aea61180946270bfa and fixed in 5.15.198 with commit eeeaba737919bdce9885e2a00ac2912f61a3684d
	Issue introduced in 2.6.20 with commit dde5845a529ff753364a6d1aea61180946270bfa and fixed in 6.1.159 with commit 3c86548a20d7bc2861aa4de044991a327bebad1a
	Issue introduced in 2.6.20 with commit dde5845a529ff753364a6d1aea61180946270bfa and fixed in 6.6.119 with commit 810189546cb6c8f36443ed091d91f1f5d2fc2ec7
	Issue introduced in 2.6.20 with commit dde5845a529ff753364a6d1aea61180946270bfa and fixed in 6.12.46 with commit d3b504146c111548ab60b6ef7aad00bfb1db05a2
	Issue introduced in 2.6.20 with commit dde5845a529ff753364a6d1aea61180946270bfa and fixed in 6.15.10 with commit 8b4a94b1510f6a46ec48494b52ee8f67eb4fc836
	Issue introduced in 2.6.20 with commit dde5845a529ff753364a6d1aea61180946270bfa and fixed in 6.16.1 with commit 865ad8469fa24de1559f247d9426ab01e5ce3a56
	Issue introduced in 2.6.20 with commit dde5845a529ff753364a6d1aea61180946270bfa and fixed in 6.17 with commit a6b87bfc2ab5bccb7ad953693c85d9062aef3fdd

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38556
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/hid/hid-core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/6cdf6c708717c5c6897d0800a1793e83757c7491
	https://git.kernel.org/stable/c/eeeaba737919bdce9885e2a00ac2912f61a3684d
	https://git.kernel.org/stable/c/3c86548a20d7bc2861aa4de044991a327bebad1a
	https://git.kernel.org/stable/c/810189546cb6c8f36443ed091d91f1f5d2fc2ec7
	https://git.kernel.org/stable/c/d3b504146c111548ab60b6ef7aad00bfb1db05a2
	https://git.kernel.org/stable/c/8b4a94b1510f6a46ec48494b52ee8f67eb4fc836
	https://git.kernel.org/stable/c/865ad8469fa24de1559f247d9426ab01e5ce3a56
	https://git.kernel.org/stable/c/a6b87bfc2ab5bccb7ad953693c85d9062aef3fdd
