From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68759: wifi: rtl818x: Fix potential memory leaks in rtl8180_init_rx_ring()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: rtl818x: Fix potential memory leaks in rtl8180_init_rx_ring()

In rtl8180_init_rx_ring(), memory is allocated for skb packets and DMA
allocations in a loop. When an allocation fails, the previously
successful allocations are not freed on exit.

Fix that by jumping to err_free_rings label on error, which calls
rtl8180_free_rx_ring() to free the allocations. Remove the free of
rx_ring in rtl8180_init_rx_ring() error path, and set the freed
priv->rx_buf entry to null, to avoid double free.

The Linux kernel CVE team has assigned CVE-2025-68759 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.25 with commit f653211197f3841f383fa9757ef8ce182c6cf627 and fixed in 5.10.248 with commit 3677c01891fb0239361e444afee8398868e34bdf
	Issue introduced in 2.6.25 with commit f653211197f3841f383fa9757ef8ce182c6cf627 and fixed in 5.15.198 with commit 89caaeee8dd95fae8bb4f4964e6fe3ca688500c4
	Issue introduced in 2.6.25 with commit f653211197f3841f383fa9757ef8ce182c6cf627 and fixed in 6.1.160 with commit a4fb7cca9837378878e6c94d9e7af019c8fdfcdb
	Issue introduced in 2.6.25 with commit f653211197f3841f383fa9757ef8ce182c6cf627 and fixed in 6.6.120 with commit bf8513dfa31ea015c9cf415796dca2113d293840
	Issue introduced in 2.6.25 with commit f653211197f3841f383fa9757ef8ce182c6cf627 and fixed in 6.12.63 with commit ee7db11742b30641f21306105ad27a275e3c61d7
	Issue introduced in 2.6.25 with commit f653211197f3841f383fa9757ef8ce182c6cf627 and fixed in 6.17.13 with commit a813a74570212cb5f3a7d3b05c0cb0cd00bace1d
	Issue introduced in 2.6.25 with commit f653211197f3841f383fa9757ef8ce182c6cf627 and fixed in 6.18.2 with commit c9d1c4152e6d32fa74034464854bee262a60bc43
	Issue introduced in 2.6.25 with commit f653211197f3841f383fa9757ef8ce182c6cf627 and fixed in 6.19 with commit 9b5b9c042b30befc5b37e4539ace95af70843473

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68759
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/realtek/rtl818x/rtl8180/dev.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3677c01891fb0239361e444afee8398868e34bdf
	https://git.kernel.org/stable/c/89caaeee8dd95fae8bb4f4964e6fe3ca688500c4
	https://git.kernel.org/stable/c/a4fb7cca9837378878e6c94d9e7af019c8fdfcdb
	https://git.kernel.org/stable/c/bf8513dfa31ea015c9cf415796dca2113d293840
	https://git.kernel.org/stable/c/ee7db11742b30641f21306105ad27a275e3c61d7
	https://git.kernel.org/stable/c/a813a74570212cb5f3a7d3b05c0cb0cd00bace1d
	https://git.kernel.org/stable/c/c9d1c4152e6d32fa74034464854bee262a60bc43
	https://git.kernel.org/stable/c/9b5b9c042b30befc5b37e4539ace95af70843473
