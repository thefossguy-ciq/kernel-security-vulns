From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-23136: thermal: int340x: Add NULL check for adev

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

thermal: int340x: Add NULL check for adev

Not all devices have an ACPI companion fwnode, so adev might be NULL.
This is similar to the commit cd2fd6eab480
("platform/x86: int3472: Check for adev == NULL").

Add a check for adev not being set and return -ENODEV in that case to
avoid a possible NULL pointer deref in int3402_thermal_probe().

Note, under the same directory, int3400_thermal_probe() has such a
check.

[ rjw: Subject edit, added Fixes: ]

The Linux kernel CVE team has assigned CVE-2025-23136 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 5.4.292 with commit d0d21c8e44216fa9afdb3809edf213f3c0a8c060
	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 5.10.236 with commit bc7b5f782d28942dbdfda70df30ce132694a06de
	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 5.15.180 with commit 3155d5261b518776d1b807d9d922669991bbee56
	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 6.1.134 with commit 6a810c462f099353e908c70619638884cb82229c
	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 6.6.87 with commit ac2eb7378319e3836cdf3a2c15a0bdf04c50e81d
	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 6.12.23 with commit 953d28a4f459fcbde2d08f51aeca19d6b0f179f3
	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 6.13.11 with commit 0c49f12c77b77a706fd41370c11910635e491845
	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 6.14.2 with commit 8e8f1ddf4186731649df8bc9646017369eb19186
	Issue introduced in 3.18 with commit 77e337c6e23e3b9d22e09ffec202a80f755a54c2 and fixed in 6.15-rc1 with commit 2542a3f70e563a9e70e7ded314286535a3321bdb

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-23136
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/thermal/intel/int340x_thermal/int3402_thermal.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d0d21c8e44216fa9afdb3809edf213f3c0a8c060
	https://git.kernel.org/stable/c/bc7b5f782d28942dbdfda70df30ce132694a06de
	https://git.kernel.org/stable/c/3155d5261b518776d1b807d9d922669991bbee56
	https://git.kernel.org/stable/c/6a810c462f099353e908c70619638884cb82229c
	https://git.kernel.org/stable/c/ac2eb7378319e3836cdf3a2c15a0bdf04c50e81d
	https://git.kernel.org/stable/c/953d28a4f459fcbde2d08f51aeca19d6b0f179f3
	https://git.kernel.org/stable/c/0c49f12c77b77a706fd41370c11910635e491845
	https://git.kernel.org/stable/c/8e8f1ddf4186731649df8bc9646017369eb19186
	https://git.kernel.org/stable/c/2542a3f70e563a9e70e7ded314286535a3321bdb
