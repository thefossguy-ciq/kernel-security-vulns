From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37810: usb: dwc3: gadget: check that event count does not exceed event buffer length

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

usb: dwc3: gadget: check that event count does not exceed event buffer length

The event count is read from register DWC3_GEVNTCOUNT.
There is a check for the count being zero, but not for exceeding the
event buffer length.
Check that event count does not exceed event buffer length,
avoiding an out-of-bounds access when memcpy'ing the event.
Crash log:
Unable to handle kernel paging request at virtual address ffffffc0129be000
pc : __memcpy+0x114/0x180
lr : dwc3_check_event_buf+0xec/0x348
x3 : 0000000000000030 x2 : 000000000000dfc4
x1 : ffffffc0129be000 x0 : ffffff87aad60080
Call trace:
__memcpy+0x114/0x180
dwc3_interrupt+0x24/0x34

The Linux kernel CVE team has assigned CVE-2025-37810 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.2 with commit 72246da40f3719af3bfd104a2365b32537c27d83 and fixed in 5.4.293 with commit 015c39f38e69a491d2abd5e98869a500a9459b3b
	Issue introduced in 3.2 with commit 72246da40f3719af3bfd104a2365b32537c27d83 and fixed in 5.10.237 with commit b43225948b231b3f331194010f84512bee4d9f59
	Issue introduced in 3.2 with commit 72246da40f3719af3bfd104a2365b32537c27d83 and fixed in 5.15.181 with commit c0079630f268843a25ed75226169cba40e0d8880
	Issue introduced in 3.2 with commit 72246da40f3719af3bfd104a2365b32537c27d83 and fixed in 6.1.136 with commit a44547015287a19001384fe94dbff84c92ce4ee1
	Issue introduced in 3.2 with commit 72246da40f3719af3bfd104a2365b32537c27d83 and fixed in 6.6.89 with commit c4d80e41cb42008dceb35e5dbf52574d93beac0d
	Issue introduced in 3.2 with commit 72246da40f3719af3bfd104a2365b32537c27d83 and fixed in 6.12.26 with commit 52a7c9d930b95aa8b1620edaba4818040c32631f
	Issue introduced in 3.2 with commit 72246da40f3719af3bfd104a2365b32537c27d83 and fixed in 6.14.5 with commit 99d655119b870ee60e4dbf310aa9a1ed8d9ede3d
	Issue introduced in 3.2 with commit 72246da40f3719af3bfd104a2365b32537c27d83 and fixed in 6.15 with commit 63ccd26cd1f6600421795f6ca3e625076be06c9f

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37810
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/usb/dwc3/gadget.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/015c39f38e69a491d2abd5e98869a500a9459b3b
	https://git.kernel.org/stable/c/b43225948b231b3f331194010f84512bee4d9f59
	https://git.kernel.org/stable/c/c0079630f268843a25ed75226169cba40e0d8880
	https://git.kernel.org/stable/c/a44547015287a19001384fe94dbff84c92ce4ee1
	https://git.kernel.org/stable/c/c4d80e41cb42008dceb35e5dbf52574d93beac0d
	https://git.kernel.org/stable/c/52a7c9d930b95aa8b1620edaba4818040c32631f
	https://git.kernel.org/stable/c/99d655119b870ee60e4dbf310aa9a1ed8d9ede3d
	https://git.kernel.org/stable/c/63ccd26cd1f6600421795f6ca3e625076be06c9f
