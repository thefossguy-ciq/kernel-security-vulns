From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37851: fbdev: omapfb: Add 'plane' value check
Message-Id: <2025050919-CVE-2025-37851-2597@gregkh>
Content-Length: 3208
Lines: 78
X-Developer-Signature: v=1; a=openpgp-sha256; l=3287;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=O4cXvSuKFSUvt0BJF+h6o2PWm+1WFZroPoZsj5oxcJM=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBmyi0/HsZ77L8Ho+41pNu88sY78t9KPFY/2FtWWOHx9/
 3BbV8m8jlgWBkEmBlkxRZYv23iO7q84pOhlaHsaZg4rE8gQBi5OAZjIhAcMCzZp287ZWjNhrvK2
 +XwnJ9UkmvMdZmeYn7Tzc2Wa67mPfK+OLw6M3CiW9rWyAgA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

fbdev: omapfb: Add 'plane' value check

Function dispc_ovl_setup is not intended to work with the value OMAP_DSS_WB
of the enum parameter plane.

The value of this parameter is initialized in dss_init_overlays and in the
current state of the code it cannot take this value so it's not a real
problem.

For the purposes of defensive coding it wouldn't be superfluous to check
the parameter value, because some functions down the call stack process
this value correctly and some not.

For example, in dispc_ovl_setup_global_alpha it may lead to buffer
overflow.

Add check for this value.

Found by Linux Verification Center (linuxtesting.org) with SVACE static
analysis tool.

The Linux kernel CVE team has assigned CVE-2025-37851 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.293 with commit a570efb4d877adbf3db2dc95487f2ba6bfdd148a
	Fixed in 5.10.237 with commit cdf41d72e8b015d9ea68f5a1c0a79624e7c312aa
	Fixed in 5.15.181 with commit 09dbf22fd68c2f1a81ab89670ffa1ec3033436c4
	Fixed in 6.1.135 with commit 660a53a0694d1f3789802509fe729dd4656fc5e0
	Fixed in 6.6.88 with commit fda15c5b96b883d62fb2d84a3a1422aa87717897
	Fixed in 6.12.24 with commit 52eafaa56f8f6d6a0cdff9282b25b4acbde34edc
	Fixed in 6.13.12 with commit 9b0a41589ee70529b20e1e0108d03f10c649bdc4
	Fixed in 6.14.3 with commit 4efd8ef5e40f2c7a4a91a5a9f03140bfa827da89
	Fixed in 6.15-rc1 with commit 3e411827f31db7f938a30a3c7a7599839401ec30

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37851
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/video/fbdev/omap2/omapfb/dss/dispc.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a570efb4d877adbf3db2dc95487f2ba6bfdd148a
	https://git.kernel.org/stable/c/cdf41d72e8b015d9ea68f5a1c0a79624e7c312aa
	https://git.kernel.org/stable/c/09dbf22fd68c2f1a81ab89670ffa1ec3033436c4
	https://git.kernel.org/stable/c/660a53a0694d1f3789802509fe729dd4656fc5e0
	https://git.kernel.org/stable/c/fda15c5b96b883d62fb2d84a3a1422aa87717897
	https://git.kernel.org/stable/c/52eafaa56f8f6d6a0cdff9282b25b4acbde34edc
	https://git.kernel.org/stable/c/9b0a41589ee70529b20e1e0108d03f10c649bdc4
	https://git.kernel.org/stable/c/4efd8ef5e40f2c7a4a91a5a9f03140bfa827da89
	https://git.kernel.org/stable/c/3e411827f31db7f938a30a3c7a7599839401ec30
