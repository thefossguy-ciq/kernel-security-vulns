From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38053: idpf: fix null-ptr-deref in idpf_features_check
Message-Id: <2025061832-CVE-2025-38053-e145@gregkh>
Content-Length: 2968
Lines: 76
X-Developer-Signature: v=1; a=openpgp-sha256; l=3045;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=ViQzS9kWu0gNTP1p1gLkwxQE10ddZPMS86B/jG6E1/8=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlB7W/YJmX/S/p1nfO4ecvTNeslPQ5v3zDHvPGeku3K/
 U9FdLZ87YhlYRBkYpAVU2T5so3n6P6KQ4pehranYeawMoEMYeDiFICJ3H/OML+o3mnG/4TUGbsU
 251y8zLtHoW+Ps0wP3jLAbZ0K+cAaf9pnmEmHJxaS5ZxAQA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

idpf: fix null-ptr-deref in idpf_features_check

idpf_features_check is used to validate the TX packet. skb header
length is compared with the hardware supported value received from
the device control plane. The value is stored in the adapter structure
and to access it, vport pointer is used. During reset all the vports
are released and the vport pointer that the netdev private structure
points to is NULL.

To avoid null-ptr-deref, store the max header length value in netdev
private structure. This also helps to cache the value and avoid
accessing adapter pointer in hot path.

BUG: kernel NULL pointer dereference, address: 0000000000000068
...
RIP: 0010:idpf_features_check+0x6d/0xe0 [idpf]
Call Trace:
 <TASK>
 ? __die+0x23/0x70
 ? page_fault_oops+0x154/0x520
 ? exc_page_fault+0x76/0x190
 ? asm_exc_page_fault+0x26/0x30
 ? idpf_features_check+0x6d/0xe0 [idpf]
 netif_skb_features+0x88/0x310
 validate_xmit_skb+0x2a/0x2b0
 validate_xmit_skb_list+0x4c/0x70
 sch_direct_xmit+0x19d/0x3a0
 __dev_queue_xmit+0xb74/0xe70
 ...

The Linux kernel CVE team has assigned CVE-2025-38053 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.7 with commit a251eee62133774cf35ff829041377e721ef9c8c and fixed in 6.12.31 with commit f6f5e9c8cb680c3cb9771fd9fa114319cbc4f514
	Issue introduced in 6.7 with commit a251eee62133774cf35ff829041377e721ef9c8c and fixed in 6.14.9 with commit bf1e751c5a5611aa037ab44cca955c141eb68dcc
	Issue introduced in 6.7 with commit a251eee62133774cf35ff829041377e721ef9c8c and fixed in 6.15 with commit 2dabe349f7882ff1407a784d54d8541909329088

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38053
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/idpf/idpf.h
	drivers/net/ethernet/intel/idpf/idpf_lib.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/f6f5e9c8cb680c3cb9771fd9fa114319cbc4f514
	https://git.kernel.org/stable/c/bf1e751c5a5611aa037ab44cca955c141eb68dcc
	https://git.kernel.org/stable/c/2dabe349f7882ff1407a784d54d8541909329088
