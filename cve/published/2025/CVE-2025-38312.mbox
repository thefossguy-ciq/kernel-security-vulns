From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38312: fbdev: core: fbcvt: avoid division by 0 in fb_cvt_hperiod()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

fbdev: core: fbcvt: avoid division by 0 in fb_cvt_hperiod()

In fb_find_mode_cvt(), iff mode->refresh somehow happens to be 0x80000000,
cvt.f_refresh will become 0 when multiplying it by 2 due to overflow. It's
then passed to fb_cvt_hperiod(), where it's used as a divider -- division
by 0 will result in kernel oops. Add a sanity check for cvt.f_refresh to
avoid such overflow...

Found by Linux Verification Center (linuxtesting.org) with the Svace static
analysis tool.

The Linux kernel CVE team has assigned CVE-2025-38312 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.14 with commit 96fe6a2109db29cd15b90a093c16e6cb4b19371a and fixed in 5.4.295 with commit 9027ce4c037b566b658b8939a76326b7125e3627
	Issue introduced in 2.6.14 with commit 96fe6a2109db29cd15b90a093c16e6cb4b19371a and fixed in 5.10.239 with commit 610f247f2772e4f92b63442125a1b7ade79898d8
	Issue introduced in 2.6.14 with commit 96fe6a2109db29cd15b90a093c16e6cb4b19371a and fixed in 5.15.186 with commit 2d63433e8eaa3c91b2948190e395bc67009db0d9
	Issue introduced in 2.6.14 with commit 96fe6a2109db29cd15b90a093c16e6cb4b19371a and fixed in 6.1.142 with commit 54947530663edcbaaee1314c01fdd8c72861b124
	Issue introduced in 2.6.14 with commit 96fe6a2109db29cd15b90a093c16e6cb4b19371a and fixed in 6.6.94 with commit ab91647acdf43b984824776559a452212eaeb21a
	Issue introduced in 2.6.14 with commit 96fe6a2109db29cd15b90a093c16e6cb4b19371a and fixed in 6.12.34 with commit b235393b9f43ff86a38ca2bde6372312ea215dc5
	Issue introduced in 2.6.14 with commit 96fe6a2109db29cd15b90a093c16e6cb4b19371a and fixed in 6.15.3 with commit 53784073cbad18f75583fd3da9ffdfc4d1f05405
	Issue introduced in 2.6.14 with commit 96fe6a2109db29cd15b90a093c16e6cb4b19371a and fixed in 6.16-rc1 with commit 3f6dae09fc8c306eb70fdfef70726e1f154e173a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38312
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/video/fbdev/core/fbcvt.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/9027ce4c037b566b658b8939a76326b7125e3627
	https://git.kernel.org/stable/c/610f247f2772e4f92b63442125a1b7ade79898d8
	https://git.kernel.org/stable/c/2d63433e8eaa3c91b2948190e395bc67009db0d9
	https://git.kernel.org/stable/c/54947530663edcbaaee1314c01fdd8c72861b124
	https://git.kernel.org/stable/c/ab91647acdf43b984824776559a452212eaeb21a
	https://git.kernel.org/stable/c/b235393b9f43ff86a38ca2bde6372312ea215dc5
	https://git.kernel.org/stable/c/53784073cbad18f75583fd3da9ffdfc4d1f05405
	https://git.kernel.org/stable/c/3f6dae09fc8c306eb70fdfef70726e1f154e173a
