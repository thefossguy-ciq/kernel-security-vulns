From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68266: bfs: Reconstruct file type when loading from disk
Message-Id: <2025121609-CVE-2025-68266-d334@gregkh>
Content-Length: 2341
Lines: 60
X-Developer-Signature: v=1; a=openpgp-sha256; l=2402;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=yBfVCJNIW1m8MATfqRrJt3RNkSNCwibA1VTipZp7zD8=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJmOBW+PqUTpSaZo3rgz++P551KSMQ3n/rf7WnRna3F9i
 k3bmbK0I5aFQZCJQVZMkeXLNp6j+ysOKXoZ2p6GmcPKBDKEgYtTACbC945hfmrdonVzmTdHq6wy
 4qhd7NB77+HzaQzzzFLe/jXdKl9vU9v9VNJYKXDmwowrAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

bfs: Reconstruct file type when loading from disk

syzbot is reporting that S_IFMT bits of inode->i_mode can become bogus when
the S_IFMT bits of the 32bits "mode" field loaded from disk are corrupted
or when the 32bits "attributes" field loaded from disk are corrupted.

A documentation says that BFS uses only lower 9 bits of the "mode" field.
But I can't find an explicit explanation that the unused upper 23 bits
(especially, the S_IFMT bits) are initialized with 0.

Therefore, ignore the S_IFMT bits of the "mode" field loaded from disk.
Also, verify that the value of the "attributes" field loaded from disk is
either BFS_VREG or BFS_VDIR (because BFS supports only regular files and
the root directory).

The Linux kernel CVE team has assigned CVE-2025-68266 to this issue.


Affected and fixed versions
===========================

	Fixed in 6.12.62 with commit 77899444d46162aeb65f229590c26ba266864223
	Fixed in 6.17.12 with commit a8cb796e7e2cb7971311ba236922f5e7e1be77e6
	Fixed in 6.18 with commit 34ab4c75588c07cca12884f2bf6b0347c7a13872

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68266
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/bfs/inode.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/77899444d46162aeb65f229590c26ba266864223
	https://git.kernel.org/stable/c/a8cb796e7e2cb7971311ba236922f5e7e1be77e6
	https://git.kernel.org/stable/c/34ab4c75588c07cca12884f2bf6b0347c7a13872
