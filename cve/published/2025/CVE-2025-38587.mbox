From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38587: ipv6: fix possible infinite loop in fib6_info_uses_dev()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ipv6: fix possible infinite loop in fib6_info_uses_dev()

fib6_info_uses_dev() seems to rely on RCU without an explicit
protection.

Like the prior fix in rt6_nlmsg_size(),
we need to make sure fib6_del_route() or fib6_add_rt2node()
have not removed the anchor from the list, or we risk an infinite loop.

The Linux kernel CVE team has assigned CVE-2025-38587 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.1.128 with commit d0ec61c9f3583b76aebdbb271f5c0d3fcccd48b2 and fixed in 6.1.148 with commit bc85e62394f008fa848c4ba02c936c735a3e8ef5
	Issue introduced in 6.6.75 with commit 52da02521ede55fb86546c3fffd9377b3261b91f and fixed in 6.6.102 with commit 9cb6de8ee144a94ae7a40bdb32560329ab7276f0
	Issue introduced in 6.12.2 with commit 34a949e7a0869dfa31a40416d2a56973fae1807b and fixed in 6.12.42 with commit db65739d406c72776fbdbbc334be827ef05880d2
	Issue introduced in 6.13 with commit d9ccb18f83ea2bb654289b6ecf014fd267cc988b and fixed in 6.15.10 with commit 16d21816c0918f8058b5fc14cbe8595d62046e2d
	Issue introduced in 6.13 with commit d9ccb18f83ea2bb654289b6ecf014fd267cc988b and fixed in 6.16.1 with commit e09be457b71b983a085312ff9e981f51e4ed3211
	Issue introduced in 6.13 with commit d9ccb18f83ea2bb654289b6ecf014fd267cc988b and fixed in 6.17 with commit f8d8ce1b515a0a6af72b30502670a406cfb75073
	Issue introduced in 6.11.11 with commit 11edcd026012ac18acee0f1514db3ed1b160fc6f

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38587
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/ipv6/route.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/bc85e62394f008fa848c4ba02c936c735a3e8ef5
	https://git.kernel.org/stable/c/9cb6de8ee144a94ae7a40bdb32560329ab7276f0
	https://git.kernel.org/stable/c/db65739d406c72776fbdbbc334be827ef05880d2
	https://git.kernel.org/stable/c/16d21816c0918f8058b5fc14cbe8595d62046e2d
	https://git.kernel.org/stable/c/e09be457b71b983a085312ff9e981f51e4ed3211
	https://git.kernel.org/stable/c/f8d8ce1b515a0a6af72b30502670a406cfb75073
