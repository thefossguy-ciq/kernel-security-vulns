From bippy-1.0.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38240: drm/mediatek: dp: drm_err => dev_err in HPD path to avoid NULL ptr

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/mediatek: dp: drm_err => dev_err in HPD path to avoid NULL ptr

The function mtk_dp_wait_hpd_asserted() may be called before the
`mtk_dp->drm_dev` pointer is assigned in mtk_dp_bridge_attach().
Specifically it can be called via this callpath:
 - mtk_edp_wait_hpd_asserted
 - [panel probe]
 - dp_aux_ep_probe

Using "drm" level prints anywhere in this callpath causes a NULL
pointer dereference. Change the error message directly in
mtk_dp_wait_hpd_asserted() to dev_err() to avoid this. Also change the
error messages in mtk_dp_parse_capabilities(), which is called by
mtk_dp_wait_hpd_asserted().

While touching these prints, also add the error code to them to make
future debugging easier.

The Linux kernel CVE team has assigned CVE-2025-38240 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.6 with commit 7eacba9a083be65c0f251c19380ec01147c01ebc and fixed in 6.6.87 with commit 13ec849fd2eab808ee8eba2625df7ebea3b85edf
	Issue introduced in 6.6 with commit 7eacba9a083be65c0f251c19380ec01147c01ebc and fixed in 6.12.23 with commit 57a9fb47551b33cde7b76d17c0072c3b394f4620
	Issue introduced in 6.6 with commit 7eacba9a083be65c0f251c19380ec01147c01ebc and fixed in 6.13.11 with commit 2fda391ef7a701748abd7fa32232981b522c1e07
	Issue introduced in 6.6 with commit 7eacba9a083be65c0f251c19380ec01147c01ebc and fixed in 6.14.2 with commit 149a5c38436c229950cf1020992ce65c9549bc19
	Issue introduced in 6.6 with commit 7eacba9a083be65c0f251c19380ec01147c01ebc and fixed in 6.15-rc1 with commit 106a6de46cf4887d535018185ec528ce822d6d84

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38240
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/mediatek/mtk_dp.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/13ec849fd2eab808ee8eba2625df7ebea3b85edf
	https://git.kernel.org/stable/c/57a9fb47551b33cde7b76d17c0072c3b394f4620
	https://git.kernel.org/stable/c/2fda391ef7a701748abd7fa32232981b522c1e07
	https://git.kernel.org/stable/c/149a5c38436c229950cf1020992ce65c9549bc19
	https://git.kernel.org/stable/c/106a6de46cf4887d535018185ec528ce822d6d84
