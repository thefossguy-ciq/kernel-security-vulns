From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21917: usb: renesas_usbhs: Flush the notify_hotplug_work

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

usb: renesas_usbhs: Flush the notify_hotplug_work

When performing continuous unbind/bind operations on the USB drivers
available on the Renesas RZ/G2L SoC, a kernel crash with the message
"Unable to handle kernel NULL pointer dereference at virtual address"
may occur. This issue points to the usbhsc_notify_hotplug() function.

Flush the delayed work to avoid its execution when driver resources are
unavailable.

The Linux kernel CVE team has assigned CVE-2025-21917 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.0 with commit bc57381e634782009b1cb2e86b18013699ada576 and fixed in 5.4.291 with commit 4cd847a7b630a85493d0294ad9542c21aafaa246
	Issue introduced in 3.0 with commit bc57381e634782009b1cb2e86b18013699ada576 and fixed in 5.10.235 with commit 394965f90454d6f00fe11879142b720c6c1a872e
	Issue introduced in 3.0 with commit bc57381e634782009b1cb2e86b18013699ada576 and fixed in 5.15.179 with commit 3248c1f833f924246cb98ce7da4569133c1b2292
	Issue introduced in 3.0 with commit bc57381e634782009b1cb2e86b18013699ada576 and fixed in 6.1.131 with commit 4ca078084cdd5f32d533311d6a0b63a60dcadd41
	Issue introduced in 3.0 with commit bc57381e634782009b1cb2e86b18013699ada576 and fixed in 6.6.83 with commit d50f5c0cd949593eb9a3d822b34d7b50046a06b7
	Issue introduced in 3.0 with commit bc57381e634782009b1cb2e86b18013699ada576 and fixed in 6.12.19 with commit e5aac1c9b2974636db7ce796ffa6de88fa08335e
	Issue introduced in 3.0 with commit bc57381e634782009b1cb2e86b18013699ada576 and fixed in 6.13.7 with commit 830818c8e70c0364e377f0c243b28061ef7967eb
	Issue introduced in 3.0 with commit bc57381e634782009b1cb2e86b18013699ada576 and fixed in 6.14 with commit 552ca6b87e3778f3dd5b87842f95138162e16c82

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21917
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/usb/renesas_usbhs/common.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/4cd847a7b630a85493d0294ad9542c21aafaa246
	https://git.kernel.org/stable/c/394965f90454d6f00fe11879142b720c6c1a872e
	https://git.kernel.org/stable/c/3248c1f833f924246cb98ce7da4569133c1b2292
	https://git.kernel.org/stable/c/4ca078084cdd5f32d533311d6a0b63a60dcadd41
	https://git.kernel.org/stable/c/d50f5c0cd949593eb9a3d822b34d7b50046a06b7
	https://git.kernel.org/stable/c/e5aac1c9b2974636db7ce796ffa6de88fa08335e
	https://git.kernel.org/stable/c/830818c8e70c0364e377f0c243b28061ef7967eb
	https://git.kernel.org/stable/c/552ca6b87e3778f3dd5b87842f95138162e16c82
