From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40023: drm/xe/vf: Don't expose sysfs attributes not applicable for VFs
Message-Id: <2025102404-CVE-2025-40023-d135@gregkh>
Content-Length: 2371
Lines: 61
X-Developer-Signature: v=1; a=openpgp-sha256; l=2433;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=KinEUZhOBy2tTp7+8udZOxi0RpRiMtpbE8NbTRAJZjY=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBm/CxSKT14paREPiTpve1XvvM2L/7dEH2Q959fbfkWKO
 6Mxa8GsjlgWBkEmBlkxRZYv23iO7q84pOhlaHsaZg4rE8gQBi5OAZjIbA6G+Z56Dj2/zi0XbGoL
 Xhb+e/4K511Hoxjm++98ukRiwrtd/MGHc29JejWEF/QfBgA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/xe/vf: Don't expose sysfs attributes not applicable for VFs

VFs can't read BMG_PCIE_CAP(0x138340) register nor access PCODE
(already guarded by the info.skip_pcode flag) so we shouldn't
expose attributes that require any of them to avoid errors like:

 [] xe 0000:03:00.1: [drm] Tile0: GT0: VF is trying to read an \
                     inaccessible register 0x138340+0x0
 [] RIP: 0010:xe_gt_sriov_vf_read32+0x6c2/0x9a0 [xe]
 [] Call Trace:
 []  xe_mmio_read32+0x110/0x280 [xe]
 []  auto_link_downgrade_capable_show+0x2e/0x70 [xe]
 []  dev_attr_show+0x1a/0x70
 []  sysfs_kf_seq_show+0xaa/0x120
 []  kernfs_seq_show+0x41/0x60

(cherry picked from commit a2d6223d224f333f705ed8495bf8bebfbc585c35)

The Linux kernel CVE team has assigned CVE-2025-40023 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.16 with commit 0e414bf7ad012e55c8a0aa4e91f68cb1cf5801ff and fixed in 6.16.10 with commit bacbadedbba737da8ae6e0464bc0971c30cda4cb
	Issue introduced in 6.16 with commit 0e414bf7ad012e55c8a0aa4e91f68cb1cf5801ff and fixed in 6.17 with commit 500dad428e5b0de4c1bdfa893822a6e06ddad0b5

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40023
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/xe/xe_device_sysfs.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/bacbadedbba737da8ae6e0464bc0971c30cda4cb
	https://git.kernel.org/stable/c/500dad428e5b0de4c1bdfa893822a6e06ddad0b5
