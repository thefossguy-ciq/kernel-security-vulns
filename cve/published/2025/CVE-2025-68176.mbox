From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68176: PCI: cadence: Check for the existence of cdns_pcie::ops before using it

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

PCI: cadence: Check for the existence of cdns_pcie::ops before using it

cdns_pcie::ops might not be populated by all the Cadence glue drivers. This
is going to be true for the upcoming Sophgo platform which doesn't set the
ops.

Hence, add a check to prevent NULL pointer dereference.

[mani: reworded subject and description]

The Linux kernel CVE team has assigned CVE-2025-68176 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.9 with commit 40d957e6f9eb3a8a585007b8b730340c829afbdb and fixed in 5.10.247 with commit d5dbe92ac8a4ca6226093241f95f9cb1b0d2e0e1
	Issue introduced in 5.9 with commit 40d957e6f9eb3a8a585007b8b730340c829afbdb and fixed in 5.15.197 with commit eb3d29ca0820fa3d7cccad47d2da56c9ab5469ed
	Issue introduced in 5.9 with commit 40d957e6f9eb3a8a585007b8b730340c829afbdb and fixed in 6.1.159 with commit 0d0bb756f002810d249caee51f3f1c309f3cdab5
	Issue introduced in 5.9 with commit 40d957e6f9eb3a8a585007b8b730340c829afbdb and fixed in 6.6.117 with commit 1810b2fd7375de88a74976dcd402b29088e479ed
	Issue introduced in 5.9 with commit 40d957e6f9eb3a8a585007b8b730340c829afbdb and fixed in 6.12.58 with commit 953eb3796ef06b8ea3bf6bdde14156255bc75866
	Issue introduced in 5.9 with commit 40d957e6f9eb3a8a585007b8b730340c829afbdb and fixed in 6.17.8 with commit 363448d069e29685ca37a118065121e486387af3
	Issue introduced in 5.9 with commit 40d957e6f9eb3a8a585007b8b730340c829afbdb and fixed in 6.18 with commit 49a6c160ad4812476f8ae1a8f4ed6d15adfa6c09

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68176
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/pci/controller/cadence/pcie-cadence-host.c
	drivers/pci/controller/cadence/pcie-cadence.c
	drivers/pci/controller/cadence/pcie-cadence.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d5dbe92ac8a4ca6226093241f95f9cb1b0d2e0e1
	https://git.kernel.org/stable/c/eb3d29ca0820fa3d7cccad47d2da56c9ab5469ed
	https://git.kernel.org/stable/c/0d0bb756f002810d249caee51f3f1c309f3cdab5
	https://git.kernel.org/stable/c/1810b2fd7375de88a74976dcd402b29088e479ed
	https://git.kernel.org/stable/c/953eb3796ef06b8ea3bf6bdde14156255bc75866
	https://git.kernel.org/stable/c/363448d069e29685ca37a118065121e486387af3
	https://git.kernel.org/stable/c/49a6c160ad4812476f8ae1a8f4ed6d15adfa6c09
