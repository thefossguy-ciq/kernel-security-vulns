From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71113: crypto: af_alg - zero initialize memory allocated via sock_kmalloc

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

crypto: af_alg - zero initialize memory allocated via sock_kmalloc

Several crypto user API contexts and requests allocated with
sock_kmalloc() were left uninitialized, relying on callers to
set fields explicitly. This resulted in the use of uninitialized
data in certain error paths or when new fields are added in the
future.

The ACVP patches also contain two user-space interface files:
algif_kpp.c and algif_akcipher.c. These too rely on proper
initialization of their context structures.

A particular issue has been observed with the newly added
'inflight' variable introduced in af_alg_ctx by commit:

  67b164a871af ("crypto: af_alg - Disallow multiple in-flight AIO requests")

Because the context is not memset to zero after allocation,
the inflight variable has contained garbage values. As a result,
af_alg_alloc_areq() has incorrectly returned -EBUSY randomly when
the garbage value was interpreted as true:

  https://github.com/gregkh/linux/blame/master/crypto/af_alg.c#L1209

The check directly tests ctx->inflight without explicitly
comparing against true/false. Since inflight is only ever set to
true or false later, an uninitialized value has triggered
-EBUSY failures. Zero-initializing memory allocated with
sock_kmalloc() ensures inflight and other fields start in a known
state, removing random issues caused by uninitialized data.

The Linux kernel CVE team has assigned CVE-2025-71113 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.38 with commit fe869cdb89c95d060c77eea20204d6c91f233b53 and fixed in 5.10.248 with commit e125c8e346e4eb7b3e854c862fcb4392bc13ddba
	Issue introduced in 2.6.38 with commit fe869cdb89c95d060c77eea20204d6c91f233b53 and fixed in 5.15.198 with commit 543bf004e4eafbb302b1e6c78570d425d2ca13a0
	Issue introduced in 2.6.38 with commit fe869cdb89c95d060c77eea20204d6c91f233b53 and fixed in 6.1.160 with commit f81244fd6b14fecfa93b66b6bb1d59f96554e550
	Issue introduced in 2.6.38 with commit fe869cdb89c95d060c77eea20204d6c91f233b53 and fixed in 6.6.120 with commit 84238876e3b3b262cf62d5f4d1338e983fb27010
	Issue introduced in 2.6.38 with commit fe869cdb89c95d060c77eea20204d6c91f233b53 and fixed in 6.12.64 with commit 5a4b65523608974a81edbe386f8a667a3e10c726
	Issue introduced in 2.6.38 with commit fe869cdb89c95d060c77eea20204d6c91f233b53 and fixed in 6.18.3 with commit 51a5ab36084f3251ef87eda3e6a6236f6488925e
	Issue introduced in 2.6.38 with commit fe869cdb89c95d060c77eea20204d6c91f233b53 and fixed in 6.19-rc1 with commit 6f6e309328d53a10c0fe1f77dec2db73373179b6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71113
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	crypto/af_alg.c
	crypto/algif_hash.c
	crypto/algif_rng.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/e125c8e346e4eb7b3e854c862fcb4392bc13ddba
	https://git.kernel.org/stable/c/543bf004e4eafbb302b1e6c78570d425d2ca13a0
	https://git.kernel.org/stable/c/f81244fd6b14fecfa93b66b6bb1d59f96554e550
	https://git.kernel.org/stable/c/84238876e3b3b262cf62d5f4d1338e983fb27010
	https://git.kernel.org/stable/c/5a4b65523608974a81edbe386f8a667a3e10c726
	https://git.kernel.org/stable/c/51a5ab36084f3251ef87eda3e6a6236f6488925e
	https://git.kernel.org/stable/c/6f6e309328d53a10c0fe1f77dec2db73373179b6
