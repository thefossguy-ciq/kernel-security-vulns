From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37846: arm64: mops: Do not dereference src reg for a set operation

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

arm64: mops: Do not dereference src reg for a set operation

The source register is not used for SET* and reading it can result in
a UBSAN out-of-bounds array access error, specifically when the MOPS
exception is taken from a SET* sequence with XZR (reg 31) as the
source. Architecturally this is the only case where a src/dst/size
field in the ESR can be reported as 31.

Prior to 2de451a329cf662b the code in do_el0_mops() was benign as the
use of pt_regs_read_reg() prevented the out-of-bounds access.

The Linux kernel CVE team has assigned CVE-2025-37846 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.7 with commit 2de451a329cf662beeba71f63c7f83ee24ca6642 and fixed in 6.12.24 with commit eec737e17e5567e08148550a7f1d94d495b9fb17
	Issue introduced in 6.7 with commit 2de451a329cf662beeba71f63c7f83ee24ca6642 and fixed in 6.13.12 with commit 43267d934eacff6c70e15545d804ebbcab8a0bf5
	Issue introduced in 6.7 with commit 2de451a329cf662beeba71f63c7f83ee24ca6642 and fixed in 6.14.3 with commit 5f6022a74147675124b781fdc056b291850e7786
	Issue introduced in 6.7 with commit 2de451a329cf662beeba71f63c7f83ee24ca6642 and fixed in 6.15-rc1 with commit a13bfa4fe0d6949cea14718df2d1fe84c38cd113

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37846
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/arm64/include/asm/traps.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/eec737e17e5567e08148550a7f1d94d495b9fb17
	https://git.kernel.org/stable/c/43267d934eacff6c70e15545d804ebbcab8a0bf5
	https://git.kernel.org/stable/c/5f6022a74147675124b781fdc056b291850e7786
	https://git.kernel.org/stable/c/a13bfa4fe0d6949cea14718df2d1fe84c38cd113
