From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71124: drm/msm/a6xx: move preempt_prepare_postamble after error check

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/msm/a6xx: move preempt_prepare_postamble after error check

Move the call to preempt_prepare_postamble() after verifying that
preempt_postamble_ptr is valid. If preempt_postamble_ptr is NULL,
dereferencing it in preempt_prepare_postamble() would lead to a crash.

This change avoids calling the preparation function when the
postamble allocation has failed, preventing potential NULL pointer
dereference and ensuring proper error handling.

Patchwork: https://patchwork.freedesktop.org/patch/687659/

The Linux kernel CVE team has assigned CVE-2025-71124 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.13 with commit 50117cad0c50410cff0d43a1141a562b1347e7c5 and fixed in 6.18.3 with commit 2c46497eb148ec61909f4101b8443f3c4c2daaec
	Issue introduced in 6.13 with commit 50117cad0c50410cff0d43a1141a562b1347e7c5 and fixed in 6.19-rc3 with commit ef3b04091fd8bc737dc45312375df8625b8318e2

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71124
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/msm/adreno/a6xx_preempt.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/2c46497eb148ec61909f4101b8443f3c4c2daaec
	https://git.kernel.org/stable/c/ef3b04091fd8bc737dc45312375df8625b8318e2
