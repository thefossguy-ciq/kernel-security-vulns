From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39853: i40e: Fix potential invalid access when MAC list is empty
Message-Id: <2025091904-CVE-2025-39853-a617@gregkh>
Content-Length: 3343
Lines: 63
X-Developer-Signature: v=1; a=openpgp-sha256; l=3407;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=yllcYajEGHfreRhsrWl8gPAQ30Llpf7CTUV1HD5bW7Q=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlny1pMT+V7fIy8qqh7f0eh0n0/EYNA94drstdd0Ls+8
 U3y/vY9HbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAjCRKbwMC2YtqGQ76JGapGF9
 kyfJY4+eSNU6PYb5sQr7/pWUHNxgnDNJZL5WWtMdmfZOAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

i40e: Fix potential invalid access when MAC list is empty

list_first_entry() never returns NULL - if the list is empty, it still
returns a pointer to an invalid object, leading to potential invalid
memory access when dereferenced.

Fix this by using list_first_entry_or_null instead of list_first_entry.

The Linux kernel CVE team has assigned CVE-2025-39853 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.6 with commit e3219ce6a775468368fb270fae3eb82a6787b436 and fixed in 5.4.299 with commit 971feafe157afac443027acdc235badc6838560b
	Issue introduced in 4.6 with commit e3219ce6a775468368fb270fae3eb82a6787b436 and fixed in 5.10.243 with commit 3c6fb929afa313d9d11f780451d113f73922fe5d
	Issue introduced in 4.6 with commit e3219ce6a775468368fb270fae3eb82a6787b436 and fixed in 5.15.192 with commit 1eadabcf5623f1237a539b16586b4ed8ac8dffcd
	Issue introduced in 4.6 with commit e3219ce6a775468368fb270fae3eb82a6787b436 and fixed in 6.1.151 with commit e2a5e74879f9b494bbd66fa93f355feacde450c7
	Issue introduced in 4.6 with commit e3219ce6a775468368fb270fae3eb82a6787b436 and fixed in 6.6.105 with commit fb216d980fae6561c7c70af8ef826faf059c6515
	Issue introduced in 4.6 with commit e3219ce6a775468368fb270fae3eb82a6787b436 and fixed in 6.12.46 with commit 66e7cdbda74ee823ec2bf7b830ebd235c54f5ddf
	Issue introduced in 4.6 with commit e3219ce6a775468368fb270fae3eb82a6787b436 and fixed in 6.16.6 with commit 9c21fc4cebd44dd21016c61261a683af390343f8
	Issue introduced in 4.6 with commit e3219ce6a775468368fb270fae3eb82a6787b436 and fixed in 6.17-rc5 with commit a556f06338e1d5a85af0e32ecb46e365547f92b9

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39853
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/i40e/i40e_client.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/971feafe157afac443027acdc235badc6838560b
	https://git.kernel.org/stable/c/3c6fb929afa313d9d11f780451d113f73922fe5d
	https://git.kernel.org/stable/c/1eadabcf5623f1237a539b16586b4ed8ac8dffcd
	https://git.kernel.org/stable/c/e2a5e74879f9b494bbd66fa93f355feacde450c7
	https://git.kernel.org/stable/c/fb216d980fae6561c7c70af8ef826faf059c6515
	https://git.kernel.org/stable/c/66e7cdbda74ee823ec2bf7b830ebd235c54f5ddf
	https://git.kernel.org/stable/c/9c21fc4cebd44dd21016c61261a683af390343f8
	https://git.kernel.org/stable/c/a556f06338e1d5a85af0e32ecb46e365547f92b9
