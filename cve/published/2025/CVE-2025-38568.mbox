From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38568: net/sched: mqprio: fix stack out-of-bounds write in tc entry parsing
Message-Id: <2025081909-CVE-2025-38568-7cd9@gregkh>
Content-Length: 2731
Lines: 58
X-Developer-Signature: v=1; a=openpgp-sha256; l=2790;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=79CmNI3go4w/vvyX3B7ogbAWfOg1jDBDglCY6fmwxYI=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlLNl4UPVt+1CB+Q36yU2z5jrSM/Fahq2ZpO48X/l465
 dRTFTvdjlgWBkEmBlkxRZYv23iO7q84pOhlaHsaZg4rE8gQBi5OAZiIjQvD/OAtC50faQvEWZTy
 W5b0r9RpL2N4zzDPNrNCZPNa5e6Hhd8OHHeoyEvi1SkDAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net/sched: mqprio: fix stack out-of-bounds write in tc entry parsing

TCA_MQPRIO_TC_ENTRY_INDEX is validated using
NLA_POLICY_MAX(NLA_U32, TC_QOPT_MAX_QUEUE), which allows the value
TC_QOPT_MAX_QUEUE (16). This leads to a 4-byte out-of-bounds stack
write in the fp[] array, which only has room for 16 elements (0â€“15).

Fix this by changing the policy to allow only up to TC_QOPT_MAX_QUEUE - 1.

The Linux kernel CVE team has assigned CVE-2025-38568 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.4 with commit f62af20bed2d9e824f51cfc97ff01bc261f40e58 and fixed in 6.6.102 with commit 39491e859fd494d0b51adc5c7d54c8a7dcf1d198
	Issue introduced in 6.4 with commit f62af20bed2d9e824f51cfc97ff01bc261f40e58 and fixed in 6.12.42 with commit d00e4125680f7074c4f42ce3c297336f23128e70
	Issue introduced in 6.4 with commit f62af20bed2d9e824f51cfc97ff01bc261f40e58 and fixed in 6.15.10 with commit 66fc2ebdd9d5dd6e5a9c7edeace5a61a0ab2cd86
	Issue introduced in 6.4 with commit f62af20bed2d9e824f51cfc97ff01bc261f40e58 and fixed in 6.16.1 with commit f1a9dbcb7d17bf0abb325cdc984957cfabc59693
	Issue introduced in 6.4 with commit f62af20bed2d9e824f51cfc97ff01bc261f40e58 and fixed in 6.17-rc1 with commit ffd2dc4c6c49ff4f1e5d34e454a6a55608104c17

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38568
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sched/sch_mqprio.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/39491e859fd494d0b51adc5c7d54c8a7dcf1d198
	https://git.kernel.org/stable/c/d00e4125680f7074c4f42ce3c297336f23128e70
	https://git.kernel.org/stable/c/66fc2ebdd9d5dd6e5a9c7edeace5a61a0ab2cd86
	https://git.kernel.org/stable/c/f1a9dbcb7d17bf0abb325cdc984957cfabc59693
	https://git.kernel.org/stable/c/ffd2dc4c6c49ff4f1e5d34e454a6a55608104c17
