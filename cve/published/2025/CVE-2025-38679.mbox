From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38679: media: venus: Fix OOB read due to missing payload bound check

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

media: venus: Fix OOB read due to missing payload bound check

Currently, The event_seq_changed() handler processes a variable number
of properties sent by the firmware. The number of properties is indicated
by the firmware and used to iterate over the payload. However, the
payload size is not being validated against the actual message length.

This can lead to out-of-bounds memory access if the firmware provides a
property count that exceeds the data available in the payload. Such a
condition can result in kernel crashes or potential information leaks if
memory beyond the buffer is accessed.

Fix this by properly validating the remaining size of the payload before
each property access and updating bounds accordingly as properties are
parsed.

This ensures that property parsing is safely bounded within the received
message buffer and protects against malformed or malicious firmware
behavior.

The Linux kernel CVE team has assigned CVE-2025-38679 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.13 with commit 09c2845e8fe4fcab942929480203f504a6e0a114 and fixed in 6.1.149 with commit a3eef5847603cd8a4110587907988c3f93c9605a
	Issue introduced in 4.13 with commit 09c2845e8fe4fcab942929480203f504a6e0a114 and fixed in 6.6.103 with commit 8f274e2b05fdae7a53cee83979202b5ecb49035c
	Issue introduced in 4.13 with commit 09c2845e8fe4fcab942929480203f504a6e0a114 and fixed in 6.12.43 with commit 6f08bfb5805637419902f3d70069fe17a404545b
	Issue introduced in 4.13 with commit 09c2845e8fe4fcab942929480203f504a6e0a114 and fixed in 6.15.11 with commit c956c3758510b448b3d4d10d1da8230e8c9bf668
	Issue introduced in 4.13 with commit 09c2845e8fe4fcab942929480203f504a6e0a114 and fixed in 6.16.2 with commit bed4921055dd7bb4d2eea2729852ae18cf97a2c6
	Issue introduced in 4.13 with commit 09c2845e8fe4fcab942929480203f504a6e0a114 and fixed in 6.17-rc1 with commit 06d6770ff0d8cc8dfd392329a8cc03e2a83e7289

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38679
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/media/platform/qcom/venus/hfi_msgs.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a3eef5847603cd8a4110587907988c3f93c9605a
	https://git.kernel.org/stable/c/8f274e2b05fdae7a53cee83979202b5ecb49035c
	https://git.kernel.org/stable/c/6f08bfb5805637419902f3d70069fe17a404545b
	https://git.kernel.org/stable/c/c956c3758510b448b3d4d10d1da8230e8c9bf668
	https://git.kernel.org/stable/c/bed4921055dd7bb4d2eea2729852ae18cf97a2c6
	https://git.kernel.org/stable/c/06d6770ff0d8cc8dfd392329a8cc03e2a83e7289
