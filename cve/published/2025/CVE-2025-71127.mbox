From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71127: wifi: mac80211: Discard Beacon frames to non-broadcast address

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: mac80211: Discard Beacon frames to non-broadcast address

Beacon frames are required to be sent to the broadcast address, see IEEE
Std 802.11-2020, 11.1.3.1 ("The Address 1 field of the Beacon .. frame
shall be set to the broadcast address"). A unicast Beacon frame might be
used as a targeted attack to get one of the associated STAs to do
something (e.g., using CSA to move it to another channel). As such, it
is better have strict filtering for this on the received side and
discard all Beacon frames that are sent to an unexpected address.

This is even more important for cases where beacon protection is used.
The current implementation in mac80211 is correctly discarding unicast
Beacon frames if the Protected Frame bit in the Frame Control field is
set to 0. However, if that bit is set to 1, the logic used for checking
for configured BIGTK(s) does not actually work. If the driver does not
have logic for dropping unicast Beacon frames with Protected Frame bit
1, these frames would be accepted in mac80211 processing as valid Beacon
frames even though they are not protected. This would allow beacon
protection to be bypassed. While the logic for checking beacon
protection could be extended to cover this corner case, a more generic
check for discard all Beacon frames based on A1=unicast address covers
this without needing additional changes.

Address all these issues by dropping received Beacon frames if they are
sent to a non-broadcast address.

The Linux kernel CVE team has assigned CVE-2025-71127 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.7 with commit af2d14b01c32d7cba65f73503586e5b621afb139 and fixed in 5.10.248 with commit be0974be5c42584e027883ac2af7dab5e950098c
	Issue introduced in 5.7 with commit af2d14b01c32d7cba65f73503586e5b621afb139 and fixed in 5.15.198 with commit 0a59a3895f804469276d188effa511c72e752f35
	Issue introduced in 5.7 with commit af2d14b01c32d7cba65f73503586e5b621afb139 and fixed in 6.1.160 with commit 88aab153d1528bc559292a12fb5105ee97528e1f
	Issue introduced in 5.7 with commit af2d14b01c32d7cba65f73503586e5b621afb139 and fixed in 6.6.120 with commit 6e5bff40bb38741e40c33043ba0816fba5f93661
	Issue introduced in 5.7 with commit af2d14b01c32d7cba65f73503586e5b621afb139 and fixed in 6.12.65 with commit 7b240a8935d554ad36a52c2c37c32039f9afaef2
	Issue introduced in 5.7 with commit af2d14b01c32d7cba65f73503586e5b621afb139 and fixed in 6.18.4 with commit a21704df4024708be698fb3fd5830d5b113b70e0
	Issue introduced in 5.7 with commit af2d14b01c32d7cba65f73503586e5b621afb139 and fixed in 6.19 with commit 193d18f60588e95d62e0f82b6a53893e5f2f19f8

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71127
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/mac80211/rx.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/be0974be5c42584e027883ac2af7dab5e950098c
	https://git.kernel.org/stable/c/0a59a3895f804469276d188effa511c72e752f35
	https://git.kernel.org/stable/c/88aab153d1528bc559292a12fb5105ee97528e1f
	https://git.kernel.org/stable/c/6e5bff40bb38741e40c33043ba0816fba5f93661
	https://git.kernel.org/stable/c/7b240a8935d554ad36a52c2c37c32039f9afaef2
	https://git.kernel.org/stable/c/a21704df4024708be698fb3fd5830d5b113b70e0
	https://git.kernel.org/stable/c/193d18f60588e95d62e0f82b6a53893e5f2f19f8
