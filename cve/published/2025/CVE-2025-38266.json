{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npinctrl: mediatek: eint: Fix invalid pointer dereference for v1 platforms\n\nCommit 3ef9f710efcb (\"pinctrl: mediatek: Add EINT support for multiple\naddresses\") introduced an access to the 'soc' field of struct\nmtk_pinctrl in mtk_eint_do_init() and for that an include of\npinctrl-mtk-common-v2.h.\n\nHowever, pinctrl drivers relying on the v1 common driver include\npinctrl-mtk-common.h instead, which provides another definition of\nstruct mtk_pinctrl that does not contain an 'soc' field.\n\nSince mtk_eint_do_init() can be called both by v1 and v2 drivers, it\nwill now try to dereference an invalid pointer when called on v1\nplatforms. This has been observed on Genio 350 EVK (MT8365), which\ncrashes very early in boot (the kernel trace can only be seen with\nearlycon).\n\nIn order to fix this, since 'struct mtk_pinctrl' was only needed to get\na 'struct mtk_eint_pin', make 'struct mtk_eint_pin' a parameter\nof mtk_eint_do_init() so that callers need to supply it, removing\nmtk_eint_do_init()'s dependency on any particular 'struct mtk_pinctrl'."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/pinctrl/mediatek/mtk-eint.c",
                  "drivers/pinctrl/mediatek/mtk-eint.h",
                  "drivers/pinctrl/mediatek/pinctrl-mtk-common-v2.c",
                  "drivers/pinctrl/mediatek/pinctrl-mtk-common.c"
               ],
               "versions": [
                  {
                     "version": "3ef9f710efcb5cc1335b5b09c16c757f703d7e5f",
                     "lessThan": "9ebe21ede792cef851847648962c363cac67d17f",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "3ef9f710efcb5cc1335b5b09c16c757f703d7e5f",
                     "lessThan": "1c9977b263475373b31bbf86af94a5c9ae2be42c",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/pinctrl/mediatek/mtk-eint.c",
                  "drivers/pinctrl/mediatek/mtk-eint.h",
                  "drivers/pinctrl/mediatek/pinctrl-mtk-common-v2.c",
                  "drivers/pinctrl/mediatek/pinctrl-mtk-common.c"
               ],
               "versions": [
                  {
                     "version": "6.15",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.15",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.15.2",
                     "lessThanOrEqual": "6.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.16",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.15",
                           "versionEndExcluding": "6.15.2"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.15",
                           "versionEndExcluding": "6.16"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/9ebe21ede792cef851847648962c363cac67d17f"
            },
            {
               "url": "https://git.kernel.org/stable/c/1c9977b263475373b31bbf86af94a5c9ae2be42c"
            }
         ],
         "title": "pinctrl: mediatek: eint: Fix invalid pointer dereference for v1 platforms",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-38266",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
