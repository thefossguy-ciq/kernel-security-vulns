From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39796: net: lapbether: ignore ops-locked netdevs
Message-Id: <2025091224-CVE-2025-39796-290b@gregkh>
Content-Length: 3466
Lines: 75
X-Developer-Signature: v=1; a=openpgp-sha256; l=3542;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=KPSOaMIgfm8eNjYjE64hjO6Bbrs5yo76Pf7pZAqlfW0=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlHnGNq3h82Mr7/buEKg3ybtmCOafnX78kKt22eNuHcW
 UeZvO+8HbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAnCTmRnm2c8rnaOv4G9zu9D6
 flDzCTYBne1iDAumL7mWevz/rbw3IYnHk+auyF355V4yAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: lapbether: ignore ops-locked netdevs

Syzkaller managed to trigger lock dependency in xsk_notify via
register_netdevice. As discussed in [0], using register_netdevice
in the notifiers is problematic so skip adding lapbeth for ops-locked
devices.

       xsk_notifier+0xa4/0x280 net/xdp/xsk.c:1645
       notifier_call_chain+0xbc/0x410 kernel/notifier.c:85
       call_netdevice_notifiers_info+0xbe/0x140 net/core/dev.c:2230
       call_netdevice_notifiers_extack net/core/dev.c:2268 [inline]
       call_netdevice_notifiers net/core/dev.c:2282 [inline]
       unregister_netdevice_many_notify+0xf9d/0x2700 net/core/dev.c:12077
       unregister_netdevice_many net/core/dev.c:12140 [inline]
       unregister_netdevice_queue+0x305/0x3f0 net/core/dev.c:11984
       register_netdevice+0x18f1/0x2270 net/core/dev.c:11149
       lapbeth_new_device drivers/net/wan/lapbether.c:420 [inline]
       lapbeth_device_event+0x5b1/0xbe0 drivers/net/wan/lapbether.c:462
       notifier_call_chain+0xbc/0x410 kernel/notifier.c:85
       call_netdevice_notifiers_info+0xbe/0x140 net/core/dev.c:2230
       call_netdevice_notifiers_extack net/core/dev.c:2268 [inline]
       call_netdevice_notifiers net/core/dev.c:2282 [inline]
       __dev_notify_flags+0x12c/0x2e0 net/core/dev.c:9497
       netif_change_flags+0x108/0x160 net/core/dev.c:9526
       dev_change_flags+0xba/0x250 net/core/dev_api.c:68
       devinet_ioctl+0x11d5/0x1f50 net/ipv4/devinet.c:1200
       inet_ioctl+0x3a7/0x3f0 net/ipv4/af_inet.c:1001

0: https://lore.kernel.org/netdev/20250625140357.6203d0af@kernel.org/

The Linux kernel CVE team has assigned CVE-2025-39796 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.15 with commit 4c975fd700022c90e61a46326e3444e08317876e and fixed in 6.15.11 with commit 57a7ef338a2cd62a22a15a199ab9afd3d953df55
	Issue introduced in 6.15 with commit 4c975fd700022c90e61a46326e3444e08317876e and fixed in 6.16.2 with commit 628e233c1fefcc227fae9bdcff6be8ac92e1b4d2
	Issue introduced in 6.15 with commit 4c975fd700022c90e61a46326e3444e08317876e and fixed in 6.17-rc2 with commit 53898ebabe843bfa7baea9dae152797d5d0563c9

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39796
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wan/lapbether.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/57a7ef338a2cd62a22a15a199ab9afd3d953df55
	https://git.kernel.org/stable/c/628e233c1fefcc227fae9bdcff6be8ac92e1b4d2
	https://git.kernel.org/stable/c/53898ebabe843bfa7baea9dae152797d5d0563c9
