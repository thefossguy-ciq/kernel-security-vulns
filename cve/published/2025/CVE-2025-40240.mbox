From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40240: sctp: avoid NULL dereference when chunk data buffer is missing

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

sctp: avoid NULL dereference when chunk data buffer is missing

chunk->skb pointer is dereferenced in the if-block where it's supposed
to be NULL only.

chunk->skb can only be NULL if chunk->head_skb is not. Check for frag_list
instead and do it just before replacing chunk->skb. We're sure that
otherwise chunk->skb is non-NULL because of outer if() condition.

The Linux kernel CVE team has assigned CVE-2025-40240 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.8 with commit 90017accff61ae89283ad9a51f9ac46ca01633fb and fixed in 5.4.301 with commit 61cda2777b07d27459f5cac5a047c3edf9c8a1a9
	Issue introduced in 4.8 with commit 90017accff61ae89283ad9a51f9ac46ca01633fb and fixed in 5.10.246 with commit 08165c296597075763130919f2aae59b5822f016
	Issue introduced in 4.8 with commit 90017accff61ae89283ad9a51f9ac46ca01633fb and fixed in 5.15.196 with commit 03e80a4b04ef1fb2c61dd63216ab8d3a5dcb196f
	Issue introduced in 4.8 with commit 90017accff61ae89283ad9a51f9ac46ca01633fb and fixed in 6.1.158 with commit 4f6da435fb5d8a21cbf8cae5ca5a2ba0e1012b71
	Issue introduced in 4.8 with commit 90017accff61ae89283ad9a51f9ac46ca01633fb and fixed in 6.6.115 with commit cb9055ba30306ede4ad920002233d0659982f1cb
	Issue introduced in 4.8 with commit 90017accff61ae89283ad9a51f9ac46ca01633fb and fixed in 6.12.56 with commit 7a832b0f99be19df608cb75c023f8027b1789bd1
	Issue introduced in 4.8 with commit 90017accff61ae89283ad9a51f9ac46ca01633fb and fixed in 6.17.6 with commit 89b465b54227c245ddc7cc9ed822231af21123ef
	Issue introduced in 4.8 with commit 90017accff61ae89283ad9a51f9ac46ca01633fb and fixed in 6.18 with commit 441f0647f7673e0e64d4910ef61a5fb8f16bfb82

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40240
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sctp/inqueue.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/61cda2777b07d27459f5cac5a047c3edf9c8a1a9
	https://git.kernel.org/stable/c/08165c296597075763130919f2aae59b5822f016
	https://git.kernel.org/stable/c/03e80a4b04ef1fb2c61dd63216ab8d3a5dcb196f
	https://git.kernel.org/stable/c/4f6da435fb5d8a21cbf8cae5ca5a2ba0e1012b71
	https://git.kernel.org/stable/c/cb9055ba30306ede4ad920002233d0659982f1cb
	https://git.kernel.org/stable/c/7a832b0f99be19df608cb75c023f8027b1789bd1
	https://git.kernel.org/stable/c/89b465b54227c245ddc7cc9ed822231af21123ef
	https://git.kernel.org/stable/c/441f0647f7673e0e64d4910ef61a5fb8f16bfb82
