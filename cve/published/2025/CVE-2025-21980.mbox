From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21980: sched: address a potential NULL pointer dereference in the GRED scheduler.

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

sched: address a potential NULL pointer dereference in the GRED scheduler.

If kzalloc in gred_init returns a NULL pointer, the code follows the
error handling path, invoking gred_destroy. This, in turn, calls
gred_offload, where memset could receive a NULL pointer as input,
potentially leading to a kernel crash.

When table->opt is NULL in gred_init(), gred_change_table_def()
is not called yet, so it is not necessary to call ->ndo_setup_tc()
in gred_offload().

The Linux kernel CVE team has assigned CVE-2025-21980 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.16 with commit f25c0515c521375154c62c72447869f40218c861 and fixed in 6.1.132 with commit d02c9acd68950a444acda18d514e2b41f846cb7f
	Issue introduced in 5.16 with commit f25c0515c521375154c62c72447869f40218c861 and fixed in 6.6.84 with commit 0f0a152957d64ce45b4c27c687e7d087e8f45079
	Issue introduced in 5.16 with commit f25c0515c521375154c62c72447869f40218c861 and fixed in 6.12.20 with commit 68896dd50180b38ea552e49a6a00b685321e5769
	Issue introduced in 5.16 with commit f25c0515c521375154c62c72447869f40218c861 and fixed in 6.13.8 with commit 5f996b4f80c2cef1f9c77275055e7fcba44c9199
	Issue introduced in 5.16 with commit f25c0515c521375154c62c72447869f40218c861 and fixed in 6.14 with commit 115ef44a98220fddfab37a39a19370497cd718b9

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21980
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sched/sch_gred.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d02c9acd68950a444acda18d514e2b41f846cb7f
	https://git.kernel.org/stable/c/0f0a152957d64ce45b4c27c687e7d087e8f45079
	https://git.kernel.org/stable/c/68896dd50180b38ea552e49a6a00b685321e5769
	https://git.kernel.org/stable/c/5f996b4f80c2cef1f9c77275055e7fcba44c9199
	https://git.kernel.org/stable/c/115ef44a98220fddfab37a39a19370497cd718b9
