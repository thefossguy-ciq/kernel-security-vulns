{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbtrfs: fix memory leaks when rejecting a non SINGLE data profile without an RST\n\nAt the end of btrfs_load_block_group_zone_info() the first thing we do\nis to ensure that if the mapping type is not a SINGLE one and there is\nno RAID stripe tree, then we return early with an error.\n\nDoing that, though, prevents the code from running the last calls from\nthis function which are about freeing memory allocated during its\nrun. Hence, in this case, instead of returning early, we set the ret\nvalue and fall through the rest of the cleanup code."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/btrfs/zoned.c"
               ],
               "versions": [
                  {
                     "version": "5906333cc4af7b3fdb8cfff1cb3e8e579bd13174",
                     "lessThan": "187333e6d484c6630286bfdd07c79d6815a63887",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5906333cc4af7b3fdb8cfff1cb3e8e579bd13174",
                     "lessThan": "602701d00439e113331ee9c1283e95afdcb8849d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "5906333cc4af7b3fdb8cfff1cb3e8e579bd13174",
                     "lessThan": "fec9b9d3ced39f16be8d7afdf81f4dd2653da319",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "6ffeca99bf6e84800133d21afd41c79d2f002db7",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/btrfs/zoned.c"
               ],
               "versions": [
                  {
                     "version": "6.8",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.8",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.55",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.17.5",
                     "lessThanOrEqual": "6.17.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.18-rc2",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.8",
                           "versionEndExcluding": "6.12.55"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.8",
                           "versionEndExcluding": "6.17.5"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.8",
                           "versionEndExcluding": "6.18-rc2"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.7.11"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/187333e6d484c6630286bfdd07c79d6815a63887"
            },
            {
               "url": "https://git.kernel.org/stable/c/602701d00439e113331ee9c1283e95afdcb8849d"
            },
            {
               "url": "https://git.kernel.org/stable/c/fec9b9d3ced39f16be8d7afdf81f4dd2653da319"
            }
         ],
         "title": "btrfs: fix memory leaks when rejecting a non SINGLE data profile without an RST",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-40101",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
