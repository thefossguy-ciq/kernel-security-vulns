From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37820: xen-netfront: handle NULL returned by xdp_convert_buff_to_frame()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

xen-netfront: handle NULL returned by xdp_convert_buff_to_frame()

The function xdp_convert_buff_to_frame() may return NULL if it fails
to correctly convert the XDP buffer into an XDP frame due to memory
constraints, internal errors, or invalid data. Failing to check for NULL
may lead to a NULL pointer dereference if the result is used later in
processing, potentially causing crashes, data corruption, or undefined
behavior.

On XDP redirect failure, the associated page must be released explicitly
if it was previously retained via get_page(). Failing to do so may result
in a memory leak, as the pages reference count is not decremented.

The Linux kernel CVE team has assigned CVE-2025-37820 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.9 with commit 6c5aa6fc4defc2a0977a2c59e4710d50fa1e834c and fixed in 6.1.136 with commit 5b83d30c63f9964acb1bc63eb8e670b9e0d2c240
	Issue introduced in 5.9 with commit 6c5aa6fc4defc2a0977a2c59e4710d50fa1e834c and fixed in 6.6.89 with commit cefd8a2e2de46209ce66e6d30c237eb59b6c5bfa
	Issue introduced in 5.9 with commit 6c5aa6fc4defc2a0977a2c59e4710d50fa1e834c and fixed in 6.12.26 with commit d6a9c4e6f9b3ec3ad98468c950ad214af8a2efb9
	Issue introduced in 5.9 with commit 6c5aa6fc4defc2a0977a2c59e4710d50fa1e834c and fixed in 6.14.5 with commit eefccd889df3b49d92e7349d94c4aa7e1ba19f6c
	Issue introduced in 5.9 with commit 6c5aa6fc4defc2a0977a2c59e4710d50fa1e834c and fixed in 6.15-rc4 with commit cc3628dcd851ddd8d418bf0c897024b4621ddc92

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37820
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/xen-netfront.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5b83d30c63f9964acb1bc63eb8e670b9e0d2c240
	https://git.kernel.org/stable/c/cefd8a2e2de46209ce66e6d30c237eb59b6c5bfa
	https://git.kernel.org/stable/c/d6a9c4e6f9b3ec3ad98468c950ad214af8a2efb9
	https://git.kernel.org/stable/c/eefccd889df3b49d92e7349d94c4aa7e1ba19f6c
	https://git.kernel.org/stable/c/cc3628dcd851ddd8d418bf0c897024b4621ddc92
