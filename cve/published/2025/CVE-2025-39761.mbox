From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39761: wifi: ath12k: Decrement TID on RX peer frag setup error handling
Message-Id: <2025091146-CVE-2025-39761-939b@gregkh>
Content-Length: 2399
Lines: 61
X-Developer-Signature: v=1; a=openpgp-sha256; l=2461;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=fbiSZTyQesquVcJRlLAdrT1L8tvX0dhHQE9eIonhCoo=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBmH/sUFnH5xwIzb6nUHo8y+SIYJnOmarv73FrrxxhrtN
 EjZPbWnI5aFQZCJQVZMkeXLNp6j+ysOKXoZ2p6GmcPKBDKEgYtTACYi8pxhrmCm+Tf1355J+csP
 HpnivmrXUllhBoZ5ZvsLIza2JKnpVFx+yLc0oESX0bsNAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: ath12k: Decrement TID on RX peer frag setup error handling

Currently, TID is not decremented before peer cleanup, during error
handling path of ath12k_dp_rx_peer_frag_setup(). This could lead to
out-of-bounds access in peer->rx_tid[].

Hence, add a decrement operation for TID, before peer cleanup to
ensures proper cleanup and prevents out-of-bounds access issues when
the RX peer frag setup fails.

Found during code review. Compile tested only.

The Linux kernel CVE team has assigned CVE-2025-39761 to this issue.


Affected and fixed versions
===========================

	Fixed in 6.6.103 with commit eb1e1526b82b8cf31f1ef9ca86a2647fb6cd89c6
	Fixed in 6.12.43 with commit 7c3e99fd4a66a5ac9c7dd32db07359666efe0002
	Fixed in 6.15.11 with commit a3b73c72c42348bf1555fd2b00f32f941324b242
	Fixed in 6.16.2 with commit 9530d666f4376c294cdf4348c29fe3542fec980a
	Fixed in 6.17-rc1 with commit 7c0884fcd2ddde0544d2e77f297ae461e1f53f58

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39761
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/ath/ath12k/dp.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/eb1e1526b82b8cf31f1ef9ca86a2647fb6cd89c6
	https://git.kernel.org/stable/c/7c3e99fd4a66a5ac9c7dd32db07359666efe0002
	https://git.kernel.org/stable/c/a3b73c72c42348bf1555fd2b00f32f941324b242
	https://git.kernel.org/stable/c/9530d666f4376c294cdf4348c29fe3542fec980a
	https://git.kernel.org/stable/c/7c0884fcd2ddde0544d2e77f297ae461e1f53f58
