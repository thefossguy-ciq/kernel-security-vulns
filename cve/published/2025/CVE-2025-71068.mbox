From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71068: svcrdma: bound check rq_pages index in inline path

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

svcrdma: bound check rq_pages index in inline path

svc_rdma_copy_inline_range indexed rqstp->rq_pages[rc_curpage] without
verifying rc_curpage stays within the allocated page array. Add guards
before the first use and after advancing to a new page.

The Linux kernel CVE team has assigned CVE-2025-71068 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.11 with commit d7cc73972661be4a02a1b09f1d9b3283c6c05154 and fixed in 5.15.198 with commit a22316f5e9a29e4b92030bd8fb9435fe0eb1d5c9
	Issue introduced in 5.11 with commit d7cc73972661be4a02a1b09f1d9b3283c6c05154 and fixed in 6.6.120 with commit 7ba826aae1d43212f3baa53a2175ad949e21926e
	Issue introduced in 5.11 with commit d7cc73972661be4a02a1b09f1d9b3283c6c05154 and fixed in 6.12.64 with commit 5f140b525180c628db8fa6c897f138194a2de417
	Issue introduced in 5.11 with commit d7cc73972661be4a02a1b09f1d9b3283c6c05154 and fixed in 6.18.3 with commit da1ccfc4c452541584a4eae89e337cfa21be6d5a
	Issue introduced in 5.11 with commit d7cc73972661be4a02a1b09f1d9b3283c6c05154 and fixed in 6.19-rc3 with commit d1bea0ce35b6095544ee82bb54156fc62c067e58

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71068
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sunrpc/xprtrdma/svc_rdma_rw.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a22316f5e9a29e4b92030bd8fb9435fe0eb1d5c9
	https://git.kernel.org/stable/c/7ba826aae1d43212f3baa53a2175ad949e21926e
	https://git.kernel.org/stable/c/5f140b525180c628db8fa6c897f138194a2de417
	https://git.kernel.org/stable/c/da1ccfc4c452541584a4eae89e337cfa21be6d5a
	https://git.kernel.org/stable/c/d1bea0ce35b6095544ee82bb54156fc62c067e58
