From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-22054: arcnet: Add NULL check in com20020pci_probe()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

arcnet: Add NULL check in com20020pci_probe()

devm_kasprintf() returns NULL when memory allocation fails. Currently,
com20020pci_probe() does not check for this case, which results in a
NULL pointer dereference.

Add NULL check after devm_kasprintf() to prevent this issue and ensure
no resources are left allocated.

The Linux kernel CVE team has assigned CVE-2025-22054 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4.264 with commit e38cd53421ed4e37fc99662a0f2a0c567993844f and fixed in 5.4.292 with commit 661cf5d102949898c931e81fd4e1c773afcdeafa
	Issue introduced in 5.10.204 with commit d54f5a5bc85afd01b0a00689b795e31db54adc15 and fixed in 5.10.236 with commit 905a34dc1ad9a53a8aaaf8a759ea5dbaaa30418d
	Issue introduced in 5.15.143 with commit 75c53a4c43295fb8b09edae45239790db9cc69c3 and fixed in 5.15.180 with commit ef8b29398ea6061ac8257f3e45c9be45cc004ce2
	Issue introduced in 6.1.68 with commit 8d034da82563a526dbd7e9069bb3f6946403b72c and fixed in 6.1.134 with commit be8a0decd0b59a52a07276f9ef3b33ef820b2179
	Issue introduced in 6.6.7 with commit 5106d7adb74bc6160806b45ffd2321b10ca14ee0 and fixed in 6.6.87 with commit ececf8eff6c25acc239fa8f0fd837c76bc770547
	Issue introduced in 6.7 with commit 6b17a597fc2f13aaaa0a2780eb7edb9ae7ac9aea and fixed in 6.12.23 with commit ebebeb58d48e25525fa654f2c53a24713fe141c3
	Issue introduced in 6.7 with commit 6b17a597fc2f13aaaa0a2780eb7edb9ae7ac9aea and fixed in 6.13.11 with commit a654f31b33515d39bb56c75fd8b26bef025ced7e
	Issue introduced in 6.7 with commit 6b17a597fc2f13aaaa0a2780eb7edb9ae7ac9aea and fixed in 6.14.2 with commit 887226163504494ea7e58033a97c2d2ab12e05d4
	Issue introduced in 6.7 with commit 6b17a597fc2f13aaaa0a2780eb7edb9ae7ac9aea and fixed in 6.15-rc1 with commit fda8c491db2a90ff3e6fbbae58e495b4ddddeca3
	Issue introduced in 4.19.302 with commit 2e4ad90b15a7341c2d96d2dc6df6d135d72256b6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-22054
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/arcnet/com20020-pci.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/661cf5d102949898c931e81fd4e1c773afcdeafa
	https://git.kernel.org/stable/c/905a34dc1ad9a53a8aaaf8a759ea5dbaaa30418d
	https://git.kernel.org/stable/c/ef8b29398ea6061ac8257f3e45c9be45cc004ce2
	https://git.kernel.org/stable/c/be8a0decd0b59a52a07276f9ef3b33ef820b2179
	https://git.kernel.org/stable/c/ececf8eff6c25acc239fa8f0fd837c76bc770547
	https://git.kernel.org/stable/c/ebebeb58d48e25525fa654f2c53a24713fe141c3
	https://git.kernel.org/stable/c/a654f31b33515d39bb56c75fd8b26bef025ced7e
	https://git.kernel.org/stable/c/887226163504494ea7e58033a97c2d2ab12e05d4
	https://git.kernel.org/stable/c/fda8c491db2a90ff3e6fbbae58e495b4ddddeca3
