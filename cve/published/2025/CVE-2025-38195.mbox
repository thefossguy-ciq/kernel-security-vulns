From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38195: LoongArch: Fix panic caused by NULL-PMD in huge_pte_offset()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

LoongArch: Fix panic caused by NULL-PMD in huge_pte_offset()

ERROR INFO:

CPU 25 Unable to handle kernel paging request at virtual address 0x0
         ...
 Call Trace:
 [<900000000023c30c>] huge_pte_offset+0x3c/0x58
 [<900000000057fd4c>] hugetlb_follow_page_mask+0x74/0x438
 [<900000000051fee8>] __get_user_pages+0xe0/0x4c8
 [<9000000000522414>] faultin_page_range+0x84/0x380
 [<9000000000564e8c>] madvise_vma_behavior+0x534/0xa48
 [<900000000056689c>] do_madvise+0x1bc/0x3e8
 [<9000000000566df4>] sys_madvise+0x24/0x38
 [<90000000015b9e88>] do_syscall+0x78/0x98
 [<9000000000221f18>] handle_syscall+0xb8/0x158

In some cases, pmd may be NULL and rely on NULL as the return value for
processing, so it is necessary to determine this situation here.

The Linux kernel CVE team has assigned CVE-2025-38195 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.6.89 with commit 2ca9380b12711afe95b3589bd82b59623b3c96b3 and fixed in 6.6.95 with commit b427d98d55217b53c88643579fbbd8a4c351a105
	Issue introduced in 6.12.26 with commit 51424fd171cee6a33f01f7c66b8eb23ac42289d4 and fixed in 6.12.35 with commit 985f086f281b7bbb6644851e63af1a17ffff9277
	Issue introduced in 6.15 with commit bd51834d1cf65a2c801295d230c220aeebf87a73 and fixed in 6.15.4 with commit b5c7397b7fd125203c60b59860c168ee92291272
	Issue introduced in 6.15 with commit bd51834d1cf65a2c801295d230c220aeebf87a73 and fixed in 6.16-rc1 with commit ee084fa96123ede8b0563a1b5a9b23adc43cd50d
	Issue introduced in 6.1.136 with commit 34256805720993e37adf6127371a1265aea8376a
	Issue introduced in 6.14.5 with commit b49f085cd671addbda4802d6b9382513f7dd0f30

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38195
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/loongarch/mm/hugetlbpage.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/b427d98d55217b53c88643579fbbd8a4c351a105
	https://git.kernel.org/stable/c/985f086f281b7bbb6644851e63af1a17ffff9277
	https://git.kernel.org/stable/c/b5c7397b7fd125203c60b59860c168ee92291272
	https://git.kernel.org/stable/c/ee084fa96123ede8b0563a1b5a9b23adc43cd50d
