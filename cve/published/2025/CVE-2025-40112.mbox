From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40112: sparc: fix accurate exception reporting in copy_{from_to}_user for Niagara
Message-Id: <2025111249-CVE-2025-40112-5c8f@gregkh>
Content-Length: 3764
Lines: 67
X-Developer-Signature: v=1; a=openpgp-sha256; l=3832;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=LRqnitPtXVOPZTFUuzFl2HmrUFwjv+3v1ktzuhjcCJI=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJkiCaaPV6xc2SNcvjbnU33vrryKn1Of3nHL68lSFuUvY
 HnPzN7dEcvCIMjEICumyPJlG8/R/RWHFL0MbU/DzGFlAhnCwMUpABOxVWSYX5x9U5flXIGw19R/
 Bx6226+bkHDYlWHBzU8b+JcoPzgZv/gxd+ZazwTFvLaDAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

sparc: fix accurate exception reporting in copy_{from_to}_user for Niagara

The referenced commit introduced exception handlers on user-space memory
references in copy_from_user and copy_to_user. These handlers return from
the respective function and calculate the remaining bytes left to copy
using the current register contents. This commit fixes a couple of bad
calculations and a broken epilogue in the exception handlers. This will
prevent crashes and ensure correct return values of copy_from_user and
copy_to_user in the faulting case. The behaviour of memcpy stays unchanged.

The Linux kernel CVE team has assigned CVE-2025-40112 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.9 with commit 7ae3aaf53f1695877ccd5ebbc49ea65991e41f1e and fixed in 5.4.301 with commit 05440320ea3e249d5f984918f2bf51210c1a7c03
	Issue introduced in 4.9 with commit 7ae3aaf53f1695877ccd5ebbc49ea65991e41f1e and fixed in 5.10.246 with commit 7823fc4d8ab5e57f8db7806ff2530c03c166c4bb
	Issue introduced in 4.9 with commit 7ae3aaf53f1695877ccd5ebbc49ea65991e41f1e and fixed in 5.15.195 with commit 37547d8e6eba87507279ee3dfddfd9dc46335454
	Issue introduced in 4.9 with commit 7ae3aaf53f1695877ccd5ebbc49ea65991e41f1e and fixed in 6.1.156 with commit a365ee556e45f780ee322b349a06efdad0c1458f
	Issue introduced in 4.9 with commit 7ae3aaf53f1695877ccd5ebbc49ea65991e41f1e and fixed in 6.6.112 with commit 8cdeb5e482d3fdce7e825444b6ca3865e24c0228
	Issue introduced in 4.9 with commit 7ae3aaf53f1695877ccd5ebbc49ea65991e41f1e and fixed in 6.12.53 with commit a90ce516a73dbe087f9bf3dbf311301a58d125c6
	Issue introduced in 4.9 with commit 7ae3aaf53f1695877ccd5ebbc49ea65991e41f1e and fixed in 6.17.3 with commit 088c5098ec6d6b0396edfbf3dad3e81de8469c1c
	Issue introduced in 4.9 with commit 7ae3aaf53f1695877ccd5ebbc49ea65991e41f1e and fixed in 6.18-rc1 with commit 0b67c8fc10b13a9090340c5f8a37d308f4e1571c
	Issue introduced in 4.4.34 with commit bfc8be6593097cb074d3912ba2f27565cfbb7d6e
	Issue introduced in 4.8.10 with commit a15859f9d8396cce7c55ccdb7e75f70f14cbc349

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40112
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/sparc/lib/NGmemcpy.S


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/05440320ea3e249d5f984918f2bf51210c1a7c03
	https://git.kernel.org/stable/c/7823fc4d8ab5e57f8db7806ff2530c03c166c4bb
	https://git.kernel.org/stable/c/37547d8e6eba87507279ee3dfddfd9dc46335454
	https://git.kernel.org/stable/c/a365ee556e45f780ee322b349a06efdad0c1458f
	https://git.kernel.org/stable/c/8cdeb5e482d3fdce7e825444b6ca3865e24c0228
	https://git.kernel.org/stable/c/a90ce516a73dbe087f9bf3dbf311301a58d125c6
	https://git.kernel.org/stable/c/088c5098ec6d6b0396edfbf3dad3e81de8469c1c
	https://git.kernel.org/stable/c/0b67c8fc10b13a9090340c5f8a37d308f4e1571c
