From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21957: scsi: qla1280: Fix kernel oops when debug level > 2

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

scsi: qla1280: Fix kernel oops when debug level > 2

A null dereference or oops exception will eventually occur when qla1280.c
driver is compiled with DEBUG_QLA1280 enabled and ql_debug_level > 2.  I
think its clear from the code that the intention here is sg_dma_len(s) not
length of sg_next(s) when printing the debug info.

The Linux kernel CVE team has assigned CVE-2025-21957 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.292 with commit afa27b7c17a48e01546ccaad0ab017ad0496a522
	Fixed in 5.10.236 with commit 11a8dac1177a596648a020a7f3708257a2f95fee
	Fixed in 5.15.180 with commit c737e2a5fb7f90b96a96121da1b50a9c74ae9b8c
	Fixed in 6.1.132 with commit 24602e2664c515a4f2950d7b52c3d5997463418c
	Fixed in 6.6.84 with commit ea371d1cdefb0951c7127a33bcd7eb931cf44571
	Fixed in 6.12.20 with commit af71ba921d08c241a817010f96458dc5e5e26762
	Fixed in 6.13.8 with commit 7ac2473e727d67a38266b2b7e55c752402ab588c
	Fixed in 6.14 with commit 5233e3235dec3065ccc632729675575dbe3c6b8a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21957
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/scsi/qla1280.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/afa27b7c17a48e01546ccaad0ab017ad0496a522
	https://git.kernel.org/stable/c/11a8dac1177a596648a020a7f3708257a2f95fee
	https://git.kernel.org/stable/c/c737e2a5fb7f90b96a96121da1b50a9c74ae9b8c
	https://git.kernel.org/stable/c/24602e2664c515a4f2950d7b52c3d5997463418c
	https://git.kernel.org/stable/c/ea371d1cdefb0951c7127a33bcd7eb931cf44571
	https://git.kernel.org/stable/c/af71ba921d08c241a817010f96458dc5e5e26762
	https://git.kernel.org/stable/c/7ac2473e727d67a38266b2b7e55c752402ab588c
	https://git.kernel.org/stable/c/5233e3235dec3065ccc632729675575dbe3c6b8a
