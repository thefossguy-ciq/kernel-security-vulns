From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68732: gpu: host1x: Fix race in syncpt alloc/free

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

gpu: host1x: Fix race in syncpt alloc/free

Fix race condition between host1x_syncpt_alloc()
and host1x_syncpt_put() by using kref_put_mutex()
instead of kref_put() + manual mutex locking.

This ensures no thread can acquire the
syncpt_mutex after the refcount drops to zero
but before syncpt_release acquires it.
This prevents races where syncpoints could
be allocated while still being cleaned up
from a previous release.

Remove explicit mutex locking in syncpt_release
as kref_put_mutex() handles this atomically.

The Linux kernel CVE team has assigned CVE-2025-68732 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.13 with commit f5ba33fb9690566c382624637125827b5512e766 and fixed in 5.15.198 with commit ca9388fba50dac2eb71c13702b7022a801bef90e
	Issue introduced in 5.13 with commit f5ba33fb9690566c382624637125827b5512e766 and fixed in 6.1.160 with commit 4aeaece518fa4436af93d1d8b786200d9656ff4b
	Issue introduced in 5.13 with commit f5ba33fb9690566c382624637125827b5512e766 and fixed in 6.6.120 with commit 6245cce711e2cdb2cc75c0bb8632952e36f8c972
	Issue introduced in 5.13 with commit f5ba33fb9690566c382624637125827b5512e766 and fixed in 6.12.63 with commit 4e6e07ce0197aecfb6c4a62862acc93b3efedeb7
	Issue introduced in 5.13 with commit f5ba33fb9690566c382624637125827b5512e766 and fixed in 6.17.13 with commit d138f73ffb0c57ded473c577719e6e551b7b1f27
	Issue introduced in 5.13 with commit f5ba33fb9690566c382624637125827b5512e766 and fixed in 6.18.2 with commit 79197c6007f2afbfd7bcf5b9b80ccabf8483d774
	Issue introduced in 5.13 with commit f5ba33fb9690566c382624637125827b5512e766 and fixed in 6.19 with commit c7d393267c497502fa737607f435f05dfe6e3d9b

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68732
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/host1x/syncpt.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ca9388fba50dac2eb71c13702b7022a801bef90e
	https://git.kernel.org/stable/c/4aeaece518fa4436af93d1d8b786200d9656ff4b
	https://git.kernel.org/stable/c/6245cce711e2cdb2cc75c0bb8632952e36f8c972
	https://git.kernel.org/stable/c/4e6e07ce0197aecfb6c4a62862acc93b3efedeb7
	https://git.kernel.org/stable/c/d138f73ffb0c57ded473c577719e6e551b7b1f27
	https://git.kernel.org/stable/c/79197c6007f2afbfd7bcf5b9b80ccabf8483d774
	https://git.kernel.org/stable/c/c7d393267c497502fa737607f435f05dfe6e3d9b
