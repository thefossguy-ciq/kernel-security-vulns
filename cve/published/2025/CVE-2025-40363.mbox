From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40363: net: ipv6: fix field-spanning memcpy warning in AH output
Message-Id: <2025121645-CVE-2025-40363-bbdd@gregkh>
Content-Length: 3087
Lines: 70
X-Developer-Signature: v=1; a=openpgp-sha256; l=3158;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=GOhYDr/TRTXYc9Q+RhLCvxFXl2mhO6bfUMEglwKbKn0=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJmOibFP2K0rV277p6s1r2Fe78/z+1nkapnl1xjmvprB8
 eTd8+UuHbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAjCRoB6G2Sx+d29siLRMKN35
 epO7ZHTsrLj1wQzz8xoPBVt89Ra6d9r8f+SvMyu+MGVdAQA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: ipv6: fix field-spanning memcpy warning in AH output

Fix field-spanning memcpy warnings in ah6_output() and
ah6_output_done() where extension headers are copied to/from IPv6
address fields, triggering fortify-string warnings about writes beyond
the 16-byte address fields.

  memcpy: detected field-spanning write (size 40) of single field "&top_iph->saddr" at net/ipv6/ah6.c:439 (size 16)
  WARNING: CPU: 0 PID: 8838 at net/ipv6/ah6.c:439 ah6_output+0xe7e/0x14e0 net/ipv6/ah6.c:439

The warnings are false positives as the extension headers are
intentionally placed after the IPv6 header in memory. Fix by properly
copying addresses and extension headers separately, and introduce
helper functions to avoid code duplication.

The Linux kernel CVE team has assigned CVE-2025-40363 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.302 with commit 2da805a61ef5272a2773775ce14c3650adb84248
	Fixed in 5.10.247 with commit 9bf27de51bd6db5ff827780ec0eba55de230ba45
	Fixed in 5.15.197 with commit 0bf756ae1e69fec5e6332c37830488315d6d771b
	Fixed in 6.1.159 with commit 75b16b2755e12999ad850756ddfb88ad4bfc7186
	Fixed in 6.6.117 with commit f28dde240160f3c48a50d641d210ed6a3b9596ed
	Fixed in 6.12.58 with commit c14cf41094136691c92ef756872570645d61f4a1
	Fixed in 6.17.8 with commit b056f971bd72b373b7ae2025a8f3bd18f69653d3
	Fixed in 6.18 with commit 2327a3d6f65ce2fe2634546dde4a25ef52296fec

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40363
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/ipv6/ah6.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/2da805a61ef5272a2773775ce14c3650adb84248
	https://git.kernel.org/stable/c/9bf27de51bd6db5ff827780ec0eba55de230ba45
	https://git.kernel.org/stable/c/0bf756ae1e69fec5e6332c37830488315d6d771b
	https://git.kernel.org/stable/c/75b16b2755e12999ad850756ddfb88ad4bfc7186
	https://git.kernel.org/stable/c/f28dde240160f3c48a50d641d210ed6a3b9596ed
	https://git.kernel.org/stable/c/c14cf41094136691c92ef756872570645d61f4a1
	https://git.kernel.org/stable/c/b056f971bd72b373b7ae2025a8f3bd18f69653d3
	https://git.kernel.org/stable/c/2327a3d6f65ce2fe2634546dde4a25ef52296fec
