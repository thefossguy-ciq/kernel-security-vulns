From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39676: scsi: qla4xxx: Prevent a potential error pointer dereference

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

scsi: qla4xxx: Prevent a potential error pointer dereference

The qla4xxx_get_ep_fwdb() function is supposed to return NULL on error,
but qla4xxx_ep_connect() returns error pointers.  Propagating the error
pointers will lead to an Oops in the caller, so change the error pointers
to NULL.

The Linux kernel CVE team has assigned CVE-2025-39676 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.2 with commit 13483730a13bef372894aefcf73760f5c6c297be and fixed in 5.4.297 with commit d0225f41ee70611ca88ccb22c8542ecdfa7faea8
	Issue introduced in 3.2 with commit 13483730a13bef372894aefcf73760f5c6c297be and fixed in 5.10.241 with commit ad8a9d38d30c691a77c456e72b78f7932d4f234d
	Issue introduced in 3.2 with commit 13483730a13bef372894aefcf73760f5c6c297be and fixed in 5.15.190 with commit 325bf7d57c4e2a341e381c5805e454fb69dd78c3
	Issue introduced in 3.2 with commit 13483730a13bef372894aefcf73760f5c6c297be and fixed in 6.1.149 with commit 46288d12d1c30d08fbeffd05abc079f57a43a2d4
	Issue introduced in 3.2 with commit 13483730a13bef372894aefcf73760f5c6c297be and fixed in 6.6.103 with commit f5ad0819f902b4b33591791b92a0350fb3692a6b
	Issue introduced in 3.2 with commit 13483730a13bef372894aefcf73760f5c6c297be and fixed in 6.12.44 with commit f1424c830d6ce840341aac33fe99c8ac45447ac1
	Issue introduced in 3.2 with commit 13483730a13bef372894aefcf73760f5c6c297be and fixed in 6.16.4 with commit f4bc3cdfe95115191e24592bbfc15f1d4a705a75
	Issue introduced in 3.2 with commit 13483730a13bef372894aefcf73760f5c6c297be and fixed in 6.17-rc3 with commit 9dcf111dd3e7ed5fce82bb108e3a3fc001c07225

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39676
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/scsi/qla4xxx/ql4_os.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d0225f41ee70611ca88ccb22c8542ecdfa7faea8
	https://git.kernel.org/stable/c/ad8a9d38d30c691a77c456e72b78f7932d4f234d
	https://git.kernel.org/stable/c/325bf7d57c4e2a341e381c5805e454fb69dd78c3
	https://git.kernel.org/stable/c/46288d12d1c30d08fbeffd05abc079f57a43a2d4
	https://git.kernel.org/stable/c/f5ad0819f902b4b33591791b92a0350fb3692a6b
	https://git.kernel.org/stable/c/f1424c830d6ce840341aac33fe99c8ac45447ac1
	https://git.kernel.org/stable/c/f4bc3cdfe95115191e24592bbfc15f1d4a705a75
	https://git.kernel.org/stable/c/9dcf111dd3e7ed5fce82bb108e3a3fc001c07225
