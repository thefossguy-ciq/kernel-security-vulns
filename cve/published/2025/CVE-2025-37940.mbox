From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37940: ftrace: Add cond_resched() to ftrace_graph_set_hash()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ftrace: Add cond_resched() to ftrace_graph_set_hash()

When the kernel contains a large number of functions that can be traced,
the loop in ftrace_graph_set_hash() may take a lot of time to execute.
This may trigger the softlockup watchdog.

Add cond_resched() within the loop to allow the kernel to remain
responsive even when processing a large number of functions.

This matches the cond_resched() that is used in other locations of the
code that iterates over all functions that can be traced.

The Linux kernel CVE team has assigned CVE-2025-37940 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 5.4.293 with commit e5b4ae6f01d4a510d5725eca7254519a1093920d
	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 5.10.237 with commit 618655d54c5f8af5d57b77491d08c0f0ff77d114
	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 5.15.181 with commit dd38803c9088b848c6b56f4f6d7efc4497bfde61
	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 6.1.135 with commit 8dd7d7280357596ba63dfdb4c1725d9dd24bd42a
	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 6.6.88 with commit 5d336ac215e5c76e43ef4bca9ba699835e53e2fd
	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 6.12.24 with commit 1fce9574b9d515bcb8a75379a8053e18602424e3
	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 6.13.12 with commit 4429535acab750d963fdc3dfcc9e0eee42f4d599
	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 6.14.3 with commit 72be43ff061a889c6ee648a330a42486cafa15a6
	Issue introduced in 4.11 with commit b9b0c831bed2682c2e3e9f5420fb6985549ef020 and fixed in 6.15 with commit 42ea22e754ba4f2b86f8760ca27f6f71da2d982c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37940
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	kernel/trace/ftrace.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/e5b4ae6f01d4a510d5725eca7254519a1093920d
	https://git.kernel.org/stable/c/618655d54c5f8af5d57b77491d08c0f0ff77d114
	https://git.kernel.org/stable/c/dd38803c9088b848c6b56f4f6d7efc4497bfde61
	https://git.kernel.org/stable/c/8dd7d7280357596ba63dfdb4c1725d9dd24bd42a
	https://git.kernel.org/stable/c/5d336ac215e5c76e43ef4bca9ba699835e53e2fd
	https://git.kernel.org/stable/c/1fce9574b9d515bcb8a75379a8053e18602424e3
	https://git.kernel.org/stable/c/4429535acab750d963fdc3dfcc9e0eee42f4d599
	https://git.kernel.org/stable/c/72be43ff061a889c6ee648a330a42486cafa15a6
	https://git.kernel.org/stable/c/42ea22e754ba4f2b86f8760ca27f6f71da2d982c
