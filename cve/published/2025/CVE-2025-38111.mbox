From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38111: net/mdiobus: Fix potential out-of-bounds read/write access

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net/mdiobus: Fix potential out-of-bounds read/write access

When using publicly available tools like 'mdio-tools' to read/write data
from/to network interface and its PHY via mdiobus, there is no verification of
parameters passed to the ioctl and it accepts any mdio address.
Currently there is support for 32 addresses in kernel via PHY_MAX_ADDR define,
but it is possible to pass higher value than that via ioctl.
While read/write operation should generally fail in this case,
mdiobus provides stats array, where wrong address may allow out-of-bounds
read/write.

Fix that by adding address verification before read/write operation.
While this excludes this access from any statistics, it improves security of
read/write operation.

The Linux kernel CVE team has assigned CVE-2025-38111 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.6 with commit 080bb352fad00d04995102f681b134e3754bfb6e and fixed in 5.10.239 with commit 19c5875e26c4ed5686d82a7d8f7051385461b9eb
	Issue introduced in 5.6 with commit 080bb352fad00d04995102f681b134e3754bfb6e and fixed in 5.15.186 with commit 014ad9210373d2104f6ef10e6bb999a7a0a4c50e
	Issue introduced in 5.6 with commit 080bb352fad00d04995102f681b134e3754bfb6e and fixed in 6.1.142 with commit 73d478234a619f3476028cb02dee699c30ae8262
	Issue introduced in 5.6 with commit 080bb352fad00d04995102f681b134e3754bfb6e and fixed in 6.6.94 with commit bab6bca0834cbb5be2a7cfe59ec6ad016ec72608
	Issue introduced in 5.6 with commit 080bb352fad00d04995102f681b134e3754bfb6e and fixed in 6.12.34 with commit b02d9d2732483e670bc34cb233d28e1d43b15da4
	Issue introduced in 5.6 with commit 080bb352fad00d04995102f681b134e3754bfb6e and fixed in 6.15.3 with commit 049af7ac45a6b407748ee0995278fd861e36df8f
	Issue introduced in 5.6 with commit 080bb352fad00d04995102f681b134e3754bfb6e and fixed in 6.16 with commit 0e629694126ca388916f059453a1c36adde219c4

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38111
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/phy/mdio_bus.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/19c5875e26c4ed5686d82a7d8f7051385461b9eb
	https://git.kernel.org/stable/c/014ad9210373d2104f6ef10e6bb999a7a0a4c50e
	https://git.kernel.org/stable/c/73d478234a619f3476028cb02dee699c30ae8262
	https://git.kernel.org/stable/c/bab6bca0834cbb5be2a7cfe59ec6ad016ec72608
	https://git.kernel.org/stable/c/b02d9d2732483e670bc34cb233d28e1d43b15da4
	https://git.kernel.org/stable/c/049af7ac45a6b407748ee0995278fd861e36df8f
	https://git.kernel.org/stable/c/0e629694126ca388916f059453a1c36adde219c4
