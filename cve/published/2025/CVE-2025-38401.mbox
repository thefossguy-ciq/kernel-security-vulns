From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38401: mtk-sd: Prevent memory corruption from DMA map failure

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mtk-sd: Prevent memory corruption from DMA map failure

If msdc_prepare_data() fails to map the DMA region, the request is
not prepared for data receiving, but msdc_start_data() proceeds
the DMA with previous setting.
Since this will lead a memory corruption, we have to stop the
request operation soon after the msdc_prepare_data() fails to
prepare it.

The Linux kernel CVE team has assigned CVE-2025-38401 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.2 with commit 208489032bdd8d4a7de50f3057c175058f271956 and fixed in 5.4.296 with commit 5ac9e9e2e9cd6247d8c2d99780eae4556049e1cc
	Issue introduced in 4.2 with commit 208489032bdd8d4a7de50f3057c175058f271956 and fixed in 5.10.240 with commit d54771571f74a82c59830a32e76af78a8e57ac69
	Issue introduced in 4.2 with commit 208489032bdd8d4a7de50f3057c175058f271956 and fixed in 5.15.187 with commit 48bf4f3dfcdab02b22581d8e350a2d23130b72c0
	Issue introduced in 4.2 with commit 208489032bdd8d4a7de50f3057c175058f271956 and fixed in 6.1.144 with commit 63e8953f16acdcb23e2d4dd8a566d3c34df3e200
	Issue introduced in 4.2 with commit 208489032bdd8d4a7de50f3057c175058f271956 and fixed in 6.6.97 with commit 61cdd663564674ea21ceb50aa9d3697cbe9e45f9
	Issue introduced in 4.2 with commit 208489032bdd8d4a7de50f3057c175058f271956 and fixed in 6.12.37 with commit 3419bc6a7b65cbbb91417bb9970208478e034c79
	Issue introduced in 4.2 with commit 208489032bdd8d4a7de50f3057c175058f271956 and fixed in 6.15.6 with commit a5f5f67b284d81776d4a3eb1f8607e4b7f91f11c
	Issue introduced in 4.2 with commit 208489032bdd8d4a7de50f3057c175058f271956 and fixed in 6.16 with commit f5de469990f19569627ea0dd56536ff5a13beaa3

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38401
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/mmc/host/mtk-sd.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5ac9e9e2e9cd6247d8c2d99780eae4556049e1cc
	https://git.kernel.org/stable/c/d54771571f74a82c59830a32e76af78a8e57ac69
	https://git.kernel.org/stable/c/48bf4f3dfcdab02b22581d8e350a2d23130b72c0
	https://git.kernel.org/stable/c/63e8953f16acdcb23e2d4dd8a566d3c34df3e200
	https://git.kernel.org/stable/c/61cdd663564674ea21ceb50aa9d3697cbe9e45f9
	https://git.kernel.org/stable/c/3419bc6a7b65cbbb91417bb9970208478e034c79
	https://git.kernel.org/stable/c/a5f5f67b284d81776d4a3eb1f8607e4b7f91f11c
	https://git.kernel.org/stable/c/f5de469990f19569627ea0dd56536ff5a13beaa3
