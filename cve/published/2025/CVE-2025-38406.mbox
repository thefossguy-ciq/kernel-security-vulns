From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38406: wifi: ath6kl: remove WARN on bad firmware input
Message-Id: <2025072533-CVE-2025-38406-5f5c@gregkh>
Content-Length: 2691
Lines: 63
X-Developer-Signature: v=1; a=openpgp-sha256; l=2755;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=EjfAk1uiZceKxd9Sulo3IE11YJOjDoSLFGAGvYkeMMs=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBnNTX/vH7+Uv+nST6E8/2+ZB8y2nTa7dUdNuWvF8oCaq
 S4PPjIWdcSyMAgyMciKKbJ82cZzdH/FIUUvQ9vTMHNYmUCGMHBxCsBEVt1hWLA00N7lyvTMguov
 1sWTX5mvjBYL02OYKzft/hrNzEks80VSD2kmcd/T3b5eHQA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: ath6kl: remove WARN on bad firmware input

If the firmware gives bad input, that's nothing to do with
the driver's stack at this point etc., so the WARN_ON()
doesn't add any value. Additionally, this is one of the
top syzbot reports now. Just print a message, and as an
added bonus, print the sizes too.

The Linux kernel CVE team has assigned CVE-2025-38406 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.296 with commit 7a2afdc5af3b82b601f6a2f0d1c90d5f0bc27aeb
	Fixed in 5.10.240 with commit e6c49f0b203a987c306676d241066451b74db1a5
	Fixed in 5.15.187 with commit 46b47d4b06fa7f234d93f0f8ac43798feafcff89
	Fixed in 6.1.144 with commit 89bd133529a4d2d68287128b357e49adc00ec690
	Fixed in 6.6.97 with commit 347827bd0c5680dac2dd59674616840c4d5154f1
	Fixed in 6.12.37 with commit 327997afbb5e62532c28c1861ab5534c01969c9a
	Fixed in 6.15.6 with commit 27d07deea35ae67f2e75913242e25bdb7e1114e5
	Fixed in 6.16-rc3 with commit e7417421d89358da071fd2930f91e67c7128fbff

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38406
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/ath/ath6kl/bmi.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/7a2afdc5af3b82b601f6a2f0d1c90d5f0bc27aeb
	https://git.kernel.org/stable/c/e6c49f0b203a987c306676d241066451b74db1a5
	https://git.kernel.org/stable/c/46b47d4b06fa7f234d93f0f8ac43798feafcff89
	https://git.kernel.org/stable/c/89bd133529a4d2d68287128b357e49adc00ec690
	https://git.kernel.org/stable/c/347827bd0c5680dac2dd59674616840c4d5154f1
	https://git.kernel.org/stable/c/327997afbb5e62532c28c1861ab5534c01969c9a
	https://git.kernel.org/stable/c/27d07deea35ae67f2e75913242e25bdb7e1114e5
	https://git.kernel.org/stable/c/e7417421d89358da071fd2930f91e67c7128fbff
