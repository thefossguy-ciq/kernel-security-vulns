From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38694: media: dvb-frontends: dib7090p: fix null-ptr-deref in dib7090p_rw_on_apb()
Message-Id: <2025090450-CVE-2025-38694-056d@gregkh>
Content-Length: 3045
Lines: 67
X-Developer-Signature: v=1; a=openpgp-sha256; l=3113;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=4CM7uuhUjdiWze1R+55fL+Mzb2dlgjmLMcfyaLADtTU=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBk7NyqJ1IVoaD1Z5Ca+/pGJzf8/8ncXC+x4kHrq52muo
 pP3ZjV2d8SyMAgyMciKKbJ82cZzdH/FIUUvQ9vTMHNYmUCGMHBxCsBE5j1mmJ/26lSNyA6OHJWd
 lWvd+7aZWv0qP8EwV34Lc0ng5ANNeuk7fvlfFTG1+Fn0AQA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

media: dvb-frontends: dib7090p: fix null-ptr-deref in dib7090p_rw_on_apb()

In dib7090p_rw_on_apb, msg is controlled by user. When msg[0].buf is null and
msg[0].len is zero, former checks on msg[0].buf would be passed. If accessing
msg[0].buf[2] without sanity check, null pointer deref would happen. We add
check on msg[0].len to prevent crash. Similar issue occurs when access
msg[1].buf[0] and msg[1].buf[1].

Similar commit: commit 0ed554fd769a ("media: dvb-usb: az6027: fix null-ptr-deref in az6027_i2c_xfer()")

The Linux kernel CVE team has assigned CVE-2025-38694 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.297 with commit bc07cae4f36bb18d5b6a9ed835c1278ca44ec82e
	Fixed in 5.10.241 with commit ce8b7c711b9c4f040b5419729d0972db8e374324
	Fixed in 5.15.190 with commit 529fd5593b721e6f4370c591f5086649ed149ff6
	Fixed in 6.1.149 with commit c33280d6bd668dbdc5a5f07887cc63a52ab4789c
	Fixed in 6.6.103 with commit 09906650484a09b3a4d4b3d3065395856810becd
	Fixed in 6.12.43 with commit 0bb32863426afe0badac25c28d59021f211d0f48
	Fixed in 6.15.11 with commit a0f744d6cdde81d7382e183f77a4080a39b206cd
	Fixed in 6.16.2 with commit 19eb5d8e6aa1169d368a4d69aae5572950deb89d
	Fixed in 6.17-rc1 with commit ce5cac69b2edac3e3246fee03e8f4c2a1075238b

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38694
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/media/dvb-frontends/dib7000p.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/bc07cae4f36bb18d5b6a9ed835c1278ca44ec82e
	https://git.kernel.org/stable/c/ce8b7c711b9c4f040b5419729d0972db8e374324
	https://git.kernel.org/stable/c/529fd5593b721e6f4370c591f5086649ed149ff6
	https://git.kernel.org/stable/c/c33280d6bd668dbdc5a5f07887cc63a52ab4789c
	https://git.kernel.org/stable/c/09906650484a09b3a4d4b3d3065395856810becd
	https://git.kernel.org/stable/c/0bb32863426afe0badac25c28d59021f211d0f48
	https://git.kernel.org/stable/c/a0f744d6cdde81d7382e183f77a4080a39b206cd
	https://git.kernel.org/stable/c/19eb5d8e6aa1169d368a4d69aae5572950deb89d
	https://git.kernel.org/stable/c/ce5cac69b2edac3e3246fee03e8f4c2a1075238b
