From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38061: net: pktgen: fix access outside of user given buffer in pktgen_thread_write()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: pktgen: fix access outside of user given buffer in pktgen_thread_write()

Honour the user given buffer size for the strn_len() calls (otherwise
strn_len() will access memory outside of the user given buffer).

The Linux kernel CVE team has assigned CVE-2025-38061 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.4.294 with commit a3d89f1cfe1e6d4bb164db2595511fd33db21900
	Fixed in 5.10.238 with commit 5bfa81539e22af4c40ae5d43d7212253462383a6
	Fixed in 5.15.185 with commit 128cdb617a87767c29be43e4431129942fce41df
	Fixed in 6.1.141 with commit ef1158a6a650ecee72ab40851b1d52e04d3f9cb5
	Fixed in 6.6.93 with commit c81c2ee1c3b050ed5c4e92876590cc7a259183f6
	Fixed in 6.12.31 with commit 6b1d3e9db82d01a88de1795b879df67c2116b4f4
	Fixed in 6.14.9 with commit 8fef258b555c75a467a6b4b7e3a3cbc46d5f4102
	Fixed in 6.15 with commit 425e64440ad0a2f03bdaf04be0ae53dededbaa77

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38061
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/core/pktgen.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a3d89f1cfe1e6d4bb164db2595511fd33db21900
	https://git.kernel.org/stable/c/5bfa81539e22af4c40ae5d43d7212253462383a6
	https://git.kernel.org/stable/c/128cdb617a87767c29be43e4431129942fce41df
	https://git.kernel.org/stable/c/ef1158a6a650ecee72ab40851b1d52e04d3f9cb5
	https://git.kernel.org/stable/c/c81c2ee1c3b050ed5c4e92876590cc7a259183f6
	https://git.kernel.org/stable/c/6b1d3e9db82d01a88de1795b879df67c2116b4f4
	https://git.kernel.org/stable/c/8fef258b555c75a467a6b4b7e3a3cbc46d5f4102
	https://git.kernel.org/stable/c/425e64440ad0a2f03bdaf04be0ae53dededbaa77
