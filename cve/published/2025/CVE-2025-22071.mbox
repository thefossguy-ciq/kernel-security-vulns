From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-22071: spufs: fix a leak in spufs_create_context()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

spufs: fix a leak in spufs_create_context()

Leak fixes back in 2008 missed one case - if we are trying to set affinity
and spufs_mkdir() fails, we need to drop the reference to neighbor.

The Linux kernel CVE team has assigned CVE-2025-22071 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 5.4.292 with commit 829bd6139968e2e759f3928cf65ad0db1e302fe3
	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 5.10.236 with commit 410c787d89c92df4215d7b1a338e2c1a8aba6b9b
	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 5.15.180 with commit c4e72a0d75442237b6f3bcca10a7d81b89376d16
	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 6.1.134 with commit a333f223e555d27609f8b45d75a08e8e1d36c432
	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 6.6.87 with commit 239ea3c34673b3244a499fd65771c47e5bffcbb0
	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 6.12.23 with commit d04600f43569d48262e1328eaa1592fcefa2c19c
	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 6.13.11 with commit 5a90b699844a5bb96961e5892e51cc59255444a3
	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 6.14.2 with commit 4a7448c83e117ed68597952ecaede1cebc4427a7
	Issue introduced in 2.6.25 with commit 58119068cb27ef7513f80aff44b62a3a8f40ef5f and fixed in 6.15-rc1 with commit 0f5cce3fc55b08ee4da3372baccf4bcd36a98396

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-22071
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/powerpc/platforms/cell/spufs/inode.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/829bd6139968e2e759f3928cf65ad0db1e302fe3
	https://git.kernel.org/stable/c/410c787d89c92df4215d7b1a338e2c1a8aba6b9b
	https://git.kernel.org/stable/c/c4e72a0d75442237b6f3bcca10a7d81b89376d16
	https://git.kernel.org/stable/c/a333f223e555d27609f8b45d75a08e8e1d36c432
	https://git.kernel.org/stable/c/239ea3c34673b3244a499fd65771c47e5bffcbb0
	https://git.kernel.org/stable/c/d04600f43569d48262e1328eaa1592fcefa2c19c
	https://git.kernel.org/stable/c/5a90b699844a5bb96961e5892e51cc59255444a3
	https://git.kernel.org/stable/c/4a7448c83e117ed68597952ecaede1cebc4427a7
	https://git.kernel.org/stable/c/0f5cce3fc55b08ee4da3372baccf4bcd36a98396
