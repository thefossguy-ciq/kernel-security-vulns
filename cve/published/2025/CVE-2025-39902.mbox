From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39902: mm/slub: avoid accessing metadata when pointer is invalid in object_err()
Message-Id: <2025100118-CVE-2025-39902-0fe1@gregkh>
Content-Length: 3774
Lines: 71
X-Developer-Signature: v=1; a=openpgp-sha256; l=3846;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=gGc4ATw9Osir3Ks58ZgvAdIEvR/xwaO/DsQ1ElaHbQk=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBl3bk8zOSBilSgWX9X1Vt9P8Qp/1PNEm2cGFzuvzjE0k
 PdfsrW1I5aFQZCJQVZMkeXLNp6j+ysOKXoZ2p6GmcPKBDKEgYtTACYy6yvDgsN1NkcZrgcmJR6f
 O+E+76kTh9X83RkWnDH1ZhFV/ZSZ8EZrIY+Y3TajGKsnAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mm/slub: avoid accessing metadata when pointer is invalid in object_err()

object_err() reports details of an object for further debugging, such as
the freelist pointer, redzone, etc. However, if the pointer is invalid,
attempting to access object metadata can lead to a crash since it does
not point to a valid object.

One known path to the crash is when alloc_consistency_checks()
determines the pointer to the allocated object is invalid because of a
freelist corruption, and calls object_err() to report it. The debug code
should report and handle the corruption gracefully and not crash in the
process.

In case the pointer is NULL or check_valid_pointer() returns false for
the pointer, only print the pointer value and skip accessing metadata.

The Linux kernel CVE team has assigned CVE-2025-39902 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.22 with commit 81819f0fc8285a2a5a921c019e3e3d7b6169d225 and fixed in 5.4.299 with commit 872f2c34ff232af1e65ad2df86d61163c8ffad42
	Issue introduced in 2.6.22 with commit 81819f0fc8285a2a5a921c019e3e3d7b6169d225 and fixed in 5.10.243 with commit f66012909e7bf383fcdc5850709ed5716073fdc4
	Issue introduced in 2.6.22 with commit 81819f0fc8285a2a5a921c019e3e3d7b6169d225 and fixed in 5.15.192 with commit 7e287256904ee796c9477e3ec92b07f236481ef3
	Issue introduced in 2.6.22 with commit 81819f0fc8285a2a5a921c019e3e3d7b6169d225 and fixed in 6.1.151 with commit 1f0797f17927b5cad0fb7eced422f9a7c30a3191
	Issue introduced in 2.6.22 with commit 81819f0fc8285a2a5a921c019e3e3d7b6169d225 and fixed in 6.6.105 with commit 0ef7058b4dc6fcef622ac23b45225db57f17b83f
	Issue introduced in 2.6.22 with commit 81819f0fc8285a2a5a921c019e3e3d7b6169d225 and fixed in 6.12.46 with commit dda6ec365ab04067adae40ef17015db447e90736
	Issue introduced in 2.6.22 with commit 81819f0fc8285a2a5a921c019e3e3d7b6169d225 and fixed in 6.16.6 with commit 3baa1da473e6e50281324ff1d332d1a07a3bb02e
	Issue introduced in 2.6.22 with commit 81819f0fc8285a2a5a921c019e3e3d7b6169d225 and fixed in 6.17 with commit b4efccec8d06ceb10a7d34d7b1c449c569d53770

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39902
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	mm/slub.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/872f2c34ff232af1e65ad2df86d61163c8ffad42
	https://git.kernel.org/stable/c/f66012909e7bf383fcdc5850709ed5716073fdc4
	https://git.kernel.org/stable/c/7e287256904ee796c9477e3ec92b07f236481ef3
	https://git.kernel.org/stable/c/1f0797f17927b5cad0fb7eced422f9a7c30a3191
	https://git.kernel.org/stable/c/0ef7058b4dc6fcef622ac23b45225db57f17b83f
	https://git.kernel.org/stable/c/dda6ec365ab04067adae40ef17015db447e90736
	https://git.kernel.org/stable/c/3baa1da473e6e50281324ff1d332d1a07a3bb02e
	https://git.kernel.org/stable/c/b4efccec8d06ceb10a7d34d7b1c449c569d53770
