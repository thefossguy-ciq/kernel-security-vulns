From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39972: i40e: fix idx validation in i40e_validate_queue_map
Message-Id: <2025101556-CVE-2025-39972-06e0@gregkh>
Content-Length: 3216
Lines: 60
X-Developer-Signature: v=1; a=openpgp-sha256; l=3277;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=/UV6cbLK3gPtiVXqyVRMB/a21PYk1ixbIdC1fNnUGF4=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBnvg08yHJG+PrvtycnT2Z9/aqcm6RpMZmbcf/BwVTdfW
 +nJCpePHbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJrAhXJwCMJFvXAzzg3YLz5n8LHeC+/3L
 z7nun7S7XvDnPcNs1kbmk24nlkUw3/zVEGKX86GaL60bAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

i40e: fix idx validation in i40e_validate_queue_map

Ensure idx is within range of active/initialized TCs when iterating over
vf->ch[idx] in i40e_validate_queue_map().

The Linux kernel CVE team has assigned CVE-2025-39972 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 5.4.300 with commit b6cb93a7ff208f324c7ec581d72995f80e115e0e
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 5.10.245 with commit 6f15a7b34fae75e745bdc2ec05e06ddfd0dd2f3c
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 5.15.194 with commit 34dfac0c904829967d500c51f216916ce1452957
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.1.155 with commit 4d5e804a9e19b639b18fd13664dbad3c03c79e61
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.6.109 with commit 50a1e2f50f6c22b93b94eb8d168a1be3c05bf5cd
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.12.50 with commit cc4191e8ef40d2249c1b9a8617d22ec8a976b574
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.16.10 with commit d4e3eaaa3cb3af77836d806c89cd6ebf533a7320
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.17 with commit aa68d3c3ac8d1dcec40d52ae27e39f6d32207009

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39972
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/i40e/i40e_virtchnl_pf.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/b6cb93a7ff208f324c7ec581d72995f80e115e0e
	https://git.kernel.org/stable/c/6f15a7b34fae75e745bdc2ec05e06ddfd0dd2f3c
	https://git.kernel.org/stable/c/34dfac0c904829967d500c51f216916ce1452957
	https://git.kernel.org/stable/c/4d5e804a9e19b639b18fd13664dbad3c03c79e61
	https://git.kernel.org/stable/c/50a1e2f50f6c22b93b94eb8d168a1be3c05bf5cd
	https://git.kernel.org/stable/c/cc4191e8ef40d2249c1b9a8617d22ec8a976b574
	https://git.kernel.org/stable/c/d4e3eaaa3cb3af77836d806c89cd6ebf533a7320
	https://git.kernel.org/stable/c/aa68d3c3ac8d1dcec40d52ae27e39f6d32207009
