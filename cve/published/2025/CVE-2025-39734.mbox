From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39734: Revert "fs/ntfs3: Replace inode_trylock with inode_lock"

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Revert "fs/ntfs3: Replace inode_trylock with inode_lock"

This reverts commit 69505fe98f198ee813898cbcaf6770949636430b.

Initially, conditional lock acquisition was removed to fix an xfstest bug
that was observed during internal testing. The deadlock reported by syzbot
is resolved by reintroducing conditional acquisition. The xfstest bug no
longer occurs on kernel version 6.16-rc1 during internal testing. I
assume that changes in other modules may have contributed to this.

The Linux kernel CVE team has assigned CVE-2025-39734 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.15.165 with commit e3e3b3eb54feaf6400800812c8d0f95a7213923d and fixed in 5.15.190 with commit bec8109f957a6e193e52d1728799994c8005ca83
	Issue introduced in 6.1.103 with commit 7a498fc945080bccc25fdc36f1d663798441158b and fixed in 6.1.148 with commit 1903a6c1f2818154f6bc87bceaaecafa92b6ac5c
	Issue introduced in 6.6.44 with commit 53173e3865acb06f3e86c703696510c12fecc612 and fixed in 6.6.102 with commit a936be9b5f51c4d23f66fb673e9068c6b08104a4
	Issue introduced in 6.11 with commit 69505fe98f198ee813898cbcaf6770949636430b and fixed in 6.12.42 with commit b356ee013a79e7e3147bfe065de376706c5d2ee9
	Issue introduced in 6.11 with commit 69505fe98f198ee813898cbcaf6770949636430b and fixed in 6.15.10 with commit 7ce6f83ca9d52c9245b7a017466fc4baa1241b0b
	Issue introduced in 6.11 with commit 69505fe98f198ee813898cbcaf6770949636430b and fixed in 6.16.1 with commit bd20733746263acaaf2a21881665db27ee4303d5
	Issue introduced in 6.11 with commit 69505fe98f198ee813898cbcaf6770949636430b and fixed in 6.17-rc1 with commit a49f0abd8959048af18c6c690b065eb0d65b2d21
	Issue introduced in 6.10.3 with commit d5ad80aabd5a76a5de52b7663b1f3223dd01ea38

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39734
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/ntfs3/file.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/bec8109f957a6e193e52d1728799994c8005ca83
	https://git.kernel.org/stable/c/1903a6c1f2818154f6bc87bceaaecafa92b6ac5c
	https://git.kernel.org/stable/c/a936be9b5f51c4d23f66fb673e9068c6b08104a4
	https://git.kernel.org/stable/c/b356ee013a79e7e3147bfe065de376706c5d2ee9
	https://git.kernel.org/stable/c/7ce6f83ca9d52c9245b7a017466fc4baa1241b0b
	https://git.kernel.org/stable/c/bd20733746263acaaf2a21881665db27ee4303d5
	https://git.kernel.org/stable/c/a49f0abd8959048af18c6c690b065eb0d65b2d21
