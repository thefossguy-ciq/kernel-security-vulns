From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38095: dma-buf: insert memory barrier before updating num_fences

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

dma-buf: insert memory barrier before updating num_fences

smp_store_mb() inserts memory barrier after storing operation.
It is different with what the comment is originally aiming so Null
pointer dereference can be happened if memory update is reordered.

The Linux kernel CVE team has assigned CVE-2025-38095 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.0 with commit a590d0fdbaa56f482ff515e1040b6d9b1b200d63 and fixed in 6.1.140 with commit 3becc659f9cb76b481ad1fb71f54d5c8d6332d3f
	Issue introduced in 5.0 with commit a590d0fdbaa56f482ff515e1040b6d9b1b200d63 and fixed in 6.6.92 with commit c9d2b9a80d06a58f37e0dc8c827075639b443927
	Issue introduced in 5.0 with commit a590d0fdbaa56f482ff515e1040b6d9b1b200d63 and fixed in 6.12.30 with commit fe1bebd0edb22e3536cbc920ec713331d1367ad4
	Issue introduced in 5.0 with commit a590d0fdbaa56f482ff515e1040b6d9b1b200d63 and fixed in 6.14.8 with commit 08680c4dadc6e736c75bc2409d833f03f9003c51
	Issue introduced in 5.0 with commit a590d0fdbaa56f482ff515e1040b6d9b1b200d63 and fixed in 6.15 with commit 72c7d62583ebce7baeb61acce6057c361f73be4a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38095
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/dma-buf/dma-resv.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3becc659f9cb76b481ad1fb71f54d5c8d6332d3f
	https://git.kernel.org/stable/c/c9d2b9a80d06a58f37e0dc8c827075639b443927
	https://git.kernel.org/stable/c/fe1bebd0edb22e3536cbc920ec713331d1367ad4
	https://git.kernel.org/stable/c/08680c4dadc6e736c75bc2409d833f03f9003c51
	https://git.kernel.org/stable/c/72c7d62583ebce7baeb61acce6057c361f73be4a
