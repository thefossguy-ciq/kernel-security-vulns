From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71082: Bluetooth: btusb: revert use of devm_kzalloc in btusb

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Bluetooth: btusb: revert use of devm_kzalloc in btusb

This reverts commit 98921dbd00c4e ("Bluetooth: Use devm_kzalloc in
btusb.c file").

In btusb_probe(), we use devm_kzalloc() to allocate the btusb data. This
ties the lifetime of all the btusb data to the binding of a driver to
one interface, INTF. In a driver that binds to other interfaces, ISOC
and DIAG, this is an accident waiting to happen.

The issue is revealed in btusb_disconnect(), where calling
usb_driver_release_interface(&btusb_driver, data->intf) will have devm
free the data that is also being used by the other interfaces of the
driver that may not be released yet.

To fix this, revert the use of devm and go back to freeing memory
explicitly.

The Linux kernel CVE team has assigned CVE-2025-71082 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.7 with commit 98921dbd00c4e2e4bdd56423cb5edf98d57b45f7 and fixed in 5.15.198 with commit fff9206b0907252a41eb12b7c1407b9347df18b1
	Issue introduced in 3.7 with commit 98921dbd00c4e2e4bdd56423cb5edf98d57b45f7 and fixed in 6.1.160 with commit cca0e9206e3bcc63cd3e72193e60149165d493cc
	Issue introduced in 3.7 with commit 98921dbd00c4e2e4bdd56423cb5edf98d57b45f7 and fixed in 6.6.120 with commit c0ecb3e4451fe94f4315e6d09c4046dfbc42090b
	Issue introduced in 3.7 with commit 98921dbd00c4e2e4bdd56423cb5edf98d57b45f7 and fixed in 6.12.64 with commit 1e54c19eaf84ba652c4e376571093e58e144b339
	Issue introduced in 3.7 with commit 98921dbd00c4e2e4bdd56423cb5edf98d57b45f7 and fixed in 6.18.4 with commit fdf7c640fb8a44a59b0671143d8c2f738bc48003
	Issue introduced in 3.7 with commit 98921dbd00c4e2e4bdd56423cb5edf98d57b45f7 and fixed in 6.19-rc4 with commit 252714f1e8bdd542025b16321c790458014d6880

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71082
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/bluetooth/btusb.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/fff9206b0907252a41eb12b7c1407b9347df18b1
	https://git.kernel.org/stable/c/cca0e9206e3bcc63cd3e72193e60149165d493cc
	https://git.kernel.org/stable/c/c0ecb3e4451fe94f4315e6d09c4046dfbc42090b
	https://git.kernel.org/stable/c/1e54c19eaf84ba652c4e376571093e58e144b339
	https://git.kernel.org/stable/c/fdf7c640fb8a44a59b0671143d8c2f738bc48003
	https://git.kernel.org/stable/c/252714f1e8bdd542025b16321c790458014d6880
