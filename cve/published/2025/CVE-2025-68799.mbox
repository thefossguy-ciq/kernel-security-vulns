From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68799: caif: fix integer underflow in cffrml_receive()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

caif: fix integer underflow in cffrml_receive()

The cffrml_receive() function extracts a length field from the packet
header and, when FCS is disabled, subtracts 2 from this length without
validating that len >= 2.

If an attacker sends a malicious packet with a length field of 0 or 1
to an interface with FCS disabled, the subtraction causes an integer
underflow.

This can lead to memory exhaustion and kernel instability, potential
information disclosure if padding contains uninitialized kernel memory.

Fix this by validating that len >= 2 before performing the subtraction.

The Linux kernel CVE team has assigned CVE-2025-68799 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.35 with commit b482cd2053e3b90a7b33a78c63cdb6badf2ec383 and fixed in 5.10.248 with commit f407f1c9f45bbf5c99fd80b3f3f4a94fdbe35691
	Issue introduced in 2.6.35 with commit b482cd2053e3b90a7b33a78c63cdb6badf2ec383 and fixed in 5.15.198 with commit c54091eec6fed19e94182aa05dd6846600a642f7
	Issue introduced in 2.6.35 with commit b482cd2053e3b90a7b33a78c63cdb6badf2ec383 and fixed in 6.1.160 with commit 785c7be6361630070790f6235b696da156ac71b3
	Issue introduced in 2.6.35 with commit b482cd2053e3b90a7b33a78c63cdb6badf2ec383 and fixed in 6.6.120 with commit f818cd472565f8b0c2c409b040e0121c5cf8592c
	Issue introduced in 2.6.35 with commit b482cd2053e3b90a7b33a78c63cdb6badf2ec383 and fixed in 6.12.64 with commit 4ec29714aa4e0601ea29d2f02b461fc0ac92c2c3
	Issue introduced in 2.6.35 with commit b482cd2053e3b90a7b33a78c63cdb6badf2ec383 and fixed in 6.18.3 with commit 21fdcc00656a60af3c7aae2dea8dd96abd35519c
	Issue introduced in 2.6.35 with commit b482cd2053e3b90a7b33a78c63cdb6badf2ec383 and fixed in 6.19 with commit 8a11ff0948b5ad09b71896b7ccc850625f9878d1

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68799
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/caif/cffrml.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/f407f1c9f45bbf5c99fd80b3f3f4a94fdbe35691
	https://git.kernel.org/stable/c/c54091eec6fed19e94182aa05dd6846600a642f7
	https://git.kernel.org/stable/c/785c7be6361630070790f6235b696da156ac71b3
	https://git.kernel.org/stable/c/f818cd472565f8b0c2c409b040e0121c5cf8592c
	https://git.kernel.org/stable/c/4ec29714aa4e0601ea29d2f02b461fc0ac92c2c3
	https://git.kernel.org/stable/c/21fdcc00656a60af3c7aae2dea8dd96abd35519c
	https://git.kernel.org/stable/c/8a11ff0948b5ad09b71896b7ccc850625f9878d1
