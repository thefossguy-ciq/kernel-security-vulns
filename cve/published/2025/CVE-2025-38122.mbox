From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38122: gve: add missing NULL check for gve_alloc_pending_packet() in TX DQO

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

gve: add missing NULL check for gve_alloc_pending_packet() in TX DQO

gve_alloc_pending_packet() can return NULL, but gve_tx_add_skb_dqo()
did not check for this case before dereferencing the returned pointer.

Add a missing NULL check to prevent a potential NULL pointer
dereference when allocation fails.

This improves robustness in low-memory scenarios.

The Linux kernel CVE team has assigned CVE-2025-38122 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.14 with commit a57e5de476be0b4b7f42beb6a21c19ad9c577aa3 and fixed in 5.15.186 with commit ae98a1787fdcb0096d122bc80d93c3c7d812c04b
	Issue introduced in 5.14 with commit a57e5de476be0b4b7f42beb6a21c19ad9c577aa3 and fixed in 6.1.142 with commit 2e5ead9e4e91fbe7799bd38afd8904543be1cb51
	Issue introduced in 5.14 with commit a57e5de476be0b4b7f42beb6a21c19ad9c577aa3 and fixed in 6.6.94 with commit 7f6265fce3bd424ded666481b37f106d7915fb6b
	Issue introduced in 5.14 with commit a57e5de476be0b4b7f42beb6a21c19ad9c577aa3 and fixed in 6.12.34 with commit a0319c9b1648a67511e947a596ca86888451c0a7
	Issue introduced in 5.14 with commit a57e5de476be0b4b7f42beb6a21c19ad9c577aa3 and fixed in 6.15.3 with commit c741a7ef68023ac800054e2131c3e22e647fd7e3
	Issue introduced in 5.14 with commit a57e5de476be0b4b7f42beb6a21c19ad9c577aa3 and fixed in 6.16-rc1 with commit 12c331b29c7397ac3b03584e12902990693bc248

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38122
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/google/gve/gve_tx_dqo.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ae98a1787fdcb0096d122bc80d93c3c7d812c04b
	https://git.kernel.org/stable/c/2e5ead9e4e91fbe7799bd38afd8904543be1cb51
	https://git.kernel.org/stable/c/7f6265fce3bd424ded666481b37f106d7915fb6b
	https://git.kernel.org/stable/c/a0319c9b1648a67511e947a596ca86888451c0a7
	https://git.kernel.org/stable/c/c741a7ef68023ac800054e2131c3e22e647fd7e3
	https://git.kernel.org/stable/c/12c331b29c7397ac3b03584e12902990693bc248
