From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40087: NFSD: Define a proc_layoutcommit for the FlexFiles layout type
Message-Id: <2025103015-CVE-2025-40087-ff33@gregkh>
Content-Length: 3182
Lines: 60
X-Developer-Signature: v=1; a=openpgp-sha256; l=3243;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=13QpgG673H9FmzQ14iZnQkmujh8q7GOJMwD6E9P5cFQ=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJnMJvESp8pdJNZk6T9bF6jakCETud7cuZ6pJU3utVHpl
 ytGz/M6YlkYBJkYZMUUWb5s4zm6v+KQopeh7WmYOaxMIEMYuDgFYCInNjHMT7q1Ifa//+TSEzxC
 0VcVZghcfzeLgWFBY9d+729G03acsHlxdvESuzmL+jRXAAA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

NFSD: Define a proc_layoutcommit for the FlexFiles layout type

Avoid a crash if a pNFS client should happen to send a LAYOUTCOMMIT
operation on a FlexFiles layout.

The Linux kernel CVE team has assigned CVE-2025-40087 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.8 with commit 9b9960a0ca4773e21c4b153ed355583946346b25 and fixed in 5.4.301 with commit a75994dd879401c3e24ff51c2536559f1a53ea27
	Issue introduced in 4.8 with commit 9b9960a0ca4773e21c4b153ed355583946346b25 and fixed in 5.10.246 with commit 34d187e020cbda112a6c6f094f0ca5e6a8672b75
	Issue introduced in 4.8 with commit 9b9960a0ca4773e21c4b153ed355583946346b25 and fixed in 5.15.196 with commit ba88a53d7f5df4191583abf214214efe0cda91d2
	Issue introduced in 4.8 with commit 9b9960a0ca4773e21c4b153ed355583946346b25 and fixed in 6.1.158 with commit da9129ef77786839a3ccd1d7afeeab790bceaa1d
	Issue introduced in 4.8 with commit 9b9960a0ca4773e21c4b153ed355583946346b25 and fixed in 6.6.114 with commit f7353208c91ab004e0179c5fb6c365b0f132f9f0
	Issue introduced in 4.8 with commit 9b9960a0ca4773e21c4b153ed355583946346b25 and fixed in 6.12.55 with commit a156af6a4dc38c2aa7c98e89520a70fb3b3e7df4
	Issue introduced in 4.8 with commit 9b9960a0ca4773e21c4b153ed355583946346b25 and fixed in 6.17.5 with commit 785ec512afa80d0540f2ca797c0e56de747a6083
	Issue introduced in 4.8 with commit 9b9960a0ca4773e21c4b153ed355583946346b25 and fixed in 6.18-rc2 with commit 4b47a8601b71ad98833b447d465592d847b4dc77

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40087
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/nfsd/flexfilelayout.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a75994dd879401c3e24ff51c2536559f1a53ea27
	https://git.kernel.org/stable/c/34d187e020cbda112a6c6f094f0ca5e6a8672b75
	https://git.kernel.org/stable/c/ba88a53d7f5df4191583abf214214efe0cda91d2
	https://git.kernel.org/stable/c/da9129ef77786839a3ccd1d7afeeab790bceaa1d
	https://git.kernel.org/stable/c/f7353208c91ab004e0179c5fb6c365b0f132f9f0
	https://git.kernel.org/stable/c/a156af6a4dc38c2aa7c98e89520a70fb3b3e7df4
	https://git.kernel.org/stable/c/785ec512afa80d0540f2ca797c0e56de747a6083
	https://git.kernel.org/stable/c/4b47a8601b71ad98833b447d465592d847b4dc77
