From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37792: Bluetooth: btrtl: Prevent potential NULL dereference
Message-Id: <2025050120-CVE-2025-37792-def8@gregkh>
Content-Length: 2790
Lines: 59
X-Developer-Signature: v=1; a=openpgp-sha256; l=2850;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=C+MZE2okF5UEl9FSQNFKd+X6N9ByimbeO7V+4weBUxE=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBnCRRzrrG/IyKhoexVO2C+zRzBx80StooVZ2W8z6tZ8E
 Svfd2dLRywLgyATg6yYIsuXbTxH91ccUvQytD0NM4eVCWQIAxenAExk6waGBTPCA0wUvuzYfOCd
 p980bmv719tM3jHMU3HZ+9d2R3X3Ed+FKYdTnnDHLTgcDQA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Bluetooth: btrtl: Prevent potential NULL dereference

The btrtl_initialize() function checks that rtl_load_file() either
had an error or it loaded a zero length file.  However, if it loaded
a zero length file then the error code is not set correctly.  It
results in an error pointer vs NULL bug, followed by a NULL pointer
dereference.  This was detected by Smatch:

drivers/bluetooth/btrtl.c:592 btrtl_initialize() warn: passing zero to 'ERR_PTR'

The Linux kernel CVE team has assigned CVE-2025-37792 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19 with commit 26503ad25de8c7c93a2037f919c2e49a62cf65f1 and fixed in 6.1.135 with commit d8441818690d795232331bd8358545c5c95b6b72
	Issue introduced in 4.19 with commit 26503ad25de8c7c93a2037f919c2e49a62cf65f1 and fixed in 6.6.88 with commit 3db6605043b50c8bb768547b23e0222f67ceef3e
	Issue introduced in 4.19 with commit 26503ad25de8c7c93a2037f919c2e49a62cf65f1 and fixed in 6.12.25 with commit aaf356f872a60db1e96fb762a62c4607fd22741f
	Issue introduced in 4.19 with commit 26503ad25de8c7c93a2037f919c2e49a62cf65f1 and fixed in 6.14.4 with commit 53ceef799dcfc22c734d600811bfc9dd32eaea0a
	Issue introduced in 4.19 with commit 26503ad25de8c7c93a2037f919c2e49a62cf65f1 and fixed in 6.15-rc3 with commit 324dddea321078a6eeb535c2bff5257be74c9799

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37792
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/bluetooth/btrtl.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d8441818690d795232331bd8358545c5c95b6b72
	https://git.kernel.org/stable/c/3db6605043b50c8bb768547b23e0222f67ceef3e
	https://git.kernel.org/stable/c/aaf356f872a60db1e96fb762a62c4607fd22741f
	https://git.kernel.org/stable/c/53ceef799dcfc22c734d600811bfc9dd32eaea0a
	https://git.kernel.org/stable/c/324dddea321078a6eeb535c2bff5257be74c9799
