From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-23159: media: venus: hfi: add a check to handle OOB in sfr region
Message-Id: <2025050131-CVE-2025-23159-6c35@gregkh>
Content-Length: 2849
Lines: 57
X-Developer-Signature: v=1; a=openpgp-sha256; l=2907;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=BdpEP7fMWrd+qyA+1Ucp9sfRqN3ZiDXEOSAvAue/rMA=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBnC+fXVp9iLrwhkv4s50Ha1/Rhr6eTjzyaw/THR6fvek
 63kOk2jI5aFQZCJQVZMkeXLNp6j+ysOKXoZ2p6GmcPKBDKEgYtTACbCspFhfpFV7Iupb99GSNn9
 a3arlK9a/HueEsP8NO3kibyHPhqE9a288rrg5T7dbqMfAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

media: venus: hfi: add a check to handle OOB in sfr region

sfr->buf_size is in shared memory and can be modified by malicious user.
OOB write is possible when the size is made higher than actual sfr data
buffer. Cap the size to allocated size for such cases.

The Linux kernel CVE team has assigned CVE-2025-23159 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.13 with commit d96d3f30c0f2f564f6922bf4ccdf4464992e31fb and fixed in 6.1.135 with commit 4e95233af57715d81830fe82b408c633edff59f4
	Issue introduced in 4.13 with commit d96d3f30c0f2f564f6922bf4ccdf4464992e31fb and fixed in 6.6.88 with commit 5af611c70fb889d46d2f654b8996746e59556750
	Issue introduced in 4.13 with commit d96d3f30c0f2f564f6922bf4ccdf4464992e31fb and fixed in 6.12.24 with commit 530f623f56a6680792499a8404083e17f8ec51f4
	Issue introduced in 4.13 with commit d96d3f30c0f2f564f6922bf4ccdf4464992e31fb and fixed in 6.13.12 with commit a062d8de0be5525ec8c52f070acf7607ec8cbfe4
	Issue introduced in 4.13 with commit d96d3f30c0f2f564f6922bf4ccdf4464992e31fb and fixed in 6.14.3 with commit d78a8388a27b265fcb2b8d064f088168ac9356b0
	Issue introduced in 4.13 with commit d96d3f30c0f2f564f6922bf4ccdf4464992e31fb and fixed in 6.15-rc1 with commit f4b211714bcc70effa60c34d9fa613d182e3ef1e

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-23159
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/media/platform/qcom/venus/hfi_venus.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/4e95233af57715d81830fe82b408c633edff59f4
	https://git.kernel.org/stable/c/5af611c70fb889d46d2f654b8996746e59556750
	https://git.kernel.org/stable/c/530f623f56a6680792499a8404083e17f8ec51f4
	https://git.kernel.org/stable/c/a062d8de0be5525ec8c52f070acf7607ec8cbfe4
	https://git.kernel.org/stable/c/d78a8388a27b265fcb2b8d064f088168ac9356b0
	https://git.kernel.org/stable/c/f4b211714bcc70effa60c34d9fa613d182e3ef1e
