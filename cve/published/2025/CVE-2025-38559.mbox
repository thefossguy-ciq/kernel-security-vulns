From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38559: platform/x86/intel/pmt: fix a crashlog NULL pointer access
Message-Id: <2025081906-CVE-2025-38559-9fa1@gregkh>
Content-Length: 2914
Lines: 74
X-Developer-Signature: v=1; a=openpgp-sha256; l=2989;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=5Ld2G6FbmpURVmRP1/bUAwi7KDosYH8Bu+vzsj0B6Fc=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlLNp6zW78+6fiJYMPVB3wzLbmsLoQxV89OmO961fBJn
 tryezMmdcSyMAgyMciKKbJ82cZzdH/FIUUvQ9vTMHNYmUCGMHBxCsBE3h1hWHDt9Hll34SFDQZL
 TBruz1s7t0hcxoxhnumyrRxNNlW5GX1+mwqlSw/v3qwiDAA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

platform/x86/intel/pmt: fix a crashlog NULL pointer access

Usage of the intel_pmt_read() for binary sysfs, requires a pcidev. The
current use of the endpoint value is only valid for telemetry endpoint
usage.

Without the ep, the crashlog usage causes the following NULL pointer
exception:

BUG: kernel NULL pointer dereference, address: 0000000000000000
Oops: Oops: 0000 [#1] SMP NOPTI
RIP: 0010:intel_pmt_read+0x3b/0x70 [pmt_class]
Code:
Call Trace:
 <TASK>
 ? sysfs_kf_bin_read+0xc0/0xe0
 kernfs_fop_read_iter+0xac/0x1a0
 vfs_read+0x26d/0x350
 ksys_read+0x6b/0xe0
 __x64_sys_read+0x1d/0x30
 x64_sys_call+0x1bc8/0x1d70
 do_syscall_64+0x6d/0x110

Augment struct intel_pmt_entry with a pointer to the pcidev to avoid
the NULL pointer exception.

The Linux kernel CVE team has assigned CVE-2025-38559 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.12 with commit 045a513040cc0242d364c05c3791594e2294f32d and fixed in 6.12.42 with commit 860d93bd6a21f08883711196344c353bc3936a2b
	Issue introduced in 6.12 with commit 045a513040cc0242d364c05c3791594e2294f32d and fixed in 6.15.10 with commit 18d53b543b5447478e259c96ca4688393f327c98
	Issue introduced in 6.12 with commit 045a513040cc0242d364c05c3791594e2294f32d and fixed in 6.16.1 with commit 089d05266b2caf020ac2ae2cd2be78f580268f5d
	Issue introduced in 6.12 with commit 045a513040cc0242d364c05c3791594e2294f32d and fixed in 6.17-rc1 with commit 54d5cd4719c5e87f33d271c9ac2e393147d934f8

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38559
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/platform/x86/intel/pmt/class.c
	drivers/platform/x86/intel/pmt/class.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/860d93bd6a21f08883711196344c353bc3936a2b
	https://git.kernel.org/stable/c/18d53b543b5447478e259c96ca4688393f327c98
	https://git.kernel.org/stable/c/089d05266b2caf020ac2ae2cd2be78f580268f5d
	https://git.kernel.org/stable/c/54d5cd4719c5e87f33d271c9ac2e393147d934f8
