From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39763: ACPI: APEI: send SIGBUS to current task if synchronous memory error not recovered

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ACPI: APEI: send SIGBUS to current task if synchronous memory error not recovered

If a synchronous error is detected as a result of user-space process
triggering a 2-bit uncorrected error, the CPU will take a synchronous
error exception such as Synchronous External Abort (SEA) on Arm64. The
kernel will queue a memory_failure() work which poisons the related
page, unmaps the page, and then sends a SIGBUS to the process, so that
a system wide panic can be avoided.

However, no memory_failure() work will be queued when abnormal
synchronous errors occur. These errors can include situations like
invalid PA, unexpected severity, no memory failure config support,
invalid GUID section, etc. In such a case, the user-space process will
trigger SEA again.  This loop can potentially exceed the platform
firmware threshold or even trigger a kernel hard lockup, leading to a
system reboot.

Fix it by performing a force kill if no memory_failure() work is queued
for synchronous errors.

[ rjw: Changelog edits ]

The Linux kernel CVE team has assigned CVE-2025-39763 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.8 with commit 8fcc4ae6faf8b455eeef00bc9ae70744e3b0f462 and fixed in 6.1.164 with commit 2fbc85da9ac9386bd89fcc94e0aadaea19d47784
	Issue introduced in 5.8 with commit 8fcc4ae6faf8b455eeef00bc9ae70744e3b0f462 and fixed in 6.6.103 with commit 082735fbcdb6cd0cf20fbec94516ab2996f1cdd5
	Issue introduced in 5.8 with commit 8fcc4ae6faf8b455eeef00bc9ae70744e3b0f462 and fixed in 6.12.43 with commit cfc9bc15bda6fd0c496cbe2c628564d4d7c332c1
	Issue introduced in 5.8 with commit 8fcc4ae6faf8b455eeef00bc9ae70744e3b0f462 and fixed in 6.15.11 with commit af089e41811a1ad6a7b2b80e839a73ec4c3cecdd
	Issue introduced in 5.8 with commit 8fcc4ae6faf8b455eeef00bc9ae70744e3b0f462 and fixed in 6.16.2 with commit 3cb4f18797247985b0f51d5300f8cb6c78f343ea
	Issue introduced in 5.8 with commit 8fcc4ae6faf8b455eeef00bc9ae70744e3b0f462 and fixed in 6.17 with commit 79a5ae3c4c5eb7e38e0ebe4d6bf602d296080060
	Issue introduced in 5.4.69 with commit af02933d59bd1621a48d8b0b331cca9e530ba14b

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39763
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/acpi/apei/ghes.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/2fbc85da9ac9386bd89fcc94e0aadaea19d47784
	https://git.kernel.org/stable/c/082735fbcdb6cd0cf20fbec94516ab2996f1cdd5
	https://git.kernel.org/stable/c/cfc9bc15bda6fd0c496cbe2c628564d4d7c332c1
	https://git.kernel.org/stable/c/af089e41811a1ad6a7b2b80e839a73ec4c3cecdd
	https://git.kernel.org/stable/c/3cb4f18797247985b0f51d5300f8cb6c78f343ea
	https://git.kernel.org/stable/c/79a5ae3c4c5eb7e38e0ebe4d6bf602d296080060
