From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40033: remoteproc: pru: Fix potential NULL pointer dereference in pru_rproc_set_ctable()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

remoteproc: pru: Fix potential NULL pointer dereference in pru_rproc_set_ctable()

pru_rproc_set_ctable() accessed rproc->priv before the IS_ERR_OR_NULL
check, which could lead to a null pointer dereference. Move the pru
assignment, ensuring we never dereference a NULL rproc pointer.

The Linux kernel CVE team has assigned CVE-2025-40033 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.3 with commit 102853400321baea2527917e6e89be33508c3e18 and fixed in 6.6.112 with commit 66821fdb723d55b25482a76b92d17d416efeae6b
	Issue introduced in 6.3 with commit 102853400321baea2527917e6e89be33508c3e18 and fixed in 6.12.53 with commit c9b6d789591f2bd57b0cbd59592493e11e029ed4
	Issue introduced in 6.3 with commit 102853400321baea2527917e6e89be33508c3e18 and fixed in 6.17.3 with commit f0164d89950120281f2446be9687cffa1e43dbcc
	Issue introduced in 6.3 with commit 102853400321baea2527917e6e89be33508c3e18 and fixed in 6.18-rc1 with commit d41e075b077142bb9ae5df40b9ddf9fd7821a811

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40033
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/remoteproc/pru_rproc.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/66821fdb723d55b25482a76b92d17d416efeae6b
	https://git.kernel.org/stable/c/c9b6d789591f2bd57b0cbd59592493e11e029ed4
	https://git.kernel.org/stable/c/f0164d89950120281f2446be9687cffa1e43dbcc
	https://git.kernel.org/stable/c/d41e075b077142bb9ae5df40b9ddf9fd7821a811
