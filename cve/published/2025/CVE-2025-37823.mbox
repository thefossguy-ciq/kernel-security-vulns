From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37823: net_sched: hfsc: Fix a potential UAF in hfsc_dequeue() too
Message-Id: <2025050821-CVE-2025-37823-d739@gregkh>
Content-Length: 3226
Lines: 60
X-Developer-Signature: v=1; a=openpgp-sha256; l=3287;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=7vVPInhENKplXEiqEj5K0p5nuD/7PuzF+5fT2kP6Va4=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBkygTPVjjn88T9xLk679Xfuq8+tPKK5P9ZllT5U8bgpf
 nly64pVHbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAjCRiScY5juIfMib9MwtI9Li
 n3sQg8YBLS3pLwxzeHyF+KSi5nf8PRRhOfPbV0udw/8XAQA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net_sched: hfsc: Fix a potential UAF in hfsc_dequeue() too

Similarly to the previous patch, we need to safe guard hfsc_dequeue()
too. But for this one, we don't have a reliable reproducer.

The Linux kernel CVE team has assigned CVE-2025-37823 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.4.293 with commit 68f256305ceb426d545a0dc31f83c2ab1d211a1e
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.10.237 with commit 2f46d14919c39528c6e540ebc43f90055993eedc
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.15.181 with commit da7936518996d290e2fcfcaf6cd7e15bfd87804a
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.1.136 with commit 11bccb054c1462fb069219f8e98e97a5a730758e
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.6.89 with commit 76c4c22c2437d3d3880efc0f62eca06ef078d290
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.12.26 with commit c6f035044104c6ff656f4565cd22938dc892528c
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.14.5 with commit c6936266f8bf98a53f28ef9a820e6a501e946d09
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.15-rc4 with commit 6ccbda44e2cc3d26fd22af54c650d6d5d801addf

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37823
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sched/sch_hfsc.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/68f256305ceb426d545a0dc31f83c2ab1d211a1e
	https://git.kernel.org/stable/c/2f46d14919c39528c6e540ebc43f90055993eedc
	https://git.kernel.org/stable/c/da7936518996d290e2fcfcaf6cd7e15bfd87804a
	https://git.kernel.org/stable/c/11bccb054c1462fb069219f8e98e97a5a730758e
	https://git.kernel.org/stable/c/76c4c22c2437d3d3880efc0f62eca06ef078d290
	https://git.kernel.org/stable/c/c6f035044104c6ff656f4565cd22938dc892528c
	https://git.kernel.org/stable/c/c6936266f8bf98a53f28ef9a820e6a501e946d09
	https://git.kernel.org/stable/c/6ccbda44e2cc3d26fd22af54c650d6d5d801addf
