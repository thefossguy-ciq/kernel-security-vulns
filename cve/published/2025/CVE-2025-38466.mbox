From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38466: perf: Revert to requiring CAP_SYS_ADMIN for uprobes

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

perf: Revert to requiring CAP_SYS_ADMIN for uprobes

Jann reports that uprobes can be used destructively when used in the
middle of an instruction. The kernel only verifies there is a valid
instruction at the requested offset, but due to variable instruction
length cannot determine if this is an instruction as seen by the
intended execution stream.

Additionally, Mark Rutland notes that on architectures that mix data
in the text segment (like arm64), a similar things can be done if the
data word is 'mistaken' for an instruction.

As such, require CAP_SYS_ADMIN for uprobes.

The Linux kernel CVE team has assigned CVE-2025-38466 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.8 with commit c9e0924e5c2b59365f9c0d43ff8722e79ecf4088 and fixed in 5.10.240 with commit d7ef1afd5b3f43f4924326164cee5397b66abd9c
	Issue introduced in 5.8 with commit c9e0924e5c2b59365f9c0d43ff8722e79ecf4088 and fixed in 5.15.189 with commit c0aec35f861fa746ca45aa816161c74352e6ada8
	Issue introduced in 5.8 with commit c9e0924e5c2b59365f9c0d43ff8722e79ecf4088 and fixed in 6.1.146 with commit 8e8bf7bc6aa6f583336c2fda280b6cea0aed5612
	Issue introduced in 5.8 with commit c9e0924e5c2b59365f9c0d43ff8722e79ecf4088 and fixed in 6.6.99 with commit 183bdb89af1b5193b1d1d9316986053b15ca6fa4
	Issue introduced in 5.8 with commit c9e0924e5c2b59365f9c0d43ff8722e79ecf4088 and fixed in 6.12.39 with commit a0a8009083e569b5526c64f7d3f2a62baca95164
	Issue introduced in 5.8 with commit c9e0924e5c2b59365f9c0d43ff8722e79ecf4088 and fixed in 6.15.7 with commit d5074256b642cdeb46a70ce2f15193e766edca68
	Issue introduced in 5.8 with commit c9e0924e5c2b59365f9c0d43ff8722e79ecf4088 and fixed in 6.16 with commit ba677dbe77af5ffe6204e0f3f547f3ba059c6302

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38466
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	kernel/events/core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d7ef1afd5b3f43f4924326164cee5397b66abd9c
	https://git.kernel.org/stable/c/c0aec35f861fa746ca45aa816161c74352e6ada8
	https://git.kernel.org/stable/c/8e8bf7bc6aa6f583336c2fda280b6cea0aed5612
	https://git.kernel.org/stable/c/183bdb89af1b5193b1d1d9316986053b15ca6fa4
	https://git.kernel.org/stable/c/a0a8009083e569b5526c64f7d3f2a62baca95164
	https://git.kernel.org/stable/c/d5074256b642cdeb46a70ce2f15193e766edca68
	https://git.kernel.org/stable/c/ba677dbe77af5ffe6204e0f3f547f3ba059c6302
