From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39922: ixgbe: fix incorrect map used in eee linkmode
Message-Id: <2025100120-CVE-2025-39922-36d0@gregkh>
Content-Length: 2399
Lines: 58
X-Developer-Signature: v=1; a=openpgp-sha256; l=2458;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=8dmPI84ddid2KhdpGtFe1ZxBcIVdCHfxQDiznVgjsIE=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBl37mW03t/M9zvxLV9Xd+2iJWfYfH6pe2nYH4/c5LhAY
 MOJhPK9HbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAjCRyakM85P+Fy+3rZl59PZ/
 Tr/dkzfYbO8KXsUwP9Zdq0zm5ff/nW8Szef7z2t0uMoRAgA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ixgbe: fix incorrect map used in eee linkmode

incorrectly used ixgbe_lp_map in loops intended to populate the
supported and advertised EEE linkmode bitmaps based on ixgbe_ls_map.
This results in incorrect bit setting and potential out-of-bounds
access, since ixgbe_lp_map and ixgbe_ls_map have different sizes
and purposes.

ixgbe_lp_map[i] -> ixgbe_ls_map[i]

Use ixgbe_ls_map for supported and advertised linkmodes, and keep
ixgbe_lp_map usage only for link partner (lp_advertised) mapping.

The Linux kernel CVE team has assigned CVE-2025-39922 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.9 with commit 9356b6db9d051e9d939dd0f9ae7a0514103ef228 and fixed in 6.12.46 with commit 682105ab63826fb7ca7c112b42b478d156fbb19f
	Issue introduced in 6.9 with commit 9356b6db9d051e9d939dd0f9ae7a0514103ef228 and fixed in 6.16.6 with commit 129c1cb8a081a02d99267cb51708f1326395f4e8
	Issue introduced in 6.9 with commit 9356b6db9d051e9d939dd0f9ae7a0514103ef228 and fixed in 6.17 with commit b7e5c3e3bfa9dc8af75ff6d8633ad7070e1985e4

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39922
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/ixgbe/ixgbe_ethtool.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/682105ab63826fb7ca7c112b42b478d156fbb19f
	https://git.kernel.org/stable/c/129c1cb8a081a02d99267cb51708f1326395f4e8
	https://git.kernel.org/stable/c/b7e5c3e3bfa9dc8af75ff6d8633ad7070e1985e4
