From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38298: EDAC/skx_common: Fix general protection fault
Message-Id: <2025071012-CVE-2025-38298-25d2@gregkh>
Content-Length: 4446
Lines: 91
X-Developer-Signature: v=1; a=openpgp-sha256; l=4538;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=gtZvkxO1QHLg5niAxXb53tufgeB0eLe0nrawKBJKMDs=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBn5eVc2KrWW3FnrcOHtrBfvbPWX/+Arc14Vctt04/X0z
 d9jbrW/74hlYRBkYpAVU2T5so3n6P6KQ4pehranYeawMoEMYeDiFICJOBxgmJ+zljN3MteNdkNP
 bTa5BNNn63eKNjLM4SnOXhBV+2qXXOyX4tmtYnsblhzbBgA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

EDAC/skx_common: Fix general protection fault

After loading i10nm_edac (which automatically loads skx_edac_common), if
unload only i10nm_edac, then reload it and perform error injection testing,
a general protection fault may occur:

  mce: [Hardware Error]: Machine check events logged
  Oops: general protection fault ...
  ...
  Workqueue: events mce_gen_pool_process
  RIP: 0010:string+0x53/0xe0
  ...
  Call Trace:
  <TASK>
  ? die_addr+0x37/0x90
  ? exc_general_protection+0x1e7/0x3f0
  ? asm_exc_general_protection+0x26/0x30
  ? string+0x53/0xe0
  vsnprintf+0x23e/0x4c0
  snprintf+0x4d/0x70
  skx_adxl_decode+0x16a/0x330 [skx_edac_common]
  skx_mce_check_error.part.0+0xf8/0x220 [skx_edac_common]
  skx_mce_check_error+0x17/0x20 [skx_edac_common]
  ...

The issue arose was because the variable 'adxl_component_count' (inside
skx_edac_common), which counts the ADXL components, was not reset. During
the reloading of i10nm_edac, the count was incremented by the actual number
of ADXL components again, resulting in a count that was double the real
number of ADXL components. This led to an out-of-bounds reference to the
ADXL component array, causing the general protection fault above.

Fix this issue by resetting the 'adxl_component_count' in adxl_put(),
which is called during the unloading of {skx,i10nm}_edac.

The Linux kernel CVE team has assigned CVE-2025-38298 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4.282 with commit c68d1dbfe381260e8e30880fa6b8e708e57143f6 and fixed in 5.4.295 with commit 80bf28fd623d97dd4f4825fbbe9d736cec2afba3
	Issue introduced in 5.10.224 with commit 3070e81609169b316e3e3f226456950238338d43 and fixed in 5.10.239 with commit a6ed3a6edff09c1187cc6ade7f5967bca2376a13
	Issue introduced in 5.15.165 with commit 2259b26ff45a231579485752bda51acf87c39d18 and fixed in 5.15.186 with commit bf6a8502a5f4ff6e4d135d795945cdade49ec8b0
	Issue introduced in 6.1.103 with commit 6d0d9f0fd13536ed21b9c0dd576ba292f750a1c1 and fixed in 6.1.142 with commit e8530ed3c0769a4d8f79c212715ec1cf277787f8
	Issue introduced in 6.6.44 with commit c25ae63de6805589e954b86020f89065b9eca4d4 and fixed in 6.6.94 with commit 3f5d0659000923735350da60ad710f8c804544fe
	Issue introduced in 6.11 with commit 123b158635505c89ed0d3ef45c5845ff9030a466 and fixed in 6.12.34 with commit a13e8343ffcff27af1ff79597ff7ba241e6d9471
	Issue introduced in 6.11 with commit 123b158635505c89ed0d3ef45c5845ff9030a466 and fixed in 6.15.3 with commit 31ef6f7c9aee3be78d63789653e92350f2537f93
	Issue introduced in 6.11 with commit 123b158635505c89ed0d3ef45c5845ff9030a466 and fixed in 6.16-rc1 with commit 20d2d476b3ae18041be423671a8637ed5ffd6958
	Issue introduced in 6.10.3 with commit 32700ecf8007e071d1ce4c78f65b85f46d05f32a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38298
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/edac/skx_common.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/80bf28fd623d97dd4f4825fbbe9d736cec2afba3
	https://git.kernel.org/stable/c/a6ed3a6edff09c1187cc6ade7f5967bca2376a13
	https://git.kernel.org/stable/c/bf6a8502a5f4ff6e4d135d795945cdade49ec8b0
	https://git.kernel.org/stable/c/e8530ed3c0769a4d8f79c212715ec1cf277787f8
	https://git.kernel.org/stable/c/3f5d0659000923735350da60ad710f8c804544fe
	https://git.kernel.org/stable/c/a13e8343ffcff27af1ff79597ff7ba241e6d9471
	https://git.kernel.org/stable/c/31ef6f7c9aee3be78d63789653e92350f2537f93
	https://git.kernel.org/stable/c/20d2d476b3ae18041be423671a8637ed5ffd6958
