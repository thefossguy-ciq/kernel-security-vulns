From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71192: ALSA: ac97: fix a double free in snd_ac97_controller_register()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ALSA: ac97: fix a double free in snd_ac97_controller_register()

If ac97_add_adapter() fails, put_device() is the correct way to drop
the device reference. kfree() is not required.
Add kfree() if idr_alloc() fails and in ac97_adapter_release() to do
the cleanup.

Found by code review.

The Linux kernel CVE team has assigned CVE-2025-71192 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.15 with commit 74426fbff66eea8e8d1f42c8238c268d1e63a832 and fixed in 6.1.161 with commit c80f9b3349a99a9d5b295f5bbc23f544c5995ad7
	Issue introduced in 4.15 with commit 74426fbff66eea8e8d1f42c8238c268d1e63a832 and fixed in 6.6.121 with commit 21f8bc5179bed91c3f946adb5e55d717b891960c
	Issue introduced in 4.15 with commit 74426fbff66eea8e8d1f42c8238c268d1e63a832 and fixed in 6.12.66 with commit fcc04c92cbb5497ce67c58dd2f0001bb87f40396
	Issue introduced in 4.15 with commit 74426fbff66eea8e8d1f42c8238c268d1e63a832 and fixed in 6.18.6 with commit cb73d37ac18bc1716690ff5255a0ef1952827e9e
	Issue introduced in 4.15 with commit 74426fbff66eea8e8d1f42c8238c268d1e63a832 and fixed in 6.19 with commit 830988b6cf197e6dcffdfe2008c5738e6c6c3c0f

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71192
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	sound/ac97/bus.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c80f9b3349a99a9d5b295f5bbc23f544c5995ad7
	https://git.kernel.org/stable/c/21f8bc5179bed91c3f946adb5e55d717b891960c
	https://git.kernel.org/stable/c/fcc04c92cbb5497ce67c58dd2f0001bb87f40396
	https://git.kernel.org/stable/c/cb73d37ac18bc1716690ff5255a0ef1952827e9e
	https://git.kernel.org/stable/c/830988b6cf197e6dcffdfe2008c5738e6c6c3c0f
