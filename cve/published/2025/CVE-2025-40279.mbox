From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40279: net: sched: act_connmark: initialize struct tc_ife to fix kernel leak
Message-Id: <2025120717-CVE-2025-40279-81d3@gregkh>
Content-Length: 3029
Lines: 61
X-Developer-Signature: v=1; a=openpgp-sha256; l=3091;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=VrwAFDj9h0Vln3jCt8N0uqtvm/J+UGa+6OmYSPaL/j0=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJkmSye2O751Ft9Y2j3FhVX56BOvvacjrjl+eMYqud937
 fvz1qc3dsSyMAgyMciKKbJ82cZzdH/FIUUvQ9vTMHNYmUCGMHBxCsBE1G8wLJj1Id3o3KsT138s
 1RPJu2B50vB/nB/DPIuJC4rZ87dFrZiwc9uH/N/n1lpP/Q0A
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: sched: act_connmark: initialize struct tc_ife to fix kernel leak

In tcf_connmark_dump(), the variable 'opt' was partially initialized using a
designatied initializer. While the padding bytes are reamined
uninitialized. nla_put() copies the entire structure into a
netlink message, these uninitialized bytes leaked to userspace.

Initialize the structure with memset before assigning its fields
to ensure all members and padding are cleared prior to beign copied.

The Linux kernel CVE team has assigned CVE-2025-40279 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.0 with commit 22a5dc0e5e3e8fef804230cd73ed7b0afd4c7bae and fixed in 5.15.197 with commit 218b67c8c8246d47a2a7910eae80abe4861fe2b7
	Issue introduced in 4.0 with commit 22a5dc0e5e3e8fef804230cd73ed7b0afd4c7bae and fixed in 6.1.159 with commit 73cc56c608c209d3d666cc571293b090a471da70
	Issue introduced in 4.0 with commit 22a5dc0e5e3e8fef804230cd73ed7b0afd4c7bae and fixed in 6.6.117 with commit 31e4aa93e2e5b5647fc235b0f6ee329646878f9e
	Issue introduced in 4.0 with commit 22a5dc0e5e3e8fef804230cd73ed7b0afd4c7bae and fixed in 6.12.59 with commit 51cb05d4fd632596816ba44e882e84db9fb28a7e
	Issue introduced in 4.0 with commit 22a5dc0e5e3e8fef804230cd73ed7b0afd4c7bae and fixed in 6.17.9 with commit 25837889ec062f2b7618142cd80253dff3da5343
	Issue introduced in 4.0 with commit 22a5dc0e5e3e8fef804230cd73ed7b0afd4c7bae and fixed in 6.18 with commit 62b656e43eaeae445a39cd8021a4f47065af4389

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40279
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sched/act_connmark.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/218b67c8c8246d47a2a7910eae80abe4861fe2b7
	https://git.kernel.org/stable/c/73cc56c608c209d3d666cc571293b090a471da70
	https://git.kernel.org/stable/c/31e4aa93e2e5b5647fc235b0f6ee329646878f9e
	https://git.kernel.org/stable/c/51cb05d4fd632596816ba44e882e84db9fb28a7e
	https://git.kernel.org/stable/c/25837889ec062f2b7618142cd80253dff3da5343
	https://git.kernel.org/stable/c/62b656e43eaeae445a39cd8021a4f47065af4389
