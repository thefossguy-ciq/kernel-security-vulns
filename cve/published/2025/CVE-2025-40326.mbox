From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40326: NFSD: Define actions for the new time_deleg FATTR4 attributes
Message-Id: <2025120824-CVE-2025-40326-4c06@gregkh>
Content-Length: 2957
Lines: 72
X-Developer-Signature: v=1; a=openpgp-sha256; l=3030;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=9/VmFhB7y5897rDzOTBDoIJK7CsTdoNFxioFQljJ46s=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJlmCjJaeXapDY0pnxU2emit/taokDTN7Wiq4VEv5a0nJ
 oW7mF3riGVhEGRikBVTZPmyjefo/opDil6Gtqdh5rAygQxh4OIUgIk8P84wz6bWX+7BVCbeqpuh
 61yeHLPbcaRlNsOCFuMXXxr+pJ073X2373Lih/jJ3j9qAQ==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

NFSD: Define actions for the new time_deleg FATTR4 attributes

NFSv4 clients won't send legitimate GETATTR requests for these new
attributes because they are intended to be used only with CB_GETATTR
and SETATTR. But NFSD has to do something besides crashing if it
ever sees a GETATTR request that queries these attributes.

RFC 8881 Section 18.7.3 states:

> The server MUST return a value for each attribute that the client
> requests if the attribute is supported by the server for the
> target file system. If the server does not support a particular
> attribute on the target file system, then it MUST NOT return the
> attribute value and MUST NOT set the attribute bit in the result
> bitmap. The server MUST return an error if it supports an
> attribute on the target but cannot obtain its value. In that case,
> no attribute values will be returned.

Further, RFC 9754 Section 5 states:

> These new attributes are invalid to be used with GETATTR, VERIFY,
> and NVERIFY, and they can only be used with CB_GETATTR and SETATTR
> by a client holding an appropriate delegation.

Thus there does not appear to be a specific server response mandated
by specification. Taking the guidance that querying these attributes
via GETATTR is "invalid", NFSD will return nfserr_inval, failing the
request entirely.

The Linux kernel CVE team has assigned CVE-2025-40326 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.14 with commit 51c0d4f7e317d3cb4a3001e502bd8ca2d57f2a4b and fixed in 6.17.8 with commit d8f3f94dc950e7c62c96af432c26745885b0a18a
	Issue introduced in 6.14 with commit 51c0d4f7e317d3cb4a3001e502bd8ca2d57f2a4b and fixed in 6.18 with commit 4f76435fd517981f01608678c06ad9718a86ee98

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40326
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/nfsd/nfs4xdr.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d8f3f94dc950e7c62c96af432c26745885b0a18a
	https://git.kernel.org/stable/c/4f76435fd517981f01608678c06ad9718a86ee98
