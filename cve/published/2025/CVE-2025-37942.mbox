From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37942: HID: pidff: Make sure to fetch pool before checking SIMULTANEOUS_MAX

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

HID: pidff: Make sure to fetch pool before checking SIMULTANEOUS_MAX

As noted by Anssi some 20 years ago, pool report is sometimes messed up.
This worked fine on many devices but casued oops on VRS DirectForce PRO.

Here, we're making sure pool report is refetched before trying to access
any of it's fields. While loop was replaced with a for loop + exit
conditions were moved aroud to decrease the possibility of creating an
infinite loop scenario.

The Linux kernel CVE team has assigned CVE-2025-37942 to this issue.


Affected and fixed versions
===========================

	Fixed in 6.12.24 with commit 211861869766a7bb7c72158aee0140ec67e182a7
	Fixed in 6.13.12 with commit 344d903be8b5c0733ed0f4bc5be34b4a26d905c8
	Fixed in 6.14.3 with commit a6f5d30a5c7713238c5c65c98ad95dacb73688d5
	Fixed in 6.15-rc1 with commit 1f650dcec32d22deb1d6db12300a2b98483099a9

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37942
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/hid/usbhid/hid-pidff.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/211861869766a7bb7c72158aee0140ec67e182a7
	https://git.kernel.org/stable/c/344d903be8b5c0733ed0f4bc5be34b4a26d905c8
	https://git.kernel.org/stable/c/a6f5d30a5c7713238c5c65c98ad95dacb73688d5
	https://git.kernel.org/stable/c/1f650dcec32d22deb1d6db12300a2b98483099a9
