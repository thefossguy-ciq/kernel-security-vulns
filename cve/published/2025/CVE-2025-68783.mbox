From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68783: ALSA: usb-mixer: us16x08: validate meter packet indices
Message-Id: <2026011302-CVE-2025-68783-e807@gregkh>
Content-Length: 3120
Lines: 66
X-Developer-Signature: v=1; a=openpgp-sha256; l=3187;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=mYcd7WpxNDKI5u9pMyZvOixqbqq2hxxmgd/z16sL/NI=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJlpKfvm3BRmunl8b/r9mKPBDRy3VhyLaFfx+NTd7iG/7
 r6GQ3lQRywLgyATg6yYIsuXbTxH91ccUvQytD0NM4eVCWQIAxenAExk6nSGeWbqiofYjsv/rJ6u
 O/UV29b13TvDXRkW7EktfMRzYXLb2xerYmTrfUSWX3ffDAA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ALSA: usb-mixer: us16x08: validate meter packet indices

get_meter_levels_from_urb() parses the 64-byte meter packets sent by
the device and fills the per-channel arrays meter_level[],
comp_level[] and master_level[] in struct snd_us16x08_meter_store.

Currently the function derives the channel index directly from the
meter packet (MUB2(meter_urb, s) - 1) and uses it to index those
arrays without validating the range. If the packet contains a
negative or out-of-range channel number, the driver may write past
the end of these arrays.

Introduce a local channel variable and validate it before updating the
arrays. We reject negative indices, limit meter_level[] and
comp_level[] to SND_US16X08_MAX_CHANNELS, and guard master_level[]
updates with ARRAY_SIZE(master_level).

The Linux kernel CVE team has assigned CVE-2025-68783 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.11 with commit d2bb390a2081a36ffe906724d2848d846f2aeb29 and fixed in 6.1.160 with commit cde47f4ccad6751ac36b7471572ddf38ee91870c
	Issue introduced in 4.11 with commit d2bb390a2081a36ffe906724d2848d846f2aeb29 and fixed in 6.6.120 with commit 2f21a7cbaaa93926f5be15bc095b9c57c35748d9
	Issue introduced in 4.11 with commit d2bb390a2081a36ffe906724d2848d846f2aeb29 and fixed in 6.12.64 with commit a8ad320efb663be30b794e3dd3e829301c0d0ed3
	Issue introduced in 4.11 with commit d2bb390a2081a36ffe906724d2848d846f2aeb29 and fixed in 6.18.3 with commit eaa95228b8a56c4880a182c0350d67922b22408f
	Issue introduced in 4.11 with commit d2bb390a2081a36ffe906724d2848d846f2aeb29 and fixed in 6.19-rc3 with commit 5526c1c6ba1d0913c7dfcbbd6fe1744ea7c55f1e

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68783
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	sound/usb/mixer_us16x08.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cde47f4ccad6751ac36b7471572ddf38ee91870c
	https://git.kernel.org/stable/c/2f21a7cbaaa93926f5be15bc095b9c57c35748d9
	https://git.kernel.org/stable/c/a8ad320efb663be30b794e3dd3e829301c0d0ed3
	https://git.kernel.org/stable/c/eaa95228b8a56c4880a182c0350d67922b22408f
	https://git.kernel.org/stable/c/5526c1c6ba1d0913c7dfcbbd6fe1744ea7c55f1e
