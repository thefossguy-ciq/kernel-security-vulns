From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40331: sctp: Prevent TOCTOU out-of-bounds write

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

sctp: Prevent TOCTOU out-of-bounds write

For the following path not holding the sock lock,

  sctp_diag_dump() -> sctp_for_each_endpoint() -> sctp_ep_dump()

make sure not to exceed bounds in case the address list has grown
between buffer allocation (time-of-check) and write (time-of-use).

The Linux kernel CVE team has assigned CVE-2025-40331 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.7 with commit 8f840e47f190cbe61a96945c13e9551048d42cef and fixed in 5.4.302 with commit b106a68df0650b694b254427cd9250c04500edd3
	Issue introduced in 4.7 with commit 8f840e47f190cbe61a96945c13e9551048d42cef and fixed in 5.10.247 with commit 3006959371007fc2eae4a078f823c680fa52de1a
	Issue introduced in 4.7 with commit 8f840e47f190cbe61a96945c13e9551048d42cef and fixed in 5.15.197 with commit 72e3fea68eac8d088e44c3dd954e843478e9240e
	Issue introduced in 4.7 with commit 8f840e47f190cbe61a96945c13e9551048d42cef and fixed in 6.1.159 with commit 584307275b2048991b2e8984962189b6cc0a9b85
	Issue introduced in 4.7 with commit 8f840e47f190cbe61a96945c13e9551048d42cef and fixed in 6.6.117 with commit c9119f243d9c0da3c3b5f577a328de3e7ffd1b42
	Issue introduced in 4.7 with commit 8f840e47f190cbe61a96945c13e9551048d42cef and fixed in 6.12.58 with commit 2fe08fcaacb7eb019fa9c81db39b2214de216677
	Issue introduced in 4.7 with commit 8f840e47f190cbe61a96945c13e9551048d42cef and fixed in 6.17.8 with commit 89eac1e150dbd42963e13d23828cb8c4e0763196
	Issue introduced in 4.7 with commit 8f840e47f190cbe61a96945c13e9551048d42cef and fixed in 6.18 with commit 95aef86ab231f047bb8085c70666059b58f53c09

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40331
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sctp/diag.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/b106a68df0650b694b254427cd9250c04500edd3
	https://git.kernel.org/stable/c/3006959371007fc2eae4a078f823c680fa52de1a
	https://git.kernel.org/stable/c/72e3fea68eac8d088e44c3dd954e843478e9240e
	https://git.kernel.org/stable/c/584307275b2048991b2e8984962189b6cc0a9b85
	https://git.kernel.org/stable/c/c9119f243d9c0da3c3b5f577a328de3e7ffd1b42
	https://git.kernel.org/stable/c/2fe08fcaacb7eb019fa9c81db39b2214de216677
	https://git.kernel.org/stable/c/89eac1e150dbd42963e13d23828cb8c4e0763196
	https://git.kernel.org/stable/c/95aef86ab231f047bb8085c70666059b58f53c09
