From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68353: net: vxlan: prevent NULL deref in vxlan_xmit_one
Message-Id: <2025122455-CVE-2025-68353-8704@gregkh>
Content-Length: 2501
Lines: 66
X-Developer-Signature: v=1; a=openpgp-sha256; l=2568;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=nCHzJ0kDy36Yfda93TT55mNP8p7kKvUpre4DN4n6QiM=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJneB89nMsisuVDflbuC+8Jmw7NF0vt87QWWf9NNXHywo
 3Xj6zf3OmJZGASZGGTFFFm+bOM5ur/ikKKXoe1pmDmsTCBDGLg4BWAiJvUM8x08P92YcFz0jOGN
 4qynC4+4Hjp06xHDPCPJnrl6xttqs7dMjHmTk/hKI2TxMQA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: vxlan: prevent NULL deref in vxlan_xmit_one

Neither sock4 nor sock6 pointers are guaranteed to be non-NULL in
vxlan_xmit_one, e.g. if the iface is brought down. This can lead to the
following NULL dereference:

  BUG: kernel NULL pointer dereference, address: 0000000000000010
  Oops: Oops: 0000 [#1] SMP NOPTI
  RIP: 0010:vxlan_xmit_one+0xbb3/0x1580
  Call Trace:
   vxlan_xmit+0x429/0x610
   dev_hard_start_xmit+0x55/0xa0
   __dev_queue_xmit+0x6d0/0x7f0
   ip_finish_output2+0x24b/0x590
   ip_output+0x63/0x110

Mentioned commits changed the code path in vxlan_xmit_one and as a side
effect the sock4/6 pointer validity checks in vxlan(6)_get_route were
lost. Fix this by adding back checks.

Since both commits being fixed were released in the same version (v6.7)
and are strongly related, bundle the fixes in a single commit.

The Linux kernel CVE team has assigned CVE-2025-68353 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.7 with commit 6f19b2c136d98a84d79030b53e23d405edfdc783 and fixed in 6.18.2 with commit 4ac26aafdc8c7271414e2e7c0b2cb266a26591bc
	Issue introduced in 6.7 with commit 6f19b2c136d98a84d79030b53e23d405edfdc783 and fixed in 6.19-rc1 with commit 1f73a56f986005f0bc64ed23873930e2ee4f5911

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68353
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/vxlan/vxlan_core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/4ac26aafdc8c7271414e2e7c0b2cb266a26591bc
	https://git.kernel.org/stable/c/1f73a56f986005f0bc64ed23873930e2ee4f5911
