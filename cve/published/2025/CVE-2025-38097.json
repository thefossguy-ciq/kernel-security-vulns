{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nespintcp: remove encap socket caching to avoid reference leak\n\nThe current scheme for caching the encap socket can lead to reference\nleaks when we try to delete the netns.\n\nThe reference chain is: xfrm_state -> enacp_sk -> netns\n\nSince the encap socket is a userspace socket, it holds a reference on\nthe netns. If we delete the espintcp state (through flush or\nindividual delete) before removing the netns, the reference on the\nsocket is dropped and the netns is correctly deleted. Otherwise, the\nnetns may not be reachable anymore (if all processes within the ns\nhave terminated), so we cannot delete the xfrm state to drop its\nreference on the socket.\n\nThis patch results in a small (~2% in my tests) performance\nregression.\n\nA GC-type mechanism could be added for the socket cache, to clear\nreferences if the state hasn't been used \"recently\", but it's a lot\nmore complex than just not caching the socket."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "include/net/xfrm.h",
                  "net/ipv4/esp4.c",
                  "net/ipv6/esp6.c",
                  "net/xfrm/xfrm_state.c"
               ],
               "versions": [
                  {
                     "version": "e27cca96cd68fa2c6814c90f9a1cfd36bb68c593",
                     "lessThan": "e4cde54b46a87231c77256a633be1bef62687d69",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "e27cca96cd68fa2c6814c90f9a1cfd36bb68c593",
                     "lessThan": "b58a295d10065960bcb9d60cb8ca6ead9837cd27",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "e27cca96cd68fa2c6814c90f9a1cfd36bb68c593",
                     "lessThan": "9cbca30102028f9ad3d2098f935c4368f581fd07",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "e27cca96cd68fa2c6814c90f9a1cfd36bb68c593",
                     "lessThan": "74fd327767fb784c5875cf7c4ba1217f26020943",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "e27cca96cd68fa2c6814c90f9a1cfd36bb68c593",
                     "lessThan": "028363685bd0b7a19b4a820f82dd905b1dc83999",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "include/net/xfrm.h",
                  "net/ipv4/esp4.c",
                  "net/ipv6/esp6.c",
                  "net/xfrm/xfrm_state.c"
               ],
               "versions": [
                  {
                     "version": "5.6",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.6",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.141",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.93",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.31",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.14.9",
                     "lessThanOrEqual": "6.14.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.15",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.6",
                           "versionEndExcluding": "6.1.141"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.6",
                           "versionEndExcluding": "6.6.93"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.6",
                           "versionEndExcluding": "6.12.31"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.6",
                           "versionEndExcluding": "6.14.9"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.6",
                           "versionEndExcluding": "6.15"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/e4cde54b46a87231c77256a633be1bef62687d69"
            },
            {
               "url": "https://git.kernel.org/stable/c/b58a295d10065960bcb9d60cb8ca6ead9837cd27"
            },
            {
               "url": "https://git.kernel.org/stable/c/9cbca30102028f9ad3d2098f935c4368f581fd07"
            },
            {
               "url": "https://git.kernel.org/stable/c/74fd327767fb784c5875cf7c4ba1217f26020943"
            },
            {
               "url": "https://git.kernel.org/stable/c/028363685bd0b7a19b4a820f82dd905b1dc83999"
            }
         ],
         "title": "espintcp: remove encap socket caching to avoid reference leak",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-38097",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
