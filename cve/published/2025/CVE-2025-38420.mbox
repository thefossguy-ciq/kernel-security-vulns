From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38420: wifi: carl9170: do not ping device which has failed to load firmware

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: carl9170: do not ping device which has failed to load firmware

Syzkaller reports [1, 2] crashes caused by an attempts to ping
the device which has failed to load firmware. Since such a device
doesn't pass 'ieee80211_register_hw()', an internal workqueue
managed by 'ieee80211_queue_work()' is not yet created and an
attempt to queue work on it causes null-ptr-deref.

[1] https://syzkaller.appspot.com/bug?extid=9a4aec827829942045ff
[2] https://syzkaller.appspot.com/bug?extid=0d8afba53e8fb2633217

The Linux kernel CVE team has assigned CVE-2025-38420 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.38 with commit e4a668c59080f862af3ecc28b359533027cbe434 and fixed in 5.4.295 with commit 0140d3d37f0f1759d1fdedd854c7875a86e15f8d
	Issue introduced in 2.6.38 with commit e4a668c59080f862af3ecc28b359533027cbe434 and fixed in 5.10.239 with commit 8a3734a6f4c05fd24605148f21fb2066690d61b3
	Issue introduced in 2.6.38 with commit e4a668c59080f862af3ecc28b359533027cbe434 and fixed in 5.15.186 with commit 527fad1ae32ffa2d4853a1425fe1c8dbb8c9744c
	Issue introduced in 2.6.38 with commit e4a668c59080f862af3ecc28b359533027cbe434 and fixed in 6.1.142 with commit bfeede26e97ce4a15a0b961118de4a0e28c9907a
	Issue introduced in 2.6.38 with commit e4a668c59080f862af3ecc28b359533027cbe434 and fixed in 6.6.95 with commit 4e9ab5c48ad5153cc908dd29abad0cd2a92951e4
	Issue introduced in 2.6.38 with commit e4a668c59080f862af3ecc28b359533027cbe434 and fixed in 6.12.35 with commit 301268dbaac8e9013719e162a000202eac8054be
	Issue introduced in 2.6.38 with commit e4a668c59080f862af3ecc28b359533027cbe434 and fixed in 6.15.4 with commit 11ef72b3312752c2ff92f3c1e64912be3228ed36
	Issue introduced in 2.6.38 with commit e4a668c59080f862af3ecc28b359533027cbe434 and fixed in 6.16 with commit 15d25307692312cec4b57052da73387f91a2e870

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38420
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/ath/carl9170/usb.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/0140d3d37f0f1759d1fdedd854c7875a86e15f8d
	https://git.kernel.org/stable/c/8a3734a6f4c05fd24605148f21fb2066690d61b3
	https://git.kernel.org/stable/c/527fad1ae32ffa2d4853a1425fe1c8dbb8c9744c
	https://git.kernel.org/stable/c/bfeede26e97ce4a15a0b961118de4a0e28c9907a
	https://git.kernel.org/stable/c/4e9ab5c48ad5153cc908dd29abad0cd2a92951e4
	https://git.kernel.org/stable/c/301268dbaac8e9013719e162a000202eac8054be
	https://git.kernel.org/stable/c/11ef72b3312752c2ff92f3c1e64912be3228ed36
	https://git.kernel.org/stable/c/15d25307692312cec4b57052da73387f91a2e870
