From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37850: pwm: mediatek: Prevent divide-by-zero in pwm_mediatek_config()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

pwm: mediatek: Prevent divide-by-zero in pwm_mediatek_config()

With CONFIG_COMPILE_TEST && !CONFIG_HAVE_CLK, pwm_mediatek_config() has a
divide-by-zero in the following line:

	do_div(resolution, clk_get_rate(pc->clk_pwms[pwm->hwpwm]));

due to the fact that the !CONFIG_HAVE_CLK version of clk_get_rate()
returns zero.

This is presumably just a theoretical problem: COMPILE_TEST overrides
the dependency on RALINK which would select COMMON_CLK.  Regardless it's
a good idea to check for the error explicitly to avoid divide-by-zero.

Fixes the following warning:

  drivers/pwm/pwm-mediatek.o: warning: objtool: .text: unexpected end of section

[ukleinek: s/CONFIG_CLK/CONFIG_HAVE_CLK/]

The Linux kernel CVE team has assigned CVE-2025-37850 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 5.4.293 with commit 8b9f60725d74b72c238e4437c957d0217746b506
	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 5.10.237 with commit e1206d8e1651c9f62e5640b69b14d925b1a0a00a
	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 5.15.181 with commit e3cf0c38d3ce754ad63005102fcfeb0b7ff3290b
	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 6.1.135 with commit f3e9cf266c2c103cf071e15d7a17e2c699fff3c5
	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 6.6.88 with commit 8ddbec73ea2598d8414e8f7103241b55cf877010
	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 6.12.24 with commit 4cb15042b5f3ec0474e91cf379120cc597625dbb
	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 6.13.12 with commit c343856ff2689ce0afef823592732fc178ef4aac
	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 6.14.3 with commit 77fb96dbe350e8a5ae4965ff9f6e7049f3966a6b
	Issue introduced in 4.12 with commit caf065f8fd583b43a3f95d84c8a0a0d07597963b and fixed in 6.15 with commit 7ca59947b5fcf94e7ea4029d1bd0f7c41500a161

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37850
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/pwm/pwm-mediatek.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/8b9f60725d74b72c238e4437c957d0217746b506
	https://git.kernel.org/stable/c/e1206d8e1651c9f62e5640b69b14d925b1a0a00a
	https://git.kernel.org/stable/c/e3cf0c38d3ce754ad63005102fcfeb0b7ff3290b
	https://git.kernel.org/stable/c/f3e9cf266c2c103cf071e15d7a17e2c699fff3c5
	https://git.kernel.org/stable/c/8ddbec73ea2598d8414e8f7103241b55cf877010
	https://git.kernel.org/stable/c/4cb15042b5f3ec0474e91cf379120cc597625dbb
	https://git.kernel.org/stable/c/c343856ff2689ce0afef823592732fc178ef4aac
	https://git.kernel.org/stable/c/77fb96dbe350e8a5ae4965ff9f6e7049f3966a6b
	https://git.kernel.org/stable/c/7ca59947b5fcf94e7ea4029d1bd0f7c41500a161
