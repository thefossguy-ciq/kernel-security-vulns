From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39847: ppp: fix memory leak in pad_compress_skb

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ppp: fix memory leak in pad_compress_skb

If alloc_skb() fails in pad_compress_skb(), it returns NULL without
releasing the old skb. The caller does:

    skb = pad_compress_skb(ppp, skb);
    if (!skb)
        goto drop;

drop:
    kfree_skb(skb);

When pad_compress_skb() returns NULL, the reference to the old skb is
lost and kfree_skb(skb) ends up doing nothing, leading to a memory leak.

Align pad_compress_skb() semantics with realloc(): only free the old
skb if allocation and compression succeed.  At the call site, use the
new_skb variable so the original skb is not lost when pad_compress_skb()
fails.

The Linux kernel CVE team has assigned CVE-2025-39847 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.15 with commit b3f9b92a6ec1a9a5e4b4b36e484f2f62cc73277c and fixed in 5.4.299 with commit 9ca6a040f76c0b149293e430dabab446f3fc8ab7
	Issue introduced in 2.6.15 with commit b3f9b92a6ec1a9a5e4b4b36e484f2f62cc73277c and fixed in 5.10.243 with commit 87a35a36742df328d0badf4fbc2e56061c15846c
	Issue introduced in 2.6.15 with commit b3f9b92a6ec1a9a5e4b4b36e484f2f62cc73277c and fixed in 5.15.192 with commit 0b21e9cd4559102da798bdcba453b64ecd7be7ee
	Issue introduced in 2.6.15 with commit b3f9b92a6ec1a9a5e4b4b36e484f2f62cc73277c and fixed in 6.1.151 with commit 1d8b354eafb8876d8bdb1bef69c7d2438aacfbe8
	Issue introduced in 2.6.15 with commit b3f9b92a6ec1a9a5e4b4b36e484f2f62cc73277c and fixed in 6.6.105 with commit 85c1c86a67e09143aa464e9bf09c397816772348
	Issue introduced in 2.6.15 with commit b3f9b92a6ec1a9a5e4b4b36e484f2f62cc73277c and fixed in 6.12.46 with commit 631fc8ab5beb9e0ec8651fb9875b9a968e7b4ae4
	Issue introduced in 2.6.15 with commit b3f9b92a6ec1a9a5e4b4b36e484f2f62cc73277c and fixed in 6.16.6 with commit 33a5bac5f14772730d2caf632ae97b6c2ee95044
	Issue introduced in 2.6.15 with commit b3f9b92a6ec1a9a5e4b4b36e484f2f62cc73277c and fixed in 6.17 with commit 4844123fe0b853a4982c02666cb3fd863d701d50

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39847
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ppp/ppp_generic.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/9ca6a040f76c0b149293e430dabab446f3fc8ab7
	https://git.kernel.org/stable/c/87a35a36742df328d0badf4fbc2e56061c15846c
	https://git.kernel.org/stable/c/0b21e9cd4559102da798bdcba453b64ecd7be7ee
	https://git.kernel.org/stable/c/1d8b354eafb8876d8bdb1bef69c7d2438aacfbe8
	https://git.kernel.org/stable/c/85c1c86a67e09143aa464e9bf09c397816772348
	https://git.kernel.org/stable/c/631fc8ab5beb9e0ec8651fb9875b9a968e7b4ae4
	https://git.kernel.org/stable/c/33a5bac5f14772730d2caf632ae97b6c2ee95044
	https://git.kernel.org/stable/c/4844123fe0b853a4982c02666cb3fd863d701d50
