From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38145: soc: aspeed: Add NULL check in aspeed_lpc_enable_snoop()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

soc: aspeed: Add NULL check in aspeed_lpc_enable_snoop()

devm_kasprintf() returns NULL when memory allocation fails. Currently,
aspeed_lpc_enable_snoop() does not check for this case, which results in a
NULL pointer dereference.

Add NULL check after devm_kasprintf() to prevent this issue.

[arj: Fix Fixes: tag to use subject from 3772e5da4454]

The Linux kernel CVE team has assigned CVE-2025-38145 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19 with commit 3772e5da445420543b25825ac2b5971f3743f6e8 and fixed in 5.4.295 with commit 2beee9cf833374550e673d428ad8b6ab37c175b3
	Issue introduced in 4.19 with commit 3772e5da445420543b25825ac2b5971f3743f6e8 and fixed in 5.10.239 with commit c550999f939b529d28a914d5034cc4290066aea6
	Issue introduced in 4.19 with commit 3772e5da445420543b25825ac2b5971f3743f6e8 and fixed in 5.15.186 with commit 1fd889c145722579aa038c31cbc07cfdd4d75166
	Issue introduced in 4.19 with commit 3772e5da445420543b25825ac2b5971f3743f6e8 and fixed in 6.1.142 with commit d62a589eaaec6385e3e2b25cf5a28b4560ace93f
	Issue introduced in 4.19 with commit 3772e5da445420543b25825ac2b5971f3743f6e8 and fixed in 6.6.94 with commit 8312b1f776f71979bf33bda7acc05b348e8792c7
	Issue introduced in 4.19 with commit 3772e5da445420543b25825ac2b5971f3743f6e8 and fixed in 6.12.34 with commit f697ef117ecbf3a367dfc559a6a3589905956530
	Issue introduced in 4.19 with commit 3772e5da445420543b25825ac2b5971f3743f6e8 and fixed in 6.15.3 with commit 45b2e8b0fdd280aba04c3cc869e9ae500c44e4b7
	Issue introduced in 4.19 with commit 3772e5da445420543b25825ac2b5971f3743f6e8 and fixed in 6.16-rc1 with commit f1706e0e1a74b095cbc60375b9b1e6205f5f4c98

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38145
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/soc/aspeed/aspeed-lpc-snoop.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/2beee9cf833374550e673d428ad8b6ab37c175b3
	https://git.kernel.org/stable/c/c550999f939b529d28a914d5034cc4290066aea6
	https://git.kernel.org/stable/c/1fd889c145722579aa038c31cbc07cfdd4d75166
	https://git.kernel.org/stable/c/d62a589eaaec6385e3e2b25cf5a28b4560ace93f
	https://git.kernel.org/stable/c/8312b1f776f71979bf33bda7acc05b348e8792c7
	https://git.kernel.org/stable/c/f697ef117ecbf3a367dfc559a6a3589905956530
	https://git.kernel.org/stable/c/45b2e8b0fdd280aba04c3cc869e9ae500c44e4b7
	https://git.kernel.org/stable/c/f1706e0e1a74b095cbc60375b9b1e6205f5f4c98
