From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38159: wifi: rtw88: fix the 'para' buffer size to avoid reading out of bounds

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: rtw88: fix the 'para' buffer size to avoid reading out of bounds

Set the size to 6 instead of 2, since 'para' array is passed to
'rtw_fw_bt_wifi_control(rtwdev, para[0], &para[1])', which reads
5 bytes:

void rtw_fw_bt_wifi_control(struct rtw_dev *rtwdev, u8 op_code, u8 *data)
{
    ...
    SET_BT_WIFI_CONTROL_DATA1(h2c_pkt, *data);
    SET_BT_WIFI_CONTROL_DATA2(h2c_pkt, *(data + 1));
    ...
    SET_BT_WIFI_CONTROL_DATA5(h2c_pkt, *(data + 4));

Detected using the static analysis tool - Svace.

The Linux kernel CVE team has assigned CVE-2025-38159 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4 with commit 4136214f7c46839c15f0f177fe1d5052302c0205 and fixed in 5.15.186 with commit 1ee8ea6937d13b20f90ff35d71ccc03ba448182d
	Issue introduced in 5.4 with commit 4136214f7c46839c15f0f177fe1d5052302c0205 and fixed in 6.1.142 with commit 68a1037f0bac4de9a585aa9c879ef886109f3647
	Issue introduced in 5.4 with commit 4136214f7c46839c15f0f177fe1d5052302c0205 and fixed in 6.6.94 with commit 74e18211c2c89ab66c9546baa7408288db61aa0d
	Issue introduced in 5.4 with commit 4136214f7c46839c15f0f177fe1d5052302c0205 and fixed in 6.12.34 with commit c13255389499275bc5489a0b5b7940ccea3aef04
	Issue introduced in 5.4 with commit 4136214f7c46839c15f0f177fe1d5052302c0205 and fixed in 6.15.3 with commit 9febcc8bded8be0d7efd8237fcef599b6d93b788
	Issue introduced in 5.4 with commit 4136214f7c46839c15f0f177fe1d5052302c0205 and fixed in 6.16-rc1 with commit 4c2c372de2e108319236203cce6de44d70ae15cd

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38159
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/realtek/rtw88/coex.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/1ee8ea6937d13b20f90ff35d71ccc03ba448182d
	https://git.kernel.org/stable/c/68a1037f0bac4de9a585aa9c879ef886109f3647
	https://git.kernel.org/stable/c/74e18211c2c89ab66c9546baa7408288db61aa0d
	https://git.kernel.org/stable/c/c13255389499275bc5489a0b5b7940ccea3aef04
	https://git.kernel.org/stable/c/9febcc8bded8be0d7efd8237fcef599b6d93b788
	https://git.kernel.org/stable/c/4c2c372de2e108319236203cce6de44d70ae15cd
