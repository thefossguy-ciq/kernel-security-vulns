From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38676: iommu/amd: Avoid stack buffer overflow from kernel cmdline

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

iommu/amd: Avoid stack buffer overflow from kernel cmdline

While the kernel command line is considered trusted in most environments,
avoid writing 1 byte past the end of "acpiid" if the "str" argument is
maximum length.

The Linux kernel CVE team has assigned CVE-2025-38676 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.10.175 with commit f2a5ec7f7b28f9b9cd5fac232ff51019a7f7b9e9 and fixed in 5.10.241 with commit a732502bf3bbe859613b6d7b2b0313b11f0474ac
	Issue introduced in 5.15.103 with commit c513043e0afe6a8ba79d00af358655afabb576d2 and fixed in 5.15.190 with commit 0ad8509b468fa1058f4f400a1829f29e4ccc4de8
	Issue introduced in 6.1.16 with commit 2ae19ac3ea82a5b87a81c10adbb497c9e58bdd60 and fixed in 6.1.149 with commit 9ff52d3af0ef286535749e14e3fe9eceb39a8349
	Issue introduced in 6.3 with commit b6b26d86c61c441144c72f842f7469bb686e1211 and fixed in 6.6.103 with commit 8f80c633cba144f721d38d9380f23d23ab7db10e
	Issue introduced in 6.3 with commit b6b26d86c61c441144c72f842f7469bb686e1211 and fixed in 6.12.44 with commit 4bdb0f78bddbfa77d3ab458a21dd9cec495d317a
	Issue introduced in 6.3 with commit b6b26d86c61c441144c72f842f7469bb686e1211 and fixed in 6.16.4 with commit 736db11c86f03e717fc4bf771d05efdf10d23acb
	Issue introduced in 6.3 with commit b6b26d86c61c441144c72f842f7469bb686e1211 and fixed in 6.17-rc3 with commit 8503d0fcb1086a7cfe26df67ca4bd9bd9e99bdec
	Issue introduced in 5.4.237 with commit 5e97dc748d13fad582136ba0c8cec215c7aeeb17
	Issue introduced in 6.2.3 with commit 63cd11165e5e0ea2012254c764003eda1f9adb7d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38676
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/iommu/amd/init.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a732502bf3bbe859613b6d7b2b0313b11f0474ac
	https://git.kernel.org/stable/c/0ad8509b468fa1058f4f400a1829f29e4ccc4de8
	https://git.kernel.org/stable/c/9ff52d3af0ef286535749e14e3fe9eceb39a8349
	https://git.kernel.org/stable/c/8f80c633cba144f721d38d9380f23d23ab7db10e
	https://git.kernel.org/stable/c/4bdb0f78bddbfa77d3ab458a21dd9cec495d317a
	https://git.kernel.org/stable/c/736db11c86f03e717fc4bf771d05efdf10d23acb
	https://git.kernel.org/stable/c/8503d0fcb1086a7cfe26df67ca4bd9bd9e99bdec
