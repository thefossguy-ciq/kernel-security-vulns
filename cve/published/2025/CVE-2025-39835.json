{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nxfs: do not propagate ENODATA disk errors into xattr code\n\nENODATA (aka ENOATTR) has a very specific meaning in the xfs xattr code;\nnamely, that the requested attribute name could not be found.\n\nHowever, a medium error from disk may also return ENODATA. At best,\nthis medium error may escape to userspace as \"attribute not found\"\nwhen in fact it's an IO (disk) error.\n\nAt worst, we may oops in xfs_attr_leaf_get() when we do:\n\n\terror = xfs_attr_leaf_hasname(args, &bp);\n\tif (error == -ENOATTR)  {\n\t\txfs_trans_brelse(args->trans, bp);\n\t\treturn error;\n\t}\n\nbecause an ENODATA/ENOATTR error from disk leaves us with a null bp,\nand the xfs_trans_brelse will then null-deref it.\n\nAs discussed on the list, we really need to modify the lower level\nIO functions to trap all disk errors and ensure that we don't let\nunique errors like this leak up into higher xfs functions - many\nlike this should be remapped to EIO.\n\nHowever, this patch directly addresses a reported bug in the xattr\ncode, and should be safe to backport to stable kernels. A larger-scope\npatch to handle more unique errors at lower levels can follow later.\n\n(Note, prior to 07120f1abdff we did not oops, but we did return the\nwrong error code to userspace.)"
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/xfs/libxfs/xfs_attr_remote.c",
                  "fs/xfs/libxfs/xfs_da_btree.c"
               ],
               "versions": [
                  {
                     "version": "07120f1abdff80f3d1351f733661abe28d609535",
                     "lessThan": "157ddfb05961c68ab7d457a462822a698e4e4bf4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "07120f1abdff80f3d1351f733661abe28d609535",
                     "lessThan": "90bae69c2959c39912f0c2f07a9a7894f3fc49f5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "07120f1abdff80f3d1351f733661abe28d609535",
                     "lessThan": "e358d4b6225e4c1eb208686a05e360ef8df59e07",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "07120f1abdff80f3d1351f733661abe28d609535",
                     "lessThan": "d3cc7476b89fb45b7e00874f4f56f6b928467c60",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "07120f1abdff80f3d1351f733661abe28d609535",
                     "lessThan": "dcdf36f1b67884c722abce9b8946e34ffb9f67c8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "07120f1abdff80f3d1351f733661abe28d609535",
                     "lessThan": "39fc2742ca14f7fbc621ce9b43bcbd00248cb9a8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "07120f1abdff80f3d1351f733661abe28d609535",
                     "lessThan": "ae668cd567a6a7622bc813ee0bb61c42bed61ba7",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/xfs/libxfs/xfs_attr_remote.c",
                  "fs/xfs/libxfs/xfs_da_btree.c"
               ],
               "versions": [
                  {
                     "version": "5.9",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.9",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.242",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.191",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.150",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.104",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.45",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.16.5",
                     "lessThanOrEqual": "6.16.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.17",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.9",
                           "versionEndExcluding": "5.10.242"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.9",
                           "versionEndExcluding": "5.15.191"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.9",
                           "versionEndExcluding": "6.1.150"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.9",
                           "versionEndExcluding": "6.6.104"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.9",
                           "versionEndExcluding": "6.12.45"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.9",
                           "versionEndExcluding": "6.16.5"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.9",
                           "versionEndExcluding": "6.17"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/157ddfb05961c68ab7d457a462822a698e4e4bf4"
            },
            {
               "url": "https://git.kernel.org/stable/c/90bae69c2959c39912f0c2f07a9a7894f3fc49f5"
            },
            {
               "url": "https://git.kernel.org/stable/c/e358d4b6225e4c1eb208686a05e360ef8df59e07"
            },
            {
               "url": "https://git.kernel.org/stable/c/d3cc7476b89fb45b7e00874f4f56f6b928467c60"
            },
            {
               "url": "https://git.kernel.org/stable/c/dcdf36f1b67884c722abce9b8946e34ffb9f67c8"
            },
            {
               "url": "https://git.kernel.org/stable/c/39fc2742ca14f7fbc621ce9b43bcbd00248cb9a8"
            },
            {
               "url": "https://git.kernel.org/stable/c/ae668cd567a6a7622bc813ee0bb61c42bed61ba7"
            }
         ],
         "title": "xfs: do not propagate ENODATA disk errors into xattr code",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-39835",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
