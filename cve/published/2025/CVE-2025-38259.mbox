From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38259: ASoC: codecs: wcd9335: Fix missing free of regulator supplies
Message-Id: <2025070936-CVE-2025-38259-a05a@gregkh>
Content-Length: 2810
Lines: 60
X-Developer-Signature: v=1; a=openpgp-sha256; l=2871;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=RpyZXeJrHSGAIGhPeNZ1Wx4eS4UAI3IKJAhcTPgh7N0=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBl57nPmch7vOBtlOn0NawC38KtVE/JNJP7XzWHN82ll5
 Pdt6jnTEcvCIMjEICumyPJlG8/R/RWHFL0MbU/DzGFlAhnCwMUpABNRTmSYK7xMuqTQ6Pelr/4O
 mh+X7ndK5LcxYVhwRWWlqt3vZf3njmY92HKoLmNHM0cxAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ASoC: codecs: wcd9335: Fix missing free of regulator supplies

Driver gets and enables all regulator supplies in probe path
(wcd9335_parse_dt() and wcd9335_power_on_reset()), but does not cleanup
in final error paths and in unbind (missing remove() callback).  This
leads to leaked memory and unbalanced regulator enable count during
probe errors or unbind.

Fix this by converting entire code into devm_regulator_bulk_get_enable()
which also greatly simplifies the code.

The Linux kernel CVE team has assigned CVE-2025-38259 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.1 with commit 20aedafdf4926e7a957f8b302a18c8fb75c7e332 and fixed in 6.1.143 with commit edadaf4239c14dc8a19ea7f60b97d5524d93c29b
	Issue introduced in 5.1 with commit 20aedafdf4926e7a957f8b302a18c8fb75c7e332 and fixed in 6.6.96 with commit 9830ef1803a5bc50b4a984a06cf23142cd46229d
	Issue introduced in 5.1 with commit 20aedafdf4926e7a957f8b302a18c8fb75c7e332 and fixed in 6.12.36 with commit a8795f3cd289cd958f6396a1b43ba46fa8e22a2e
	Issue introduced in 5.1 with commit 20aedafdf4926e7a957f8b302a18c8fb75c7e332 and fixed in 6.15.5 with commit b86280aaa23c1c0f31bcaa600d35ddc45bc38b7a
	Issue introduced in 5.1 with commit 20aedafdf4926e7a957f8b302a18c8fb75c7e332 and fixed in 6.16-rc1 with commit 9079db287fc3e38e040b0edeb0a25770bb679c8e

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38259
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	sound/soc/codecs/wcd9335.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/edadaf4239c14dc8a19ea7f60b97d5524d93c29b
	https://git.kernel.org/stable/c/9830ef1803a5bc50b4a984a06cf23142cd46229d
	https://git.kernel.org/stable/c/a8795f3cd289cd958f6396a1b43ba46fa8e22a2e
	https://git.kernel.org/stable/c/b86280aaa23c1c0f31bcaa600d35ddc45bc38b7a
	https://git.kernel.org/stable/c/9079db287fc3e38e040b0edeb0a25770bb679c8e
