From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37927: iommu/amd: Fix potential buffer overflow in parse_ivrs_acpihid

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

iommu/amd: Fix potential buffer overflow in parse_ivrs_acpihid

There is a string parsing logic error which can lead to an overflow of hid
or uid buffers. Comparing ACPIID_LEN against a total string length doesn't
take into account the lengths of individual hid and uid buffers so the
check is insufficient in some cases. For example if the length of hid
string is 4 and the length of the uid string is 260, the length of str
will be equal to ACPIID_LEN + 1 but uid string will overflow uid buffer
which size is 256.

The same applies to the hid string with length 13 and uid string with
length 250.

Check the length of hid and uid strings separately to prevent
buffer overflow.

Found by Linux Verification Center (linuxtesting.org) with SVACE.

The Linux kernel CVE team has assigned CVE-2025-37927 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.7 with commit ca3bf5d47cec8b7614bcb2e9132c40081d6d81db and fixed in 5.15.182 with commit 466d9da267079a8d3b69fa72dfa3a732e1f6dbb5
	Issue introduced in 4.7 with commit ca3bf5d47cec8b7614bcb2e9132c40081d6d81db and fixed in 6.1.138 with commit c3f37faa71f5d26dd2144b3f2b14525ec8f5e41f
	Issue introduced in 4.7 with commit ca3bf5d47cec8b7614bcb2e9132c40081d6d81db and fixed in 6.6.90 with commit 13d67528e1ae4486e9ab24b70122fab104c73c29
	Issue introduced in 4.7 with commit ca3bf5d47cec8b7614bcb2e9132c40081d6d81db and fixed in 6.12.28 with commit 10d901a95f8e766e5aa0bb9a983fb41271f64718
	Issue introduced in 4.7 with commit ca3bf5d47cec8b7614bcb2e9132c40081d6d81db and fixed in 6.14.6 with commit c8bdfc0297965bb13fa439d36ca9c4f7c8447f0f
	Issue introduced in 4.7 with commit ca3bf5d47cec8b7614bcb2e9132c40081d6d81db and fixed in 6.15 with commit 8dee308e4c01dea48fc104d37f92d5b58c50b96c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37927
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/iommu/amd/init.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/466d9da267079a8d3b69fa72dfa3a732e1f6dbb5
	https://git.kernel.org/stable/c/c3f37faa71f5d26dd2144b3f2b14525ec8f5e41f
	https://git.kernel.org/stable/c/13d67528e1ae4486e9ab24b70122fab104c73c29
	https://git.kernel.org/stable/c/10d901a95f8e766e5aa0bb9a983fb41271f64718
	https://git.kernel.org/stable/c/c8bdfc0297965bb13fa439d36ca9c4f7c8447f0f
	https://git.kernel.org/stable/c/8dee308e4c01dea48fc104d37f92d5b58c50b96c
