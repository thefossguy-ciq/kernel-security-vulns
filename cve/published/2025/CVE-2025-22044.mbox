From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-22044: acpi: nfit: fix narrowing conversion in acpi_nfit_ctl

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

acpi: nfit: fix narrowing conversion in acpi_nfit_ctl

Syzkaller has reported a warning in to_nfit_bus_uuid(): "only secondary
bus families can be translated". This warning is emited if the argument
is equal to NVDIMM_BUS_FAMILY_NFIT == 0. Function acpi_nfit_ctl() first
verifies that a user-provided value call_pkg->nd_family of type u64 is
not equal to 0. Then the value is converted to int, and only after that
is compared to NVDIMM_BUS_FAMILY_MAX. This can lead to passing an invalid
argument to acpi_nfit_ctl(), if call_pkg->nd_family is non-zero, while
the lower 32 bits are zero.

Furthermore, it is best to return EINVAL immediately upon seeing the
invalid user input.  The WARNING is insufficient to prevent further
undefined behavior based on other invalid user input.

All checks of the input value should be applied to the original variable
call_pkg->nd_family.

[iweiny: update commit message]

The Linux kernel CVE team has assigned CVE-2025-22044 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.9 with commit 6450ddbd5d8e83ea9927c7f9076a21f829699e0f and fixed in 5.10.236 with commit 4b65cff06a004ac54f6ea8886060f0d07b1ca055
	Issue introduced in 5.9 with commit 6450ddbd5d8e83ea9927c7f9076a21f829699e0f and fixed in 5.15.180 with commit 92ba06aef65522483784dcbd6697629ddbd4c4f9
	Issue introduced in 5.9 with commit 6450ddbd5d8e83ea9927c7f9076a21f829699e0f and fixed in 6.1.134 with commit bae5b55e0f327102e78f6a66fb127275e9bc91b6
	Issue introduced in 5.9 with commit 6450ddbd5d8e83ea9927c7f9076a21f829699e0f and fixed in 6.6.87 with commit c90402d2a226ff7afbe1d0650bee8ecc15a91049
	Issue introduced in 5.9 with commit 6450ddbd5d8e83ea9927c7f9076a21f829699e0f and fixed in 6.12.23 with commit e71a57c5aaa389d4c3c82f920761262efdd18d38
	Issue introduced in 5.9 with commit 6450ddbd5d8e83ea9927c7f9076a21f829699e0f and fixed in 6.13.11 with commit 73851cfceb00cc77d7a0851bc10f2263394c3e87
	Issue introduced in 5.9 with commit 6450ddbd5d8e83ea9927c7f9076a21f829699e0f and fixed in 6.14.2 with commit 85f11291658ab907c4294319c8102450cc75bb96
	Issue introduced in 5.9 with commit 6450ddbd5d8e83ea9927c7f9076a21f829699e0f and fixed in 6.15 with commit 2ff0e408db36c21ed3fa5e3c1e0e687c82cf132f

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-22044
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/acpi/nfit/core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/4b65cff06a004ac54f6ea8886060f0d07b1ca055
	https://git.kernel.org/stable/c/92ba06aef65522483784dcbd6697629ddbd4c4f9
	https://git.kernel.org/stable/c/bae5b55e0f327102e78f6a66fb127275e9bc91b6
	https://git.kernel.org/stable/c/c90402d2a226ff7afbe1d0650bee8ecc15a91049
	https://git.kernel.org/stable/c/e71a57c5aaa389d4c3c82f920761262efdd18d38
	https://git.kernel.org/stable/c/73851cfceb00cc77d7a0851bc10f2263394c3e87
	https://git.kernel.org/stable/c/85f11291658ab907c4294319c8102450cc75bb96
	https://git.kernel.org/stable/c/2ff0e408db36c21ed3fa5e3c1e0e687c82cf132f
