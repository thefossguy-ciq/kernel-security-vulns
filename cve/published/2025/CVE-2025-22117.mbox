From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-22117: ice: fix using untrusted value of pkt_len in ice_vc_fdir_parse_raw()
Message-Id: <2025041626-CVE-2025-22117-2d76@gregkh>
Content-Length: 1920
Lines: 49
X-Developer-Signature: v=1; a=openpgp-sha256; l=1970;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=xNnrXM+ViZ2CYPov5+/TK8Yump+Ld///6G91nBFMjT8=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDOn/d53y/83Q8KudufvkeYblp0qjLgSHy6kvcsl52X9t9
 rcsSV+fjlgWBkEmBlkxRZYv23iO7q84pOhlaHsaZg4rE8gQBi5OAZiIhSrDbLboqzL9mcXTMt75
 nmaxu7fJ2esVN8OCw52GZrlN+z/+mOBjUfiv8t9TDbmZAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ice: fix using untrusted value of pkt_len in ice_vc_fdir_parse_raw()

Fix using the untrusted value of proto->raw.pkt_len in function
ice_vc_fdir_parse_raw() by verifying if it does not exceed the
VIRTCHNL_MAX_SIZE_RAW_PACKET value.

The Linux kernel CVE team has assigned CVE-2025-22117 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.12 with commit 99f419df8a5c5e1a58822203989f77712d01d410 and fixed in 6.14.2 with commit 362f704ba73a359db9cded567e891d9a8f081875
	Issue introduced in 6.12 with commit 99f419df8a5c5e1a58822203989f77712d01d410 and fixed in 6.15-rc1 with commit 1388dd564183a5a18ec4a966748037736b5653c5

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-22117
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/ice/ice_virtchnl_fdir.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/362f704ba73a359db9cded567e891d9a8f081875
	https://git.kernel.org/stable/c/1388dd564183a5a18ec4a966748037736b5653c5
