{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmaple_tree: fix MA_STATE_PREALLOC flag in mas_preallocate()\n\nTemporarily clear the preallocation flag when explicitly requesting\nallocations.  Pre-existing allocations are already counted against the\nrequest through mas_node_count_gfp(), but the allocations will not happen\nif the MA_STATE_PREALLOC flag is set.  This flag is meant to avoid\nre-allocating in bulk allocation mode, and to detect issues with\npreallocation calculations.\n\nThe MA_STATE_PREALLOC flag should also always be set on zero allocations\nso that detection of underflow allocations will print a WARN_ON() during\nconsumption.\n\nUser visible effect of this flaw is a WARN_ON() followed by a null pointer\ndereference when subsequent requests for larger number of nodes is\nignored, such as the vma merge retry in mmap_region() caused by drivers\naltering the vma flags (which happens in v6.6, at least)"
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "lib/maple_tree.c"
               ],
               "versions": [
                  {
                     "version": "54a611b605901c7d5d05b6b8f5d04a6ceb0962aa",
                     "lessThan": "d69cd64bd5af41c6fd409313504089970edaf02f",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "54a611b605901c7d5d05b6b8f5d04a6ceb0962aa",
                     "lessThan": "e63032e66bca1d06e600033f3369ba3db3af0870",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "54a611b605901c7d5d05b6b8f5d04a6ceb0962aa",
                     "lessThan": "cf95f8426f889949b738f51ffcd72884411f3a6a",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "54a611b605901c7d5d05b6b8f5d04a6ceb0962aa",
                     "lessThan": "9e32f4700867abbd5d19abfcf698dbd0d2ce36a4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "54a611b605901c7d5d05b6b8f5d04a6ceb0962aa",
                     "lessThan": "fba46a5d83ca8decb338722fb4899026d8d9ead2",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "lib/maple_tree.c"
               ],
               "versions": [
                  {
                     "version": "6.1",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.1",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.146",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.99",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.36",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.15.5",
                     "lessThanOrEqual": "6.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.16-rc4",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1",
                           "versionEndExcluding": "6.1.146"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1",
                           "versionEndExcluding": "6.6.99"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1",
                           "versionEndExcluding": "6.12.36"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1",
                           "versionEndExcluding": "6.15.5"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1",
                           "versionEndExcluding": "6.16-rc4"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/d69cd64bd5af41c6fd409313504089970edaf02f"
            },
            {
               "url": "https://git.kernel.org/stable/c/e63032e66bca1d06e600033f3369ba3db3af0870"
            },
            {
               "url": "https://git.kernel.org/stable/c/cf95f8426f889949b738f51ffcd72884411f3a6a"
            },
            {
               "url": "https://git.kernel.org/stable/c/9e32f4700867abbd5d19abfcf698dbd0d2ce36a4"
            },
            {
               "url": "https://git.kernel.org/stable/c/fba46a5d83ca8decb338722fb4899026d8d9ead2"
            }
         ],
         "title": "maple_tree: fix MA_STATE_PREALLOC flag in mas_preallocate()",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-38364",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
