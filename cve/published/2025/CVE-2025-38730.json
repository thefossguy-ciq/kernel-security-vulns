{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nio_uring/net: commit partial buffers on retry\n\nRing provided buffers are potentially only valid within the single\nexecution context in which they were acquired. io_uring deals with this\nand invalidates them on retry. But on the networking side, if\nMSG_WAITALL is set, or if the socket is of the streaming type and too\nlittle was processed, then it will hang on to the buffer rather than\nrecycle or commit it. This is problematic for two reasons:\n\n1) If someone unregisters the provided buffer ring before a later retry,\n   then the req->buf_list will no longer be valid.\n\n2) If multiple sockers are using the same buffer group, then multiple\n   receives can consume the same memory. This can cause data corruption\n   in the application, as either receive could land in the same\n   userspace buffer.\n\nFix this by disallowing partial retries from pinning a provided buffer\nacross multiple executions, if ring provided buffers are used."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "io_uring/net.c"
               ],
               "versions": [
                  {
                     "version": "c56e022c0a27142b7b59ae6bdf45f86bf4b298a1",
                     "lessThan": "3b53dc1c641f2884d4750fc25aaf6c36b90db606",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c56e022c0a27142b7b59ae6bdf45f86bf4b298a1",
                     "lessThan": "fe9da1812f8697a38f7e30991d568ec199e16059",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c56e022c0a27142b7b59ae6bdf45f86bf4b298a1",
                     "lessThan": "21a4ddb0f5e933f372808c10b9ac704505751bb1",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c56e022c0a27142b7b59ae6bdf45f86bf4b298a1",
                     "lessThan": "2eb7937b5fc7fcd90eab7bebb0181214b61b9283",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c56e022c0a27142b7b59ae6bdf45f86bf4b298a1",
                     "lessThan": "41b70df5b38bc80967d2e0ed55cc3c3896bba781",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "io_uring/net.c"
               ],
               "versions": [
                  {
                     "version": "6.4",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.4",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.103",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.44",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.15.11",
                     "lessThanOrEqual": "6.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.16.2",
                     "lessThanOrEqual": "6.16.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.17-rc2",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.4",
                           "versionEndExcluding": "6.6.103"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.4",
                           "versionEndExcluding": "6.12.44"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.4",
                           "versionEndExcluding": "6.15.11"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.4",
                           "versionEndExcluding": "6.16.2"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.4",
                           "versionEndExcluding": "6.17-rc2"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/3b53dc1c641f2884d4750fc25aaf6c36b90db606"
            },
            {
               "url": "https://git.kernel.org/stable/c/fe9da1812f8697a38f7e30991d568ec199e16059"
            },
            {
               "url": "https://git.kernel.org/stable/c/21a4ddb0f5e933f372808c10b9ac704505751bb1"
            },
            {
               "url": "https://git.kernel.org/stable/c/2eb7937b5fc7fcd90eab7bebb0181214b61b9283"
            },
            {
               "url": "https://git.kernel.org/stable/c/41b70df5b38bc80967d2e0ed55cc3c3896bba781"
            }
         ],
         "title": "io_uring/net: commit partial buffers on retry",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-38730",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
