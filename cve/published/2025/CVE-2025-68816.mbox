From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68816: net/mlx5: fw_tracer, Validate format string parameters
Message-Id: <2026011313-CVE-2025-68816-e773@gregkh>
Content-Length: 3324
Lines: 69
X-Developer-Signature: v=1; a=openpgp-sha256; l=3394;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=evVoYZpAOu8dNYbB+AgIul7A0dgeNg9Dyxz6rxoCoeI=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJlpKSd/372swNb8qzbvdZu25E+JTTdYLzG1ez3NdJZfd
 iDSzD2hI5aFQZCJQVZMkeXLNp6j+ysOKXoZ2p6GmcPKBDKEgYtTACZS4sowh8ssMWhm0S2zzliH
 yJATNc3ajx6qMsxP7PqvxBZSI1yme211eCfbOlv/V98A
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net/mlx5: fw_tracer, Validate format string parameters

Add validation for format string parameters in the firmware tracer to
prevent potential security vulnerabilities and crashes from malformed
format strings received from firmware.

The firmware tracer receives format strings from the device firmware and
uses them to format trace messages. Without proper validation, bad
firmware could provide format strings with invalid format specifiers
(e.g., %s, %p, %n) that could lead to crashes, or other undefined
behavior.

Add mlx5_tracer_validate_params() to validate that all format specifiers
in trace strings are limited to safe integer/hex formats (%x, %d, %i,
%u, %llx, %lx, etc.). Reject strings containing other format types that
could be used to access arbitrary memory or cause crashes.
Invalid format strings are added to the trace output for visibility with
"BAD_FORMAT: " prefix.

The Linux kernel CVE team has assigned CVE-2025-68816 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19 with commit 70dd6fdb8987b14f7b6105f6be0617299e459398 and fixed in 6.1.160 with commit 38ac688b52ef26a88f8bc4fe26d24fdd0ff91e5d
	Issue introduced in 4.19 with commit 70dd6fdb8987b14f7b6105f6be0617299e459398 and fixed in 6.6.120 with commit 8ac688c0e430dab19f6a9b70df94b1f635612c1a
	Issue introduced in 4.19 with commit 70dd6fdb8987b14f7b6105f6be0617299e459398 and fixed in 6.12.64 with commit 45bd283b1d69e2c97cddcb9956f0e0261fc4efd7
	Issue introduced in 4.19 with commit 70dd6fdb8987b14f7b6105f6be0617299e459398 and fixed in 6.18.3 with commit 8c35c2448086870509ede43947845be0833251f0
	Issue introduced in 4.19 with commit 70dd6fdb8987b14f7b6105f6be0617299e459398 and fixed in 6.19-rc2 with commit b35966042d20b14e2d83330049f77deec5229749

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68816
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
	drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/38ac688b52ef26a88f8bc4fe26d24fdd0ff91e5d
	https://git.kernel.org/stable/c/8ac688c0e430dab19f6a9b70df94b1f635612c1a
	https://git.kernel.org/stable/c/45bd283b1d69e2c97cddcb9956f0e0261fc4efd7
	https://git.kernel.org/stable/c/8c35c2448086870509ede43947845be0833251f0
	https://git.kernel.org/stable/c/b35966042d20b14e2d83330049f77deec5229749
