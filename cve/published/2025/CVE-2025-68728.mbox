From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68728: ntfs3: fix uninit memory after failed mi_read in mi_format_new

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ntfs3: fix uninit memory after failed mi_read in mi_format_new

Fix a KMSAN un-init bug found by syzkaller.

ntfs_get_bh() expects a buffer from sb_getblk(), that buffer may not be
uptodate. We do not bring the buffer uptodate before setting it as
uptodate. If the buffer were to not be uptodate, it could mean adding a
buffer with un-init data to the mi record. Attempting to load that record
will trigger KMSAN.

Avoid this by setting the buffer as uptodate, if itâ€™s not already, by
overwriting it.

The Linux kernel CVE team has assigned CVE-2025-68728 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.15 with commit 4342306f0f0d5ff4315a204d315c1b51b914fca5 and fixed in 5.15.198 with commit afb144bc8e920db43a23e996eb0a6f9bdea84341
	Issue introduced in 5.15 with commit 4342306f0f0d5ff4315a204d315c1b51b914fca5 and fixed in 6.1.160 with commit c70b3abfd530c7f574bc25a5f84707e6fdf0def8
	Issue introduced in 5.15 with commit 4342306f0f0d5ff4315a204d315c1b51b914fca5 and fixed in 6.6.120 with commit 8bf729b96303bb862d7c6dc05edcf51274ae04cf
	Issue introduced in 5.15 with commit 4342306f0f0d5ff4315a204d315c1b51b914fca5 and fixed in 6.12.63 with commit 7ce8f2028dfccb2161b905cf8ab85cdd9e93909c
	Issue introduced in 5.15 with commit 4342306f0f0d5ff4315a204d315c1b51b914fca5 and fixed in 6.17.13 with commit 46f2a881e5a7311d41551edb3915e4d4e8802341
	Issue introduced in 5.15 with commit 4342306f0f0d5ff4315a204d315c1b51b914fca5 and fixed in 6.18.2 with commit 81ffe9a265df3e41534726b852ab08792e3d374d
	Issue introduced in 5.15 with commit 4342306f0f0d5ff4315a204d315c1b51b914fca5 and fixed in 6.19-rc1 with commit 73e6b9dacf72a1e7a4265eacca46f8f33e0997d6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68728
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/ntfs3/fsntfs.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/afb144bc8e920db43a23e996eb0a6f9bdea84341
	https://git.kernel.org/stable/c/c70b3abfd530c7f574bc25a5f84707e6fdf0def8
	https://git.kernel.org/stable/c/8bf729b96303bb862d7c6dc05edcf51274ae04cf
	https://git.kernel.org/stable/c/7ce8f2028dfccb2161b905cf8ab85cdd9e93909c
	https://git.kernel.org/stable/c/46f2a881e5a7311d41551edb3915e4d4e8802341
	https://git.kernel.org/stable/c/81ffe9a265df3e41534726b852ab08792e3d374d
	https://git.kernel.org/stable/c/73e6b9dacf72a1e7a4265eacca46f8f33e0997d6
