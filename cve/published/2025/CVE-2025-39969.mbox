From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39969: i40e: fix validation of VF state in get resources

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

i40e: fix validation of VF state in get resources

VF state I40E_VF_STATE_ACTIVE is not the only state in which
VF is actually active so it should not be used to determine
if a VF is allowed to obtain resources.

Use I40E_VF_STATE_RESOURCES_LOADED that is set only in
i40e_vc_get_vf_resources_msg() and cleared during reset.

The Linux kernel CVE team has assigned CVE-2025-39969 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4.165 with commit 171527da84149c2c7aa6a60a64b09d24f3546298 and fixed in 5.4.300 with commit 185745d56ec958bf8aa773828213237dfcc32f5a
	Issue introduced in 5.10.85 with commit eb87117c27e729b0aeef4d72ed40d6a1761b0f68 and fixed in 5.10.245 with commit f47876788a23de296c42ef9d505b5c1630f0b4b8
	Issue introduced in 5.15.8 with commit 2132643b956f553f5abddc9bae20dae267b082e0 and fixed in 5.15.194 with commit 8e35c80f8570426fe0f0cc92b151ebd835975f22
	Issue introduced in 5.16 with commit 61125b8be85dfbc7e9c7fe1cc6c6d631ab603516 and fixed in 6.1.155 with commit 6c3981fd59ef11a75005ac9978f034da5a168b6a
	Issue introduced in 5.16 with commit 61125b8be85dfbc7e9c7fe1cc6c6d631ab603516 and fixed in 6.6.109 with commit e748f1ee493f88e38b77363a60499f979d42c58a
	Issue introduced in 5.16 with commit 61125b8be85dfbc7e9c7fe1cc6c6d631ab603516 and fixed in 6.12.50 with commit 6128bbc7adc25c87c2f64b5eb66a280b78ef7ab7
	Issue introduced in 5.16 with commit 61125b8be85dfbc7e9c7fe1cc6c6d631ab603516 and fixed in 6.16.10 with commit a991dc56d3e9a2c3db87d0c3f03c24f6595400f1
	Issue introduced in 5.16 with commit 61125b8be85dfbc7e9c7fe1cc6c6d631ab603516 and fixed in 6.17 with commit 877b7e6ffc23766448236e8732254534c518ba42

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39969
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/i40e/i40e_virtchnl_pf.c
	drivers/net/ethernet/intel/i40e/i40e_virtchnl_pf.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/185745d56ec958bf8aa773828213237dfcc32f5a
	https://git.kernel.org/stable/c/f47876788a23de296c42ef9d505b5c1630f0b4b8
	https://git.kernel.org/stable/c/8e35c80f8570426fe0f0cc92b151ebd835975f22
	https://git.kernel.org/stable/c/6c3981fd59ef11a75005ac9978f034da5a168b6a
	https://git.kernel.org/stable/c/e748f1ee493f88e38b77363a60499f979d42c58a
	https://git.kernel.org/stable/c/6128bbc7adc25c87c2f64b5eb66a280b78ef7ab7
	https://git.kernel.org/stable/c/a991dc56d3e9a2c3db87d0c3f03c24f6595400f1
	https://git.kernel.org/stable/c/877b7e6ffc23766448236e8732254534c518ba42
