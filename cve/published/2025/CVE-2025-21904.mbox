From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21904: caif_virtio: fix wrong pointer check in cfv_probe()
Message-Id: <2025040129-CVE-2025-21904-cd79@gregkh>
Content-Length: 3408
Lines: 65
X-Developer-Signature: v=1; a=openpgp-sha256; l=3474;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=X8LIaDNEiMkRQ3syWqMndoe/uPfbe6VJeZpqBolV46A=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDOlvODYe5YhSTt1RPsdA7rbvaZ/1nBM+GezmO/S8XGKdr
 ptWqeaNjlgWBkEmBlkxRZYv23iO7q84pOhlaHsaZg4rE8gQBi5OAZjI4hMMC2be7LrrJfbH7G9w
 ZMGzZsELT3xOFTMsWPInoZZlVeGkW8z365tbVm6Zoi55GAA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

caif_virtio: fix wrong pointer check in cfv_probe()

del_vqs() frees virtqueues, therefore cfv->vq_tx pointer should be checked
for NULL before calling it, not cfv->vdev. Also the current implementation
is redundant because the pointer cfv->vdev is dereferenced before it is
checked for NULL.

Fix this by checking cfv->vq_tx for NULL instead of cfv->vdev before
calling del_vqs().

The Linux kernel CVE team has assigned CVE-2025-21904 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.10 with commit 0d2e1a2926b1839a4b74519e660739b2566c9386 and fixed in 5.4.291 with commit 990fff6980d0c1693d60a812f58dbf93eab0473f
	Issue introduced in 3.10 with commit 0d2e1a2926b1839a4b74519e660739b2566c9386 and fixed in 5.10.235 with commit 7b5fe58959822e6cfa884327cabba6be3b01883d
	Issue introduced in 3.10 with commit 0d2e1a2926b1839a4b74519e660739b2566c9386 and fixed in 5.15.179 with commit 8e4e08ca4cc634b337bb74bc9a70758fdeda0bcb
	Issue introduced in 3.10 with commit 0d2e1a2926b1839a4b74519e660739b2566c9386 and fixed in 6.1.131 with commit 29e0cd296c87240278e2f7ea4cf3f496b60c03af
	Issue introduced in 3.10 with commit 0d2e1a2926b1839a4b74519e660739b2566c9386 and fixed in 6.6.83 with commit 90d302619ee7ce5ed0c69c29c290bdccfde66418
	Issue introduced in 3.10 with commit 0d2e1a2926b1839a4b74519e660739b2566c9386 and fixed in 6.12.19 with commit 56cddf71cce3b15b078e937fadab29962b6f6643
	Issue introduced in 3.10 with commit 0d2e1a2926b1839a4b74519e660739b2566c9386 and fixed in 6.13.7 with commit 597c27e5f04cb50e56cc9aeda75d3e42b6b89c3e
	Issue introduced in 3.10 with commit 0d2e1a2926b1839a4b74519e660739b2566c9386 and fixed in 6.14 with commit a466fd7e9fafd975949e5945e2f70c33a94b1a70

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21904
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/caif/caif_virtio.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/990fff6980d0c1693d60a812f58dbf93eab0473f
	https://git.kernel.org/stable/c/7b5fe58959822e6cfa884327cabba6be3b01883d
	https://git.kernel.org/stable/c/8e4e08ca4cc634b337bb74bc9a70758fdeda0bcb
	https://git.kernel.org/stable/c/29e0cd296c87240278e2f7ea4cf3f496b60c03af
	https://git.kernel.org/stable/c/90d302619ee7ce5ed0c69c29c290bdccfde66418
	https://git.kernel.org/stable/c/56cddf71cce3b15b078e937fadab29962b6f6643
	https://git.kernel.org/stable/c/597c27e5f04cb50e56cc9aeda75d3e42b6b89c3e
	https://git.kernel.org/stable/c/a466fd7e9fafd975949e5945e2f70c33a94b1a70
