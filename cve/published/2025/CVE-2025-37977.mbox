From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37977: scsi: ufs: exynos: Disable iocc if dma-coherent property isn't set
Message-Id: <2025052039-CVE-2025-37977-9862@gregkh>
Content-Length: 2229
Lines: 53
X-Developer-Signature: v=1; a=openpgp-sha256; l=2283;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=KFzY5Xx0MFfnQWvm1tuLalgKZCyiGAL1+N1Q8i0c6tQ=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBk6WzysXi8X7jV5W9i3wfX9v5l3dRLele+aGfJk4aEnX
 51fZYv3d8SyMAgyMciKKbJ82cZzdH/FIUUvQ9vTMHNYmUCGMHBxCsBE5vsyLDjqOefa192KE4qX
 BX2fE9t66PzuEBWGuaJHAj6Vff1mNCHk6/8S30WP2jcILwIA
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

scsi: ufs: exynos: Disable iocc if dma-coherent property isn't set

If dma-coherent property isn't set then descriptors are non-cacheable
and the iocc shareability bits should be disabled. Without this UFS can
end up in an incompatible configuration and suffer from random cache
related stability issues.

The Linux kernel CVE team has assigned CVE-2025-37977 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.16 with commit cc52e15397cc5dc773d3c6792b98352d3209f93f and fixed in 6.12.26 with commit 869749e48115ef944eeabec8e84138908471fa51
	Issue introduced in 5.16 with commit cc52e15397cc5dc773d3c6792b98352d3209f93f and fixed in 6.14.4 with commit f0c6728a6f2e269ebb234a9b5bb6c2c24aafeb51
	Issue introduced in 5.16 with commit cc52e15397cc5dc773d3c6792b98352d3209f93f and fixed in 6.15-rc3 with commit f92bb7436802f8eb7ee72dc911a33c8897fde366

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37977
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/ufs/host/ufs-exynos.c
	drivers/ufs/host/ufs-exynos.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/869749e48115ef944eeabec8e84138908471fa51
	https://git.kernel.org/stable/c/f0c6728a6f2e269ebb234a9b5bb6c2c24aafeb51
	https://git.kernel.org/stable/c/f92bb7436802f8eb7ee72dc911a33c8897fde366
