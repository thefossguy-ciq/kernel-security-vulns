From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39718: vsock/virtio: Validate length in packet header before skb_put()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

vsock/virtio: Validate length in packet header before skb_put()

When receiving a vsock packet in the guest, only the virtqueue buffer
size is validated prior to virtio_vsock_skb_rx_put(). Unfortunately,
virtio_vsock_skb_rx_put() uses the length from the packet header as the
length argument to skb_put(), potentially resulting in SKB overflow if
the host has gone wonky.

Validate the length as advertised by the packet header before calling
virtio_vsock_skb_rx_put().

The Linux kernel CVE team has assigned CVE-2025-39718 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.1.63 with commit baddcc2c71572968cdaeee1c4ab3dc0ad90fa765 and fixed in 6.1.149 with commit 969b06bd8b7560efb100a34227619e7d318fbe05
	Issue introduced in 6.3 with commit 71dc9ec9ac7d3eee785cdc986c3daeb821381e20 and fixed in 6.6.103 with commit ee438c492b2e0705d819ac0e25d04fae758d8f8f
	Issue introduced in 6.3 with commit 71dc9ec9ac7d3eee785cdc986c3daeb821381e20 and fixed in 6.12.44 with commit faf332a10372390ce65d0b803888f4b25a388335
	Issue introduced in 6.3 with commit 71dc9ec9ac7d3eee785cdc986c3daeb821381e20 and fixed in 6.16.4 with commit 676f03760ca1d69c2470cef36c44dc152494b47c
	Issue introduced in 6.3 with commit 71dc9ec9ac7d3eee785cdc986c3daeb821381e20 and fixed in 6.17-rc1 with commit 0dab92484474587b82e8e0455839eaf5ac7bf894

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39718
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/vmw_vsock/virtio_transport.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/969b06bd8b7560efb100a34227619e7d318fbe05
	https://git.kernel.org/stable/c/ee438c492b2e0705d819ac0e25d04fae758d8f8f
	https://git.kernel.org/stable/c/faf332a10372390ce65d0b803888f4b25a388335
	https://git.kernel.org/stable/c/676f03760ca1d69c2470cef36c44dc152494b47c
	https://git.kernel.org/stable/c/0dab92484474587b82e8e0455839eaf5ac7bf894
