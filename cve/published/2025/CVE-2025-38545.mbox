From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38545: net: ethernet: ti: am65-cpsw-nuss: Fix skb size by accounting for skb_shared_info
Message-Id: <2025081627-CVE-2025-38545-6fc3@gregkh>
Content-Length: 2295
Lines: 53
X-Developer-Signature: v=1; a=openpgp-sha256; l=2349;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=gpy4+4q9k2lpGQdVuRXzUXDOXrRRMO9yz5ALN/ON5F4=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBkLMj//P/h8V3JW5lTTbQtsu7u3XbIWU5ix9MCrdTLR3
 IelVr0z7IhlYRBkYpAVU2T5so3n6P6KQ4pehranYeawMoEMYeDiFICJHJVgmMV05n7+aUPdeSYv
 t8lOPNKdJpDaN4lhwbELTDuyExQW1O55+itwHvMqV84yDQA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: ethernet: ti: am65-cpsw-nuss: Fix skb size by accounting for skb_shared_info

While transitioning from netdev_alloc_ip_align() to build_skb(), memory
for the "skb_shared_info" member of an "skb" was not allocated. Fix this
by allocating "PAGE_SIZE" as the skb length, accounting for the packet
length, headroom and tailroom, thereby including the required memory space
for skb_shared_info.

The Linux kernel CVE team has assigned CVE-2025-38545 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.10 with commit 8acacc40f7337527ff84cd901ed2ef0a2b95b2b6 and fixed in 6.12.39 with commit fc2fffa2facac15ce711e95f98f954426e025bc5
	Issue introduced in 6.10 with commit 8acacc40f7337527ff84cd901ed2ef0a2b95b2b6 and fixed in 6.15.7 with commit 7d6ca0c8c0caf9a13cae2de763bb1f2a9ea7eabb
	Issue introduced in 6.10 with commit 8acacc40f7337527ff84cd901ed2ef0a2b95b2b6 and fixed in 6.16 with commit 02c4d6c26f1f662da8885b299c224ca6628ad232

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38545
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/ti/am65-cpsw-nuss.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/fc2fffa2facac15ce711e95f98f954426e025bc5
	https://git.kernel.org/stable/c/7d6ca0c8c0caf9a13cae2de763bb1f2a9ea7eabb
	https://git.kernel.org/stable/c/02c4d6c26f1f662da8885b299c224ca6628ad232
