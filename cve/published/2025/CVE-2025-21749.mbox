From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21749: net: rose: lock the socket in rose_bind()
Message-Id: <2025022601-CVE-2025-21749-cd11@gregkh>
Content-Length: 2550
Lines: 56
X-Developer-Signature: v=1; a=openpgp-sha256; l=2607;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=QBIbmW20WP997UADAEfczM34zFs/+Z8adQ6R60ONsnw=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDOn7T27trPs/Z7X2i3+H4l9bhkxOvZKx059Nn/VmT6S1y
 hurrzErO2JZGASZGGTFFFm+bOM5ur/ikKKXoe1pmDmsTCBDGLg4BWAidQkM8wvOzTbY/s27S3r7
 WbYd2VdlfOuflzEsOHfwyllJo9+Lbsy9dzB9293+TIEtVwA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: rose: lock the socket in rose_bind()

syzbot reported a soft lockup in rose_loopback_timer(),
with a repro calling bind() from multiple threads.

rose_bind() must lock the socket to avoid this issue.

The Linux kernel CVE team has assigned CVE-2025-21749 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.1.129 with commit 667f61b3498df751c8b3f0be1637e7226cbe3ed0
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.6.78 with commit e0384efd45f615603e6869205b72040c209e69cc
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.12.14 with commit 970cd2ed26cdab2b0f15b6d90d7eaa36538244a5
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.13.3 with commit 4c04b0ab3a647e76d0e752b013de8e404abafc63
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 6.14-rc2 with commit a1300691aed9ee852b0a9192e29e2bdc2411a7e6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21749
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/rose/af_rose.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/667f61b3498df751c8b3f0be1637e7226cbe3ed0
	https://git.kernel.org/stable/c/e0384efd45f615603e6869205b72040c209e69cc
	https://git.kernel.org/stable/c/970cd2ed26cdab2b0f15b6d90d7eaa36538244a5
	https://git.kernel.org/stable/c/4c04b0ab3a647e76d0e752b013de8e404abafc63
	https://git.kernel.org/stable/c/a1300691aed9ee852b0a9192e29e2bdc2411a7e6
