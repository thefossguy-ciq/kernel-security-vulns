From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68747: drm/panthor: Fix UAF on kernel BO VA nodes

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/panthor: Fix UAF on kernel BO VA nodes

If the MMU is down, panthor_vm_unmap_range() might return an error.
We expect the page table to be updated still, and if the MMU is blocked,
the rest of the GPU should be blocked too, so no risk of accessing
physical memory returned to the system (which the current code doesn't
cover for anyway).

Proceed with the rest of the cleanup instead of bailing out and leaving
the va_node inserted in the drm_mm, which leads to UAF when other
adjacent nodes are removed from the drm_mm tree.

The Linux kernel CVE team has assigned CVE-2025-68747 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.10 with commit 8a1cc07578bf42d85f008316873d710ff684dd29 and fixed in 6.12.63 with commit 5a0060ddfc1fcfdb0f7b4fa1b7b3b0c436151391
	Issue introduced in 6.10 with commit 8a1cc07578bf42d85f008316873d710ff684dd29 and fixed in 6.17.13 with commit 1123eadb843588b361c96f53a771202b7953154f
	Issue introduced in 6.10 with commit 8a1cc07578bf42d85f008316873d710ff684dd29 and fixed in 6.18.2 with commit 0612704b6f6ddf2ae223019c52148c5ac76cf70e
	Issue introduced in 6.10 with commit 8a1cc07578bf42d85f008316873d710ff684dd29 and fixed in 6.19 with commit 98dd5143447af0ee33551776d8b2560c35d0bc4a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68747
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/panthor/panthor_gem.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5a0060ddfc1fcfdb0f7b4fa1b7b3b0c436151391
	https://git.kernel.org/stable/c/1123eadb843588b361c96f53a771202b7953154f
	https://git.kernel.org/stable/c/0612704b6f6ddf2ae223019c52148c5ac76cf70e
	https://git.kernel.org/stable/c/98dd5143447af0ee33551776d8b2560c35d0bc4a
