From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37829: cpufreq: scpi: Fix null-ptr-deref in scpi_cpufreq_get_rate()
Message-Id: <2025050823-CVE-2025-37829-99f4@gregkh>
Content-Length: 3290
Lines: 61
X-Developer-Signature: v=1; a=openpgp-sha256; l=3352;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=KiQmORvaFuvsU6pvBhv9bo1ubWTLJ3wNor9uh0MRbdU=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBkygbMfZ3G0bauNPvvGsfPpymefNO4y6DssV9o7pfJm9
 nLtnUe8OmJZGASZGGTFFFm+bOM5ur/ikKKXoe1pmDmsTCBDGLg4BWAi8ssY5hcH581cpJjKnXvA
 ojFs7YeF+Sd+5DPM4VPamNptfT47ILMvNvIPx6H/Bmv2AgA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

cpufreq: scpi: Fix null-ptr-deref in scpi_cpufreq_get_rate()

cpufreq_cpu_get_raw() can return NULL when the target CPU is not present
in the policy->cpus mask. scpi_cpufreq_get_rate() does not check for
this case, which results in a NULL pointer dereference.

The Linux kernel CVE team has assigned CVE-2025-37829 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.16 with commit 343a8d17fa8d6dd97f408e8fedbcef12073f3774 and fixed in 5.4.293 with commit ad4796f2da495b2cbbd0fccccbcbf63f2aeee613
	Issue introduced in 4.16 with commit 343a8d17fa8d6dd97f408e8fedbcef12073f3774 and fixed in 5.10.237 with commit fdf035d9c5436536ffcfea0ac6adeb5dda3c3a23
	Issue introduced in 4.16 with commit 343a8d17fa8d6dd97f408e8fedbcef12073f3774 and fixed in 5.15.181 with commit 8fbaa76690f67a7cbad315f89d607b46e3e06ede
	Issue introduced in 4.16 with commit 343a8d17fa8d6dd97f408e8fedbcef12073f3774 and fixed in 6.1.136 with commit da8ee91e532486055ecf88478d38c2f3dc234182
	Issue introduced in 4.16 with commit 343a8d17fa8d6dd97f408e8fedbcef12073f3774 and fixed in 6.6.89 with commit 19e0eaa62e8831f2bc0285fef3bf8faaa7f3e09b
	Issue introduced in 4.16 with commit 343a8d17fa8d6dd97f408e8fedbcef12073f3774 and fixed in 6.12.26 with commit 28fbd7b13b4d3074b16db913aedc9d8d37ab41e7
	Issue introduced in 4.16 with commit 343a8d17fa8d6dd97f408e8fedbcef12073f3774 and fixed in 6.14.5 with commit 124bddf123311cd1f18bffd63a5d974468d59c67
	Issue introduced in 4.16 with commit 343a8d17fa8d6dd97f408e8fedbcef12073f3774 and fixed in 6.15-rc4 with commit 73b24dc731731edf762f9454552cb3a5b7224949

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37829
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/cpufreq/scpi-cpufreq.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ad4796f2da495b2cbbd0fccccbcbf63f2aeee613
	https://git.kernel.org/stable/c/fdf035d9c5436536ffcfea0ac6adeb5dda3c3a23
	https://git.kernel.org/stable/c/8fbaa76690f67a7cbad315f89d607b46e3e06ede
	https://git.kernel.org/stable/c/da8ee91e532486055ecf88478d38c2f3dc234182
	https://git.kernel.org/stable/c/19e0eaa62e8831f2bc0285fef3bf8faaa7f3e09b
	https://git.kernel.org/stable/c/28fbd7b13b4d3074b16db913aedc9d8d37ab41e7
	https://git.kernel.org/stable/c/124bddf123311cd1f18bffd63a5d974468d59c67
	https://git.kernel.org/stable/c/73b24dc731731edf762f9454552cb3a5b7224949
