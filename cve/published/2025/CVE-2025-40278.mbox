From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40278: net: sched: act_ife: initialize struct tc_ife to fix KMSAN kernel-infoleak

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: sched: act_ife: initialize struct tc_ife to fix KMSAN kernel-infoleak

Fix a KMSAN kernel-infoleak detected  by the syzbot .

[net?] KMSAN: kernel-infoleak in __skb_datagram_iter

In tcf_ife_dump(), the variable 'opt' was partially initialized using a
designatied initializer. While the padding bytes are reamined
uninitialized. nla_put() copies the entire structure into a
netlink message, these uninitialized bytes leaked to userspace.

Initialize the structure with memset before assigning its fields
to ensure all members and padding are cleared prior to beign copied.

This change silences the KMSAN report and prevents potential information
leaks from the kernel memory.

This fix has been tested and validated by syzbot. This patch closes the
bug reported at the following syzkaller link and ensures no infoleak.

The Linux kernel CVE team has assigned CVE-2025-40278 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.6 with commit ef6980b6becb1afd9d82a4f043749a10ae81bf14 and fixed in 5.4.302 with commit 918e063304f945fb93be9bb70cacea07d0b730ea
	Issue introduced in 4.6 with commit ef6980b6becb1afd9d82a4f043749a10ae81bf14 and fixed in 5.10.247 with commit 5e3644ef147bf7140259dfa4cace680c9b26fe8b
	Issue introduced in 4.6 with commit ef6980b6becb1afd9d82a4f043749a10ae81bf14 and fixed in 5.15.197 with commit 37f0680887c5aeba9a433fe04b35169010568bb1
	Issue introduced in 4.6 with commit ef6980b6becb1afd9d82a4f043749a10ae81bf14 and fixed in 6.1.159 with commit 2191662058443e0bcc28d11694293d8339af6dde
	Issue introduced in 4.6 with commit ef6980b6becb1afd9d82a4f043749a10ae81bf14 and fixed in 6.6.117 with commit a676a296af65d33725bdf7396803180957dbd92e
	Issue introduced in 4.6 with commit ef6980b6becb1afd9d82a4f043749a10ae81bf14 and fixed in 6.12.59 with commit d1dbbbe839647486c9b893e5011fe84a052962df
	Issue introduced in 4.6 with commit ef6980b6becb1afd9d82a4f043749a10ae81bf14 and fixed in 6.17.9 with commit c8f51dad94cbb88054e2aacc272b3ce1ed11fb1e
	Issue introduced in 4.6 with commit ef6980b6becb1afd9d82a4f043749a10ae81bf14 and fixed in 6.18 with commit ce50039be49eea9b4cd8873ca6eccded1b4a130a

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40278
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/sched/act_ife.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/918e063304f945fb93be9bb70cacea07d0b730ea
	https://git.kernel.org/stable/c/5e3644ef147bf7140259dfa4cace680c9b26fe8b
	https://git.kernel.org/stable/c/37f0680887c5aeba9a433fe04b35169010568bb1
	https://git.kernel.org/stable/c/2191662058443e0bcc28d11694293d8339af6dde
	https://git.kernel.org/stable/c/a676a296af65d33725bdf7396803180957dbd92e
	https://git.kernel.org/stable/c/d1dbbbe839647486c9b893e5011fe84a052962df
	https://git.kernel.org/stable/c/c8f51dad94cbb88054e2aacc272b3ce1ed11fb1e
	https://git.kernel.org/stable/c/ce50039be49eea9b4cd8873ca6eccded1b4a130a
