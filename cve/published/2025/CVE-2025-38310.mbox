From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-38310: seg6: Fix validation of nexthop addresses
Message-Id: <2025071014-CVE-2025-38310-6184@gregkh>
Content-Length: 2926
Lines: 61
X-Developer-Signature: v=1; a=openpgp-sha256; l=2988;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=XP9uCt0kEYJiqz0PqAqEFe5nA4P2zZAwej2ZnyQ29hE=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBn5edd3svtMX7lL/1Xji0r3ndOtxGJYV3WXcPnqmKgx/
 bAwmSHYEcvCIMjEICumyPJlG8/R/RWHFL0MbU/DzGFlAhnCwMUpABNRimdYcOFVFdPpta67lrFd
 23Pd1c2G+8klaYb58RdT7+eYWoqKp92eYPXxsVVKy3MdAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

seg6: Fix validation of nexthop addresses

The kernel currently validates that the length of the provided nexthop
address does not exceed the specified length. This can lead to the
kernel reading uninitialized memory if user space provided a shorter
length than the specified one.

Fix by validating that the provided length exactly matches the specified
one.

The Linux kernel CVE team has assigned CVE-2025-38310 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.14 with commit d1df6fd8a1d22d37cffa0075ab8ad423ce656777 and fixed in 5.15.186 with commit 668923c474608dd9ebce0fbcc41bd8a27aa73dd6
	Issue introduced in 4.14 with commit d1df6fd8a1d22d37cffa0075ab8ad423ce656777 and fixed in 6.1.142 with commit cef33a86bcb04ecf4dc10c56f6c42ee9d1c54bac
	Issue introduced in 4.14 with commit d1df6fd8a1d22d37cffa0075ab8ad423ce656777 and fixed in 6.6.94 with commit d2507aeea45b3c5aa24d5daae0cf3db76895c0b7
	Issue introduced in 4.14 with commit d1df6fd8a1d22d37cffa0075ab8ad423ce656777 and fixed in 6.12.34 with commit d5d9fd13bc19a3f9f2a951c5b6e934d84205789e
	Issue introduced in 4.14 with commit d1df6fd8a1d22d37cffa0075ab8ad423ce656777 and fixed in 6.15.3 with commit cd4cd09810211fa23609c5c1018352e9e1cd8e5a
	Issue introduced in 4.14 with commit d1df6fd8a1d22d37cffa0075ab8ad423ce656777 and fixed in 6.16-rc1 with commit 7632fedb266d93ed0ed9f487133e6c6314a9b2d1

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-38310
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/ipv6/seg6_local.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/668923c474608dd9ebce0fbcc41bd8a27aa73dd6
	https://git.kernel.org/stable/c/cef33a86bcb04ecf4dc10c56f6c42ee9d1c54bac
	https://git.kernel.org/stable/c/d2507aeea45b3c5aa24d5daae0cf3db76895c0b7
	https://git.kernel.org/stable/c/d5d9fd13bc19a3f9f2a951c5b6e934d84205789e
	https://git.kernel.org/stable/c/cd4cd09810211fa23609c5c1018352e9e1cd8e5a
	https://git.kernel.org/stable/c/7632fedb266d93ed0ed9f487133e6c6314a9b2d1
