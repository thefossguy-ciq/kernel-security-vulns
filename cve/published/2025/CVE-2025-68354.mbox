From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68354: regulator: core: Protect regulator_supply_alias_list with regulator_list_mutex
Message-Id: <2025122455-CVE-2025-68354-d175@gregkh>
Content-Length: 2736
Lines: 61
X-Developer-Signature: v=1; a=openpgp-sha256; l=2798;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=oSwIEidq1LvrAvFCoSNujSooY1P9tgpOnMz09MOm/hE=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJneB8+739gwc93h9X9Kb2epCS7QN2Ga3Z6kd7hT2+Dxu
 9W7Twvs7YhlYRBkYpAVU2T5so3n6P6KQ4pehranYeawMoEMYeDiFICJeP9iWHAxXN/seuiStRPj
 m9wXar2LMl7MFcewYMmzhjIxFk6XoL1zlqQ/2WP04/82awA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

regulator: core: Protect regulator_supply_alias_list with regulator_list_mutex

regulator_supply_alias_list was accessed without any locking in
regulator_supply_alias(), regulator_register_supply_alias(), and
regulator_unregister_supply_alias(). Concurrent registration,
unregistration and lookups can race, leading to:

1 use-after-free if an alias entry is removed while being read,
2 duplicate entries when two threads register the same alias,
3 inconsistent alias mappings observed by consumers.

Protect all traversals, insertions and deletions on
regulator_supply_alias_list with the existing regulator_list_mutex.

The Linux kernel CVE team has assigned CVE-2025-68354 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.12.63 with commit a9864d42ebcdd394ebb864643b961b36e7b515be
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.17.13 with commit 431a1d44ad4866362cc28fc1cc4ca93d84989239
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.18.2 with commit 64099b5c0aeb70bc7cd5556eb7f59c5b4a5010bf
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.19-rc1 with commit 0cc15a10c3b4ab14cd71b779fd5c9ca0cb2bc30d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68354
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/regulator/core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a9864d42ebcdd394ebb864643b961b36e7b515be
	https://git.kernel.org/stable/c/431a1d44ad4866362cc28fc1cc4ca93d84989239
	https://git.kernel.org/stable/c/64099b5c0aeb70bc7cd5556eb7f59c5b4a5010bf
	https://git.kernel.org/stable/c/0cc15a10c3b4ab14cd71b779fd5c9ca0cb2bc30d
