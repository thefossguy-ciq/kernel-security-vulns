From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68354: regulator: core: Protect regulator_supply_alias_list with regulator_list_mutex

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

regulator: core: Protect regulator_supply_alias_list with regulator_list_mutex

regulator_supply_alias_list was accessed without any locking in
regulator_supply_alias(), regulator_register_supply_alias(), and
regulator_unregister_supply_alias(). Concurrent registration,
unregistration and lookups can race, leading to:

1 use-after-free if an alias entry is removed while being read,
2 duplicate entries when two threads register the same alias,
3 inconsistent alias mappings observed by consumers.

Protect all traversals, insertions and deletions on
regulator_supply_alias_list with the existing regulator_list_mutex.

The Linux kernel CVE team has assigned CVE-2025-68354 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 5.10.248 with commit e1587064137028e7edcca14fb766b68d27bec94b
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 5.15.198 with commit 9d041a7ba13f21adfac052eb3fda1df62f2166c1
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.1.160 with commit a63fbc07d1b34a9821ea3b31ff4e6456f9d0aa61
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.6.120 with commit 09811a83b214cc15521e0d818e43ae9043e9a28d
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.12.63 with commit a9864d42ebcdd394ebb864643b961b36e7b515be
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.17.13 with commit 431a1d44ad4866362cc28fc1cc4ca93d84989239
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.18.2 with commit 64099b5c0aeb70bc7cd5556eb7f59c5b4a5010bf
	Issue introduced in 3.13 with commit a06ccd9c3785fa5550917ae036944f4e080b5749 and fixed in 6.19-rc1 with commit 0cc15a10c3b4ab14cd71b779fd5c9ca0cb2bc30d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68354
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/regulator/core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/e1587064137028e7edcca14fb766b68d27bec94b
	https://git.kernel.org/stable/c/9d041a7ba13f21adfac052eb3fda1df62f2166c1
	https://git.kernel.org/stable/c/a63fbc07d1b34a9821ea3b31ff4e6456f9d0aa61
	https://git.kernel.org/stable/c/09811a83b214cc15521e0d818e43ae9043e9a28d
	https://git.kernel.org/stable/c/a9864d42ebcdd394ebb864643b961b36e7b515be
	https://git.kernel.org/stable/c/431a1d44ad4866362cc28fc1cc4ca93d84989239
	https://git.kernel.org/stable/c/64099b5c0aeb70bc7cd5556eb7f59c5b4a5010bf
	https://git.kernel.org/stable/c/0cc15a10c3b4ab14cd71b779fd5c9ca0cb2bc30d
