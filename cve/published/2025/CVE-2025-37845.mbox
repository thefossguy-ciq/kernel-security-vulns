From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37845: tracing: fprobe events: Fix possible UAF on modules

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

tracing: fprobe events: Fix possible UAF on modules

Commit ac91052f0ae5 ("tracing: tprobe-events: Fix leakage of module
refcount") moved try_module_get() from __find_tracepoint_module_cb()
to find_tracepoint() caller, but that introduced a possible UAF
because the module can be unloaded before try_module_get(). In this
case, the module object should be freed too. Thus, try_module_get()
does not only fail but may access to the freed object.

To avoid that, try_module_get() in __find_tracepoint_module_cb()
again.

The Linux kernel CVE team has assigned CVE-2025-37845 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.12.21 with commit 71c9cf87776eaa556fc0a0a060df94200e1f521c and fixed in 6.12.24 with commit 868df4eb784c3ccc7e4340a9ea993cbbedca167e
	Issue introduced in 6.13.9 with commit 9db2b8cf4ea07b579db588e0353d5680f5d1f071 and fixed in 6.13.12 with commit a27d2de2472b1cc7d582ab405d1d5832a80481de
	Issue introduced in 6.14 with commit ac91052f0ae5be9e46211ba92cc31c0e3b0a933a and fixed in 6.14.3 with commit 626f01f4d26e8cf92e69c1df53036153c8e98a20
	Issue introduced in 6.14 with commit ac91052f0ae5be9e46211ba92cc31c0e3b0a933a and fixed in 6.15 with commit dd941507a9486252d6fcf11814387666792020f3

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37845
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	kernel/trace/trace_fprobe.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/868df4eb784c3ccc7e4340a9ea993cbbedca167e
	https://git.kernel.org/stable/c/a27d2de2472b1cc7d582ab405d1d5832a80481de
	https://git.kernel.org/stable/c/626f01f4d26e8cf92e69c1df53036153c8e98a20
	https://git.kernel.org/stable/c/dd941507a9486252d6fcf11814387666792020f3
