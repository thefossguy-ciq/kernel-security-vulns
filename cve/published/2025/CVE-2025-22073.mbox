From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-22073: spufs: fix a leak on spufs_new_file() failure

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

spufs: fix a leak on spufs_new_file() failure

It's called from spufs_fill_dir(), and caller of that will do
spufs_rmdir() in case of failure.  That does remove everything
we'd managed to create, but... the problem dentry is still
negative.  IOW, it needs to be explicitly dropped.

The Linux kernel CVE team has assigned CVE-2025-22073 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 5.4.292 with commit b1eef06d10c1a9848e3a762919bbbe315a0a7cb4
	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 5.10.236 with commit 132925bd6772d7614340fb755ac5415462ac8edd
	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 5.15.180 with commit 53b189651c33b5f1fb3b755e6a37a8206978514e
	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 6.1.134 with commit 96de7fbdc2dcadeebc17c3cb89e7cdab487bfce0
	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 6.6.87 with commit 90d1b276d1b1379d20ad27d1f6349ba9f44a2e00
	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 6.12.23 with commit 35f789ccebd69f6f9a1e0a9b85435003b2450065
	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 6.13.11 with commit d791985ceeb081155b4e96d314ca54c7605dcbe0
	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 6.14.2 with commit 0bd56e4e72c354b65c0a7e5ac1c09eca81949d5b
	Issue introduced in 2.6.16 with commit 3f51dd91c80746a5cf76f8c4a77bfc88aa82bb9e and fixed in 6.15-rc1 with commit d1ca8698ca1332625d83ea0d753747be66f9906d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-22073
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/powerpc/platforms/cell/spufs/inode.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/b1eef06d10c1a9848e3a762919bbbe315a0a7cb4
	https://git.kernel.org/stable/c/132925bd6772d7614340fb755ac5415462ac8edd
	https://git.kernel.org/stable/c/53b189651c33b5f1fb3b755e6a37a8206978514e
	https://git.kernel.org/stable/c/96de7fbdc2dcadeebc17c3cb89e7cdab487bfce0
	https://git.kernel.org/stable/c/90d1b276d1b1379d20ad27d1f6349ba9f44a2e00
	https://git.kernel.org/stable/c/35f789ccebd69f6f9a1e0a9b85435003b2450065
	https://git.kernel.org/stable/c/d791985ceeb081155b4e96d314ca54c7605dcbe0
	https://git.kernel.org/stable/c/0bd56e4e72c354b65c0a7e5ac1c09eca81949d5b
	https://git.kernel.org/stable/c/d1ca8698ca1332625d83ea0d753747be66f9906d
