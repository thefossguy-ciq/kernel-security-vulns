From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39760: usb: core: config: Prevent OOB read in SS endpoint companion parsing
Message-Id: <2025091145-CVE-2025-39760-2d5f@gregkh>
Content-Length: 2667
Lines: 63
X-Developer-Signature: v=1; a=openpgp-sha256; l=2731;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=j0/pLJNUp+Xvtoh8m1R0AkR7DTEw8KBbTcL3bEpDZms=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBmH/sWqLbx4xV3BKyZT5Yfih88n9D9VfpKotmf9zCB4r
 ZZ5S5VURywLgyATg6yYIsuXbTxH91ccUvQytD0NM4eVCWQIAxenAExkdR/DPLszCibmc26o21hf
 WTJzVyzP1Gu3NRnmCiRutVA2kONr6WrZHNRZx65h728KAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

usb: core: config: Prevent OOB read in SS endpoint companion parsing

usb_parse_ss_endpoint_companion() checks descriptor type before length,
enabling a potentially odd read outside of the buffer size.

Fix this up by checking the size first before looking at any of the
fields in the descriptor.

The Linux kernel CVE team has assigned CVE-2025-39760 to this issue.


Affected and fixed versions
===========================

	Fixed in 5.10.241 with commit 5c3097ede7835d3caf6543eb70ff689af4550cd2
	Fixed in 5.15.190 with commit 058ad2b722812708fe90567875704ae36563e33b
	Fixed in 6.1.149 with commit b10e0f868067c6f25bbfabdcf3e1e6432c24ca55
	Fixed in 6.6.103 with commit 5badd56c711e2c8371d1670f9bd486697575423c
	Fixed in 6.12.43 with commit 9512510cee7d1becdb0e9413fdd3ab783e4e30ee
	Fixed in 6.15.11 with commit 4fe6f472f0beef4281e6f03bc38a910a33be663f
	Fixed in 6.16.2 with commit 9843bcb187cb933861f7805022e6873905f669e4
	Fixed in 6.17-rc1 with commit cf16f408364efd8a68f39011a3b073c83a03612d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39760
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/usb/core/config.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5c3097ede7835d3caf6543eb70ff689af4550cd2
	https://git.kernel.org/stable/c/058ad2b722812708fe90567875704ae36563e33b
	https://git.kernel.org/stable/c/b10e0f868067c6f25bbfabdcf3e1e6432c24ca55
	https://git.kernel.org/stable/c/5badd56c711e2c8371d1670f9bd486697575423c
	https://git.kernel.org/stable/c/9512510cee7d1becdb0e9413fdd3ab783e4e30ee
	https://git.kernel.org/stable/c/4fe6f472f0beef4281e6f03bc38a910a33be663f
	https://git.kernel.org/stable/c/9843bcb187cb933861f7805022e6873905f669e4
	https://git.kernel.org/stable/c/cf16f408364efd8a68f39011a3b073c83a03612d
