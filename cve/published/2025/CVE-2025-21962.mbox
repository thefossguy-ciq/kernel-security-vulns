From bippy-7c5fe7eed585 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-21962: cifs: Fix integer overflow while processing closetimeo mount option
Message-Id: <2025040145-CVE-2025-21962-9f86@gregkh>
Content-Length: 2756
Lines: 58
X-Developer-Signature: v=1; a=openpgp-sha256; l=2815;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=3JTvF3qqJfuOOfgA2sYxbISWdAdh3Asbx+oXpW6qbfw=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDOlvuDRzbnx753fwz8kV2/I/vouNzur+7CNnn3xf/HrKP
 I6VE1j2dcSyMAgyMciKKbJ82cZzdH/FIUUvQ9vTMHNYmUCGMHBxCsBEtM0ZFkxarhtwOna3qIY2
 yyFv8Zsrjq2oLWKY76udfe1NuHBqFKu26MrZ2fWn3y5qAwA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

cifs: Fix integer overflow while processing closetimeo mount option

User-provided mount parameter closetimeo of type u32 is intended to have
an upper limit, but before it is validated, the value is converted from
seconds to jiffies which can lead to an integer overflow.

Found by Linux Verification Center (linuxtesting.org) with SVACE.

The Linux kernel CVE team has assigned CVE-2025-21962 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.0 with commit 5efdd9122eff772eae2feae9f0fc0ec02d4846a3 and fixed in 6.1.132 with commit 9968fcf02cf6b0f78fbacf3f63e782162603855a
	Issue introduced in 6.0 with commit 5efdd9122eff772eae2feae9f0fc0ec02d4846a3 and fixed in 6.6.84 with commit 6c13fcb7cf59ae65940da1dfea80144e42921e53
	Issue introduced in 6.0 with commit 5efdd9122eff772eae2feae9f0fc0ec02d4846a3 and fixed in 6.12.20 with commit 1c46673be93dd2954f44fe370fb4f2b8e6214224
	Issue introduced in 6.0 with commit 5efdd9122eff772eae2feae9f0fc0ec02d4846a3 and fixed in 6.13.8 with commit b24edd5c191c2689c59d0509f0903f9487eb6317
	Issue introduced in 6.0 with commit 5efdd9122eff772eae2feae9f0fc0ec02d4846a3 and fixed in 6.14 with commit d5a30fddfe2f2e540f6c43b59cf701809995faef
	Issue introduced in 5.15.107 with commit 1d9cad9c5873097ea141ffc5da1e7921ce765aa8

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-21962
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/smb/client/fs_context.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/9968fcf02cf6b0f78fbacf3f63e782162603855a
	https://git.kernel.org/stable/c/6c13fcb7cf59ae65940da1dfea80144e42921e53
	https://git.kernel.org/stable/c/1c46673be93dd2954f44fe370fb4f2b8e6214224
	https://git.kernel.org/stable/c/b24edd5c191c2689c59d0509f0903f9487eb6317
	https://git.kernel.org/stable/c/d5a30fddfe2f2e540f6c43b59cf701809995faef
