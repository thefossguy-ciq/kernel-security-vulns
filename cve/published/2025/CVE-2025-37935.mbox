From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-37935: net: ethernet: mtk_eth_soc: fix SER panic with 4GB+ RAM

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: ethernet: mtk_eth_soc: fix SER panic with 4GB+ RAM

If the mtk_poll_rx() function detects the MTK_RESETTING flag, it will
jump to release_desc and refill the high word of the SDP on the 4GB RFB.
Subsequently, mtk_rx_clean will process an incorrect SDP, leading to a
panic.

Add patch from MediaTek's SDK to resolve this.

The Linux kernel CVE team has assigned CVE-2025-37935 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.6 with commit 2d75891ebc09ba9cf30697dfd54497ef0220308f and fixed in 6.6.90 with commit cb625f783f70dc6614f03612b8e64ad99cb0a13c
	Issue introduced in 6.6 with commit 2d75891ebc09ba9cf30697dfd54497ef0220308f and fixed in 6.12.28 with commit 317013d1ad13524be02d60b9e98f08fbd13f8c14
	Issue introduced in 6.6 with commit 2d75891ebc09ba9cf30697dfd54497ef0220308f and fixed in 6.14.6 with commit 67619cf69dec5d1d7792808dfa548616742dd51d
	Issue introduced in 6.6 with commit 2d75891ebc09ba9cf30697dfd54497ef0220308f and fixed in 6.15-rc5 with commit 6e0490fc36cdac696f96e57b61d93b9ae32e0f4c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-37935
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/mediatek/mtk_eth_soc.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cb625f783f70dc6614f03612b8e64ad99cb0a13c
	https://git.kernel.org/stable/c/317013d1ad13524be02d60b9e98f08fbd13f8c14
	https://git.kernel.org/stable/c/67619cf69dec5d1d7792808dfa548616742dd51d
	https://git.kernel.org/stable/c/6e0490fc36cdac696f96e57b61d93b9ae32e0f4c
