From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71112: net: hns3: add VLAN id validation before using
Message-Id: <2026011413-CVE-2025-71112-ca37@gregkh>
Content-Length: 2769
Lines: 60
X-Developer-Signature: v=1; a=openpgp-sha256; l=2830;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=6EICqWS7yqmBLBwm42U8brJVbFZLYim/pmY5v1GpXr0=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJnpG55KxAq5n4rYydoecPTNWvszR/t2JDmbvlojrWbuM
 dP25dT1HbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAjCRvacY5lmrv+uaLHC874Lc
 kUOX3+gyf/Hps2GYX5bacCNLwi373lmzKs7pb+r7Sy1yAQ==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: hns3: add VLAN id validation before using

Currently, the VLAN id may be used without validation when
receive a VLAN configuration mailbox from VF. The length of
vlan_del_fail_bmap is BITS_TO_LONGS(VLAN_N_VID). It may cause
out-of-bounds memory access once the VLAN id is bigger than
or equal to VLAN_N_VID.

Therefore, VLAN id needs to be checked to ensure it is within
the range of VLAN_N_VID.

The Linux kernel CVE team has assigned CVE-2025-71112 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.3 with commit fe4144d47eef8453459c53a34e9d5940a3e6c219 and fixed in 6.1.160 with commit 00e56a7706e10b3d00a258d81fcb85a7e96372d6
	Issue introduced in 5.3 with commit fe4144d47eef8453459c53a34e9d5940a3e6c219 and fixed in 6.6.120 with commit b7b4f3bf118f51b67691a55b464f04452e5dc6fc
	Issue introduced in 5.3 with commit fe4144d47eef8453459c53a34e9d5940a3e6c219 and fixed in 6.12.64 with commit 95cca255a7a5ad782639ff0298c2a486707d1046
	Issue introduced in 5.3 with commit fe4144d47eef8453459c53a34e9d5940a3e6c219 and fixed in 6.18.3 with commit 91a51d01be5c9f82c12c2921ca5cceaa31b67128
	Issue introduced in 5.3 with commit fe4144d47eef8453459c53a34e9d5940a3e6c219 and fixed in 6.19-rc2 with commit 6ef935e65902bfed53980ad2754b06a284ea8ac1

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71112
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/hisilicon/hns3/hns3pf/hclge_main.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/00e56a7706e10b3d00a258d81fcb85a7e96372d6
	https://git.kernel.org/stable/c/b7b4f3bf118f51b67691a55b464f04452e5dc6fc
	https://git.kernel.org/stable/c/95cca255a7a5ad782639ff0298c2a486707d1046
	https://git.kernel.org/stable/c/91a51d01be5c9f82c12c2921ca5cceaa31b67128
	https://git.kernel.org/stable/c/6ef935e65902bfed53980ad2754b06a284ea8ac1
