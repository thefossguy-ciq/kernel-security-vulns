From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-39971: i40e: fix idx validation in config queues msg
Message-Id: <2025101556-CVE-2025-39971-97e2@gregkh>
Content-Length: 3212
Lines: 60
X-Developer-Signature: v=1; a=openpgp-sha256; l=3273;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=M9K573ACBxj7ie/NsnxeOdHAo5yBZVULtuOyzw8rcKA=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBnvg0/0reTxv9PkMV3LoFtJL+kcB3PhbYa6zOd/HDomr
 V9wW8OgI5aFQZCJQVZMkeXLNp6j+ysOKXoZ2p6GmcPKBDKEgYtTACZy+RvD/MpPswr0TvIpnvG6
 n1TG2t23dv3DvwxzJRPm/15nuiKTL1VIPFChsyBsUegrAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

i40e: fix idx validation in config queues msg

Ensure idx is within range of active/initialized TCs when iterating over
vf->ch[idx] in i40e_vc_config_queues_msg().

The Linux kernel CVE team has assigned CVE-2025-39971 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 5.4.300 with commit a6ff2af78343eceb0f77ab1a2fe802183bc21648
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 5.10.245 with commit f5f91d164af22e7147130ef8bebbdb28d8ecc6e2
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 5.15.194 with commit 1fa0aadade34481c567cdf4a897c0d4e4d548bd1
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.1.155 with commit 8b9c7719b0987b1c6c5fc910599f3618a558dbde
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.6.109 with commit 2cc26dac0518d2fa9b67ec813ee60e183480f98a
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.12.50 with commit bfcc1dff429d4b99ba03e40ddacc68ea4be2b32b
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.16.10 with commit 5c1f96123113e0bdc6d8dc2b0830184c93da9f65
	Issue introduced in 4.17 with commit c27eac48160de72dee33d42b5a33cc7b8a2eb1f5 and fixed in 6.17 with commit f1ad24c5abe1eaef69158bac1405a74b3c365115

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-39971
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/i40e/i40e_virtchnl_pf.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a6ff2af78343eceb0f77ab1a2fe802183bc21648
	https://git.kernel.org/stable/c/f5f91d164af22e7147130ef8bebbdb28d8ecc6e2
	https://git.kernel.org/stable/c/1fa0aadade34481c567cdf4a897c0d4e4d548bd1
	https://git.kernel.org/stable/c/8b9c7719b0987b1c6c5fc910599f3618a558dbde
	https://git.kernel.org/stable/c/2cc26dac0518d2fa9b67ec813ee60e183480f98a
	https://git.kernel.org/stable/c/bfcc1dff429d4b99ba03e40ddacc68ea4be2b32b
	https://git.kernel.org/stable/c/5c1f96123113e0bdc6d8dc2b0830184c93da9f65
	https://git.kernel.org/stable/c/f1ad24c5abe1eaef69158bac1405a74b3c365115
