From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-71133: RDMA/irdma: avoid invalid read in irdma_net_event

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

RDMA/irdma: avoid invalid read in irdma_net_event

irdma_net_event() should not dereference anything from "neigh" (alias
"ptr") until it has checked that the event is NETEVENT_NEIGH_UPDATE.
Other events come with different structures pointed to by "ptr" and they
may be smaller than struct neighbour.

Move the read of neigh->dev under the NETEVENT_NEIGH_UPDATE case.

The bug is mostly harmless, but it triggers KASAN on debug kernels:

 BUG: KASAN: stack-out-of-bounds in irdma_net_event+0x32e/0x3b0 [irdma]
 Read of size 8 at addr ffffc900075e07f0 by task kworker/27:2/542554

 CPU: 27 PID: 542554 Comm: kworker/27:2 Kdump: loaded Not tainted 5.14.0-630.el9.x86_64+debug #1
 Hardware name: [...]
 Workqueue: events rt6_probe_deferred
 Call Trace:
  <IRQ>
  dump_stack_lvl+0x60/0xb0
  print_address_description.constprop.0+0x2c/0x3f0
  print_report+0xb4/0x270
  kasan_report+0x92/0xc0
  irdma_net_event+0x32e/0x3b0 [irdma]
  notifier_call_chain+0x9e/0x180
  atomic_notifier_call_chain+0x5c/0x110
  rt6_do_redirect+0xb91/0x1080
  tcp_v6_err+0xe9b/0x13e0
  icmpv6_notify+0x2b2/0x630
  ndisc_redirect_rcv+0x328/0x530
  icmpv6_rcv+0xc16/0x1360
  ip6_protocol_deliver_rcu+0xb84/0x12e0
  ip6_input_finish+0x117/0x240
  ip6_input+0xc4/0x370
  ipv6_rcv+0x420/0x7d0
  __netif_receive_skb_one_core+0x118/0x1b0
  process_backlog+0xd1/0x5d0
  __napi_poll.constprop.0+0xa3/0x440
  net_rx_action+0x78a/0xba0
  handle_softirqs+0x2d4/0x9c0
  do_softirq+0xad/0xe0
  </IRQ>

The Linux kernel CVE team has assigned CVE-2025-71133 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.14 with commit 915cc7ac0f8e2a23675ee896e87f17c7d3c47089 and fixed in 5.15.198 with commit db93ae6fa66f1c61ae63400191195e3ee58021da
	Issue introduced in 5.14 with commit 915cc7ac0f8e2a23675ee896e87f17c7d3c47089 and fixed in 6.1.160 with commit 305c02e541befe4a44ffde30ed374970f41aeb6c
	Issue introduced in 5.14 with commit 915cc7ac0f8e2a23675ee896e87f17c7d3c47089 and fixed in 6.6.120 with commit fc23d05f0b3fb4d80657e7afebae2cae686b31c8
	Issue introduced in 5.14 with commit 915cc7ac0f8e2a23675ee896e87f17c7d3c47089 and fixed in 6.12.64 with commit bf197c7c79ef6458d1ee84dd7db251b51784885f
	Issue introduced in 5.14 with commit 915cc7ac0f8e2a23675ee896e87f17c7d3c47089 and fixed in 6.18.4 with commit d9b9affd103f51b42322da4ed5ac025b560bc354
	Issue introduced in 5.14 with commit 915cc7ac0f8e2a23675ee896e87f17c7d3c47089 and fixed in 6.19-rc4 with commit 6f05611728e9d0ab024832a4f1abb74a5f5d0bb0

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-71133
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/infiniband/hw/irdma/utils.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/db93ae6fa66f1c61ae63400191195e3ee58021da
	https://git.kernel.org/stable/c/305c02e541befe4a44ffde30ed374970f41aeb6c
	https://git.kernel.org/stable/c/fc23d05f0b3fb4d80657e7afebae2cae686b31c8
	https://git.kernel.org/stable/c/bf197c7c79ef6458d1ee84dd7db251b51784885f
	https://git.kernel.org/stable/c/d9b9affd103f51b42322da4ed5ac025b560bc354
	https://git.kernel.org/stable/c/6f05611728e9d0ab024832a4f1abb74a5f5d0bb0
