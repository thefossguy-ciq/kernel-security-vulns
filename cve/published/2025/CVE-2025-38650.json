{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nhfsplus: remove mutex_lock check in hfsplus_free_extents\n\nSyzbot reported an issue in hfsplus filesystem:\n\n------------[ cut here ]------------\nWARNING: CPU: 0 PID: 4400 at fs/hfsplus/extents.c:346\n\thfsplus_free_extents+0x700/0xad0\nCall Trace:\n<TASK>\nhfsplus_file_truncate+0x768/0xbb0 fs/hfsplus/extents.c:606\nhfsplus_write_begin+0xc2/0xd0 fs/hfsplus/inode.c:56\ncont_expand_zero fs/buffer.c:2383 [inline]\ncont_write_begin+0x2cf/0x860 fs/buffer.c:2446\nhfsplus_write_begin+0x86/0xd0 fs/hfsplus/inode.c:52\ngeneric_cont_expand_simple+0x151/0x250 fs/buffer.c:2347\nhfsplus_setattr+0x168/0x280 fs/hfsplus/inode.c:263\nnotify_change+0xe38/0x10f0 fs/attr.c:420\ndo_truncate+0x1fb/0x2e0 fs/open.c:65\ndo_sys_ftruncate+0x2eb/0x380 fs/open.c:193\ndo_syscall_x64 arch/x86/entry/common.c:50 [inline]\ndo_syscall_64+0x3d/0xb0 arch/x86/entry/common.c:80\nentry_SYSCALL_64_after_hwframe+0x63/0xcd\n\nTo avoid deadlock, Commit 31651c607151 (\"hfsplus: avoid deadlock\non file truncation\") unlock extree before hfsplus_free_extents(),\nand add check wheather extree is locked in hfsplus_free_extents().\n\nHowever, when operations such as hfsplus_file_release,\nhfsplus_setattr, hfsplus_unlink, and hfsplus_get_block are executed\nconcurrently in different files, it is very likely to trigger the\nWARN_ON, which will lead syzbot and xfstest to consider it as an\nabnormality.\n\nThe comment above this warning also describes one of the easy\ntriggering situations, which can easily trigger and cause\nxfstest&syzbot to report errors.\n\n[task A]\t\t\t[task B]\n->hfsplus_file_release\n  ->hfsplus_file_truncate\n    ->hfs_find_init\n      ->mutex_lock\n    ->mutex_unlock\n\t\t\t\t->hfsplus_write_begin\n\t\t\t\t  ->hfsplus_get_block\n\t\t\t\t    ->hfsplus_file_extend\n\t\t\t\t      ->hfsplus_ext_read_extent\n\t\t\t\t        ->hfs_find_init\n\t\t\t\t\t  ->mutex_lock\n    ->hfsplus_free_extents\n      WARN_ON(mutex_is_locked) !!!\n\nSeveral threads could try to lock the shared extents tree.\nAnd warning can be triggered in one thread when another thread\nhas locked the tree. This is the wrong behavior of the code and\nwe need to remove the warning."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/hfsplus/extents.c"
               ],
               "versions": [
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "0807e4ac59a546f2346961c5e26a98901594b205",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "fdd6aca652122d6e97787e88d7dd53ddc8b74e7e",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "14922f0cc92e010b160121679c0a6ca072f4e975",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "a19ce9230b22a0866313932e7964cf05557a6008",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "084933961ecda7561dedfb78c4676ccb90c91ada",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "5055b7db94110f228961dea6b74eed0a93a50b01",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "9764b8bb9f5f94df105cd2ac43829dd0d2c82b9f",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "314310166ba1fdff7660dfd9d18ea42d7058f7ae",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "31651c607151f1034cfb57e5a78678bea54c362b",
                     "lessThan": "fcb96956c921f1aae7e7b477f2435c56f77a31b4",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/hfsplus/extents.c"
               ],
               "versions": [
                  {
                     "version": "4.19",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "4.19",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.297",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.241",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.190",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.148",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.102",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.42",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.15.10",
                     "lessThanOrEqual": "6.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.16.1",
                     "lessThanOrEqual": "6.16.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.17",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "5.4.297"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "5.10.241"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "5.15.190"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "6.1.148"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "6.6.102"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "6.12.42"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "6.15.10"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "6.16.1"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "4.19",
                           "versionEndExcluding": "6.17"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/0807e4ac59a546f2346961c5e26a98901594b205"
            },
            {
               "url": "https://git.kernel.org/stable/c/fdd6aca652122d6e97787e88d7dd53ddc8b74e7e"
            },
            {
               "url": "https://git.kernel.org/stable/c/14922f0cc92e010b160121679c0a6ca072f4e975"
            },
            {
               "url": "https://git.kernel.org/stable/c/a19ce9230b22a0866313932e7964cf05557a6008"
            },
            {
               "url": "https://git.kernel.org/stable/c/084933961ecda7561dedfb78c4676ccb90c91ada"
            },
            {
               "url": "https://git.kernel.org/stable/c/5055b7db94110f228961dea6b74eed0a93a50b01"
            },
            {
               "url": "https://git.kernel.org/stable/c/9764b8bb9f5f94df105cd2ac43829dd0d2c82b9f"
            },
            {
               "url": "https://git.kernel.org/stable/c/314310166ba1fdff7660dfd9d18ea42d7058f7ae"
            },
            {
               "url": "https://git.kernel.org/stable/c/fcb96956c921f1aae7e7b477f2435c56f77a31b4"
            }
         ],
         "title": "hfsplus: remove mutex_lock check in hfsplus_free_extents",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2025-38650",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
