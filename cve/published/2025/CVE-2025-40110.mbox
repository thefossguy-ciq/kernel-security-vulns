From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-40110: drm/vmwgfx: Fix a null-ptr access in the cursor snooper

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/vmwgfx: Fix a null-ptr access in the cursor snooper

Check that the resource which is converted to a surface exists before
trying to use the cursor snooper on it.

vmw_cmd_res_check allows explicit invalid (SVGA3D_INVALID_ID) identifiers
because some svga commands accept SVGA3D_INVALID_ID to mean "no surface",
unfortunately functions that accept the actual surfaces as objects might
(and in case of the cursor snooper, do not) be able to handle null
objects. Make sure that we validate not only the identifier (via the
vmw_cmd_res_check) but also check that the actual resource exists before
trying to do something with it.

Fixes unchecked null-ptr reference in the snooping code.

The Linux kernel CVE team has assigned CVE-2025-40110 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.8 with commit c0951b797e7d0f2c6b0df2c0e18185c72d0cf1a1 and fixed in 5.10.248 with commit 3332212e93d0f6e24f8fe79f975e077c4e68ca39
	Issue introduced in 3.8 with commit c0951b797e7d0f2c6b0df2c0e18185c72d0cf1a1 and fixed in 5.15.198 with commit 86aae7053d2da3fdfde7b2e84d86e4af50490505
	Issue introduced in 3.8 with commit c0951b797e7d0f2c6b0df2c0e18185c72d0cf1a1 and fixed in 6.1.160 with commit af9d88cbf0fce52f465978360542ef679713491f
	Issue introduced in 3.8 with commit c0951b797e7d0f2c6b0df2c0e18185c72d0cf1a1 and fixed in 6.6.113 with commit 299cfb5a7deabdf9ecd30071755672af0aced5eb
	Issue introduced in 3.8 with commit c0951b797e7d0f2c6b0df2c0e18185c72d0cf1a1 and fixed in 6.12.54 with commit 13c9e4ed125e19484234c960efe5ac9c55119523
	Issue introduced in 3.8 with commit c0951b797e7d0f2c6b0df2c0e18185c72d0cf1a1 and fixed in 6.17.4 with commit b6fca0a07989f361ceda27cb2d09c555d4d4a964
	Issue introduced in 3.8 with commit c0951b797e7d0f2c6b0df2c0e18185c72d0cf1a1 and fixed in 6.18 with commit 5ac2c0279053a2c5265d46903432fb26ae2d0da2

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-40110
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/vmwgfx/vmwgfx_execbuf.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3332212e93d0f6e24f8fe79f975e077c4e68ca39
	https://git.kernel.org/stable/c/86aae7053d2da3fdfde7b2e84d86e4af50490505
	https://git.kernel.org/stable/c/af9d88cbf0fce52f465978360542ef679713491f
	https://git.kernel.org/stable/c/299cfb5a7deabdf9ecd30071755672af0aced5eb
	https://git.kernel.org/stable/c/13c9e4ed125e19484234c960efe5ac9c55119523
	https://git.kernel.org/stable/c/b6fca0a07989f361ceda27cb2d09c555d4d4a964
	https://git.kernel.org/stable/c/5ac2c0279053a2c5265d46903432fb26ae2d0da2
