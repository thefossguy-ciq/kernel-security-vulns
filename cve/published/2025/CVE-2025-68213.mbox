From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2025-68213: idpf: fix possible vport_config NULL pointer deref in remove
Message-Id: <2025121630-CVE-2025-68213-2d63@gregkh>
Content-Length: 3205
Lines: 72
X-Developer-Signature: v=1; a=openpgp-sha256; l=3278;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=qmArogY5qMAk0pddXaEA8d1/00+HsPKnXYSVFP8iSLo=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJmOqV5ad28IalW9WLZ/Bs+97PsMR692TT/Mz7hF7Hcqy
 8XYs28zOmJZGASZGGTFFFm+bOM5ur/ikKKXoe1pmDmsTCBDGLg4BWAiB/0Z5vBtlZ5+5Z5Z8v/l
 2pKc84LrVG+2sjPMj/suwdjYHHn7u9qd9o65dduNNj8UAwA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

idpf: fix possible vport_config NULL pointer deref in remove

Attempting to remove the driver will cause a crash in cases where
the vport failed to initialize. Following trace is from an instance where
the driver failed during an attempt to create a VF:
[ 1661.543624] idpf 0000:84:00.7: Device HW Reset initiated
[ 1722.923726] idpf 0000:84:00.7: Transaction timed-out (op:1 cookie:2900 vc_op:1 salt:29 timeout:60000ms)
[ 1723.353263] BUG: kernel NULL pointer dereference, address: 0000000000000028
...
[ 1723.358472] RIP: 0010:idpf_remove+0x11c/0x200 [idpf]
...
[ 1723.364973] Call Trace:
[ 1723.365475]  <TASK>
[ 1723.365972]  pci_device_remove+0x42/0xb0
[ 1723.366481]  device_release_driver_internal+0x1a9/0x210
[ 1723.366987]  pci_stop_bus_device+0x6d/0x90
[ 1723.367488]  pci_stop_and_remove_bus_device+0x12/0x20
[ 1723.367971]  pci_iov_remove_virtfn+0xbd/0x120
[ 1723.368309]  sriov_disable+0x34/0xe0
[ 1723.368643]  idpf_sriov_configure+0x58/0x140 [idpf]
[ 1723.368982]  sriov_numvfs_store+0xda/0x1c0

Avoid the NULL pointer dereference by adding NULL pointer check for
vport_config[i], before freeing user_config.q_coalesce.

The Linux kernel CVE team has assigned CVE-2025-68213 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.12.43 with commit bd80fbf3ed250ca98923780dab5e634db5d2f828 and fixed in 6.12.60 with commit a0e1c9bc1c9fe735978150ad075616a728073bc7
	Issue introduced in 6.17 with commit e1e3fec3e34b4934a9d2c98e4ee00a4d87b19179 and fixed in 6.17.10 with commit d5be8663cff0ba7b94da34ebd499ce1123b4c334
	Issue introduced in 6.17 with commit e1e3fec3e34b4934a9d2c98e4ee00a4d87b19179 and fixed in 6.18 with commit 118082368c2b6ddefe6cb607efc312285148f044
	Issue introduced in 6.15.11 with commit 5e87b3145578a169839e456fa0aba86e123d2d8e
	Issue introduced in 6.16.2 with commit ba11b0f3e9a97661f6caeee3dfc633af8ecee5a5

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2025-68213
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/intel/idpf/idpf_main.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a0e1c9bc1c9fe735978150ad075616a728073bc7
	https://git.kernel.org/stable/c/d5be8663cff0ba7b94da34ebd499ce1123b4c334
	https://git.kernel.org/stable/c/118082368c2b6ddefe6cb607efc312285148f044
