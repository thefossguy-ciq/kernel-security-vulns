From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-22992: libceph: return the handler error from mon_handle_auth_done()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

libceph: return the handler error from mon_handle_auth_done()

Currently any error from ceph_auth_handle_reply_done() is propagated
via finish_auth() but isn't returned from mon_handle_auth_done().  This
results in higher layers learning that (despite the monitor considering
us to be successfully authenticated) something went wrong in the
authentication phase and reacting accordingly, but msgr2 still trying
to proceed with establishing the session in the background.  In the
case of secure mode this can trigger a WARN in setup_crypto() and later
lead to a NULL pointer dereference inside of prepare_auth_signature().

The Linux kernel CVE team has assigned CVE-2026-22992 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.11 with commit cd1a677cad994021b19665ed476aea63f5d54f31 and fixed in 5.15.198 with commit 77229551f2cf72f3e35636db68e6a825b912cf16
	Issue introduced in 5.11 with commit cd1a677cad994021b19665ed476aea63f5d54f31 and fixed in 6.1.161 with commit 33908769248b38a5e77cf9292817bb28e641992d
	Issue introduced in 5.11 with commit cd1a677cad994021b19665ed476aea63f5d54f31 and fixed in 6.6.121 with commit e097cd858196b1914309e7e3d79b4fa79383754d
	Issue introduced in 5.11 with commit cd1a677cad994021b19665ed476aea63f5d54f31 and fixed in 6.12.66 with commit d2c4a5f6996683f287f3851ef5412797042de7f1
	Issue introduced in 5.11 with commit cd1a677cad994021b19665ed476aea63f5d54f31 and fixed in 6.18.6 with commit 9e0101e57534ef0e7578dd09608a6106736b82e5
	Issue introduced in 5.11 with commit cd1a677cad994021b19665ed476aea63f5d54f31 and fixed in 6.19-rc5 with commit e84b48d31b5008932c0a0902982809fbaa1d3b70

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-22992
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/ceph/mon_client.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/77229551f2cf72f3e35636db68e6a825b912cf16
	https://git.kernel.org/stable/c/33908769248b38a5e77cf9292817bb28e641992d
	https://git.kernel.org/stable/c/e097cd858196b1914309e7e3d79b4fa79383754d
	https://git.kernel.org/stable/c/d2c4a5f6996683f287f3851ef5412797042de7f1
	https://git.kernel.org/stable/c/9e0101e57534ef0e7578dd09608a6106736b82e5
	https://git.kernel.org/stable/c/e84b48d31b5008932c0a0902982809fbaa1d3b70
