From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-23136: libceph: reset sparse-read state in osd_fault()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

libceph: reset sparse-read state in osd_fault()

When a fault occurs, the connection is abandoned, reestablished, and any
pending operations are retried. The OSD client tracks the progress of a
sparse-read reply using a separate state machine, largely independent of
the messenger's state.

If a connection is lost mid-payload or the sparse-read state machine
returns an error, the sparse-read state is not reset. The OSD client
will then interpret the beginning of a new reply as the continuation of
the old one. If this makes the sparse-read machinery enter a failure
state, it may never recover, producing loops like:

  libceph:  [0] got 0 extents
  libceph: data len 142248331 != extent len 0
  libceph: osd0 (1)...:6801 socket error on read
  libceph: data len 142248331 != extent len 0
  libceph: osd0 (1)...:6801 socket error on read

Therefore, reset the sparse-read state in osd_fault(), ensuring retries
start from a clean state.

The Linux kernel CVE team has assigned CVE-2026-23136 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.6 with commit f628d799972799023d32c2542bb2639eb8c4f84e and fixed in 6.6.121 with commit 90a60fe61908afa0eaf7f8fcf1421b9b50e5f7ff
	Issue introduced in 6.6 with commit f628d799972799023d32c2542bb2639eb8c4f84e and fixed in 6.12.66 with commit e94075e950a6598e710b9f7dffea5aa388f40313
	Issue introduced in 6.6 with commit f628d799972799023d32c2542bb2639eb8c4f84e and fixed in 6.18.6 with commit 10b7c72810364226f7b27916ea3e2a4f870bc04b
	Issue introduced in 6.6 with commit f628d799972799023d32c2542bb2639eb8c4f84e and fixed in 6.19 with commit 11194b416ef95012c2cfe5f546d71af07b639e93

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-23136
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/ceph/osd_client.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/90a60fe61908afa0eaf7f8fcf1421b9b50e5f7ff
	https://git.kernel.org/stable/c/e94075e950a6598e710b9f7dffea5aa388f40313
	https://git.kernel.org/stable/c/10b7c72810364226f7b27916ea3e2a4f870bc04b
	https://git.kernel.org/stable/c/11194b416ef95012c2cfe5f546d71af07b639e93
