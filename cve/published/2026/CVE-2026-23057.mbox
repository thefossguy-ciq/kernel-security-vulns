From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-23057: vsock/virtio: Coalesce only linear skb
Message-Id: <2026020413-CVE-2026-23057-03eb@gregkh>
Content-Length: 2840
Lines: 65
X-Developer-Signature: v=1; a=openpgp-sha256; l=2906;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=1deELVs0wW9cBY486Dv8Xyv2HKPvgoqqCcs3Ww6N9Iw=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJnNBaHP1Z/UCfj/+q6rm75sy6rLtpq8KtGqcWeMYpYvz
 Rb9rS7WEcvCIMjEICumyPJlG8/R/RWHFL0MbU/DzGFlAhnCwMUpABO51sYwiylGaVlvKvcLk9n3
 U18F7LkbuodvIsN8v5yUbelf/64qFH0X2iH2v1w4b4UdAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

vsock/virtio: Coalesce only linear skb

vsock/virtio common tries to coalesce buffers in rx queue: if a linear skb
(with a spare tail room) is followed by a small skb (length limited by
GOOD_COPY_LEN = 128), an attempt is made to join them.

Since the introduction of MSG_ZEROCOPY support, assumption that a small skb
will always be linear is incorrect. In the zerocopy case, data is lost and
the linear skb is appended with uninitialized kernel memory.

Of all 3 supported virtio-based transports, only loopback-transport is
affected. G2H virtio-transport rx queue operates on explicitly linear skbs;
see virtio_vsock_alloc_linear_skb() in virtio_vsock_rx_fill(). H2G
vhost-transport may allocate non-linear skbs, but only for sizes that are
not considered for coalescence; see PAGE_ALLOC_COSTLY_ORDER in
virtio_vsock_alloc_skb().

Ensure only linear skbs are coalesced. Note that skb_tailroom(last_skb) > 0
guarantees last_skb is linear.

The Linux kernel CVE team has assigned CVE-2026-23057 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.7 with commit 581512a6dc939ef122e49336626ae159f3b8a345 and fixed in 6.12.68 with commit 568e9cd8ed7ca9bf748c7687ba6501f29d30e59f
	Issue introduced in 6.7 with commit 581512a6dc939ef122e49336626ae159f3b8a345 and fixed in 6.18.8 with commit 63ef9b300bd09e24c57050c5dbe68feedce42e72
	Issue introduced in 6.7 with commit 581512a6dc939ef122e49336626ae159f3b8a345 and fixed in 6.19-rc7 with commit 0386bd321d0f95d041a7b3d7b07643411b044a96

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-23057
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/vmw_vsock/virtio_transport_common.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/568e9cd8ed7ca9bf748c7687ba6501f29d30e59f
	https://git.kernel.org/stable/c/63ef9b300bd09e24c57050c5dbe68feedce42e72
	https://git.kernel.org/stable/c/0386bd321d0f95d041a7b3d7b07643411b044a96
