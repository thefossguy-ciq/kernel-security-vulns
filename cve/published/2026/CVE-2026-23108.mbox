From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-23108: can: usb_8dev: usb_8dev_read_bulk_callback(): fix URB memory leak

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

can: usb_8dev: usb_8dev_read_bulk_callback(): fix URB memory leak

Fix similar memory leak as in commit 7352e1d5932a ("can: gs_usb:
gs_usb_receive_bulk_callback(): fix URB memory leak").

In usb_8dev_open() -> usb_8dev_start(), the URBs for USB-in transfers are
allocated, added to the priv->rx_submitted anchor and submitted. In the
complete callback usb_8dev_read_bulk_callback(), the URBs are processed and
resubmitted. In usb_8dev_close() -> unlink_all_urbs() the URBs are freed by
calling usb_kill_anchored_urbs(&priv->rx_submitted).

However, this does not take into account that the USB framework unanchors
the URB before the complete function is called. This means that once an
in-URB has been completed, it is no longer anchored and is ultimately not
released in usb_kill_anchored_urbs().

Fix the memory leak by anchoring the URB in the
usb_8dev_read_bulk_callback() to the priv->rx_submitted anchor.

The Linux kernel CVE team has assigned CVE-2026-23108 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.9 with commit 0024d8ad1639e32d717445c69ca813fd19c2a91c and fixed in 5.10.249 with commit feb8243eaea7efd5279b19667d7189fd8654c87a
	Issue introduced in 3.9 with commit 0024d8ad1639e32d717445c69ca813fd19c2a91c and fixed in 5.15.199 with commit ef6e608e5ee71eca0cd3475c737e684cef24f240
	Issue introduced in 3.9 with commit 0024d8ad1639e32d717445c69ca813fd19c2a91c and fixed in 6.1.162 with commit 60719661b4cbd7ffbed1a0e0fa3bbc82d8bd2be9
	Issue introduced in 3.9 with commit 0024d8ad1639e32d717445c69ca813fd19c2a91c and fixed in 6.6.122 with commit 59ff56992bba28051ad67cd8cc7b0edfe7280796
	Issue introduced in 3.9 with commit 0024d8ad1639e32d717445c69ca813fd19c2a91c and fixed in 6.12.68 with commit ea4a98e924164586066b39f29bfcc7cc9da108cd
	Issue introduced in 3.9 with commit 0024d8ad1639e32d717445c69ca813fd19c2a91c and fixed in 6.18.8 with commit 07e9373739c6388af9d99797cdb2e79dbbcbe92b
	Issue introduced in 3.9 with commit 0024d8ad1639e32d717445c69ca813fd19c2a91c and fixed in 6.19-rc7 with commit f7a980b3b8f80fe367f679da376cf76e800f9480

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-23108
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/can/usb/usb_8dev.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/feb8243eaea7efd5279b19667d7189fd8654c87a
	https://git.kernel.org/stable/c/ef6e608e5ee71eca0cd3475c737e684cef24f240
	https://git.kernel.org/stable/c/60719661b4cbd7ffbed1a0e0fa3bbc82d8bd2be9
	https://git.kernel.org/stable/c/59ff56992bba28051ad67cd8cc7b0edfe7280796
	https://git.kernel.org/stable/c/ea4a98e924164586066b39f29bfcc7cc9da108cd
	https://git.kernel.org/stable/c/07e9373739c6388af9d99797cdb2e79dbbcbe92b
	https://git.kernel.org/stable/c/f7a980b3b8f80fe367f679da376cf76e800f9480
