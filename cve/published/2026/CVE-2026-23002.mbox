From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-23002: lib/buildid: use __kernel_read() for sleepable context
Message-Id: <2026012534-CVE-2026-23002-ffa4@gregkh>
Content-Length: 2867
Lines: 68
X-Developer-Signature: v=1; a=openpgp-sha256; l=2936;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=QEDQxSAJVTaAdO7HsUT+A69FW9wA2GjPyTFtnuOkAQ8=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJllWsVfuXouiB/+9i5yPbOvP4e4xWHTGYbWk6TTNGa6n
 7HK7l3XEcvCIMjEICumyPJlG8/R/RWHFL0MbU/DzGFlAhnCwMUpABNJX8EwT1MsPNTv691f13mk
 kzoj8iVYzjcuYViw3zRMpYNtjaj5UvU58UVPPohoankDAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

lib/buildid: use __kernel_read() for sleepable context

Prevent a "BUG: unable to handle kernel NULL pointer dereference in
filemap_read_folio".

For the sleepable context, convert freader to use __kernel_read() instead
of direct page cache access via read_cache_folio().  This simplifies the
faultable code path by using the standard kernel file reading interface
which handles all the complexity of reading file data.

At the moment we are not changing the code for non-sleepable context which
uses filemap_get_folio() and only succeeds if the target folios are
already in memory and up-to-date.  The reason is to keep the patch simple
and easier to backport to stable kernels.

Syzbot repro does not crash the kernel anymore and the selftests run
successfully.

In the follow up we will make __kernel_read() with IOCB_NOWAIT work for
non-sleepable contexts.  In addition, I would like to replace the
secretmem check with a more generic approach and will add fstest for the
buildid code.

The Linux kernel CVE team has assigned CVE-2026-23002 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.12 with commit ad41251c290dfe3c01472c94d2439a59de23fe97 and fixed in 6.12.67 with commit b11dfb7708f212b96c7973a474014c071aa02e05
	Issue introduced in 6.12 with commit ad41251c290dfe3c01472c94d2439a59de23fe97 and fixed in 6.18.7 with commit 568aeb3476c770a3863c755dd2a199c212434286
	Issue introduced in 6.12 with commit ad41251c290dfe3c01472c94d2439a59de23fe97 and fixed in 6.19-rc6 with commit 777a8560fd29738350c5094d4166fe5499452409

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-23002
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	lib/buildid.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/b11dfb7708f212b96c7973a474014c071aa02e05
	https://git.kernel.org/stable/c/568aeb3476c770a3863c755dd2a199c212434286
	https://git.kernel.org/stable/c/777a8560fd29738350c5094d4166fe5499452409
