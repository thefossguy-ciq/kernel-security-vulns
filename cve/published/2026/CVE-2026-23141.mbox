From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-23141: btrfs: send: check for inline extents in range_is_hole_in_parent()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

btrfs: send: check for inline extents in range_is_hole_in_parent()

Before accessing the disk_bytenr field of a file extent item we need
to check if we are dealing with an inline extent.
This is because for inline extents their data starts at the offset of
the disk_bytenr field. So accessing the disk_bytenr
means we are accessing inline data or in case the inline data is less
than 8 bytes we can actually cause an invalid
memory access if this inline extent item is the first item in the leaf
or access metadata from other items.

The Linux kernel CVE team has assigned CVE-2026-23141 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.11 with commit 82bfb2e7b645c8f228dc3b6d3b27b0b10125ca4f and fixed in 6.6.122 with commit f2dc6ab3a14c2d2eb0b14783427eb9b03bf631c9
	Issue introduced in 4.11 with commit 82bfb2e7b645c8f228dc3b6d3b27b0b10125ca4f and fixed in 6.12.67 with commit db00636643e66898d79f2530ac9c56ebd5eca369
	Issue introduced in 4.11 with commit 82bfb2e7b645c8f228dc3b6d3b27b0b10125ca4f and fixed in 6.18.7 with commit 39f83f10772310ba4a77f2b5256aaf36994ef7e8
	Issue introduced in 4.11 with commit 82bfb2e7b645c8f228dc3b6d3b27b0b10125ca4f and fixed in 6.19 with commit 08b096c1372cd69627f4f559fb47c9fb67a52b39

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-23141
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/btrfs/send.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/f2dc6ab3a14c2d2eb0b14783427eb9b03bf631c9
	https://git.kernel.org/stable/c/db00636643e66898d79f2530ac9c56ebd5eca369
	https://git.kernel.org/stable/c/39f83f10772310ba4a77f2b5256aaf36994ef7e8
	https://git.kernel.org/stable/c/08b096c1372cd69627f4f559fb47c9fb67a52b39
