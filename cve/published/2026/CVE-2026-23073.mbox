From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-23073: wifi: rsi: Fix memory corruption due to not set vif driver data size

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: rsi: Fix memory corruption due to not set vif driver data size

The struct ieee80211_vif contains trailing space for vif driver data,
when struct ieee80211_vif is allocated, the total memory size that is
allocated is sizeof(struct ieee80211_vif) + size of vif driver data.
The size of vif driver data is set by each WiFi driver as needed.

The RSI911x driver does not set vif driver data size, no trailing space
for vif driver data is therefore allocated past struct ieee80211_vif .
The RSI911x driver does however use the vif driver data to store its
vif driver data structure "struct vif_priv". An access to vif->drv_priv
leads to access out of struct ieee80211_vif bounds and corruption of
some memory.

In case of the failure observed locally, rsi_mac80211_add_interface()
would write struct vif_priv *vif_info = (struct vif_priv *)vif->drv_priv;
vif_info->vap_id = vap_idx. This write corrupts struct fq_tin member
struct list_head new_flows . The flow = list_first_entry(head, struct
fq_flow, flowchain); in fq_tin_reset() then reports non-NULL bogus
address, which when accessed causes a crash.

The trigger is very simple, boot the machine with init=/bin/sh , mount
devtmpfs, sysfs, procfs, and then do "ip link set wlan0 up", "sleep 1",
"ip link set wlan0 down" and the crash occurs.

Fix this by setting the correct size of vif driver data, which is the
size of "struct vif_priv", so that memory is allocated and the driver
can store its driver data in it, instead of corrupting memory around
it.

The Linux kernel CVE team has assigned CVE-2026-23073 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.15 with commit dad0d04fa7ba41ce603a01e8e64967650303e9a2 and fixed in 5.10.249 with commit 49ef094fdbc3526e5db2aebb404b84f79c5603dc
	Issue introduced in 3.15 with commit dad0d04fa7ba41ce603a01e8e64967650303e9a2 and fixed in 5.15.199 with commit 0d7c9e793e351cbbe9e06a9ca47d77b6ad288fb0
	Issue introduced in 3.15 with commit dad0d04fa7ba41ce603a01e8e64967650303e9a2 and fixed in 6.1.162 with commit 7c54d0c3e2cad4300be721ec2aecfcf8a63bc9f4
	Issue introduced in 3.15 with commit dad0d04fa7ba41ce603a01e8e64967650303e9a2 and fixed in 6.6.122 with commit 7761d7801f40e61069b4df3db88b36d80d089f8a
	Issue introduced in 3.15 with commit dad0d04fa7ba41ce603a01e8e64967650303e9a2 and fixed in 6.12.68 with commit 99129d80a5d4989ef8566f434f3589f60f28042b
	Issue introduced in 3.15 with commit dad0d04fa7ba41ce603a01e8e64967650303e9a2 and fixed in 6.18.8 with commit 31efbcff90884ea5f65bf3d1de01267db51ee3d1
	Issue introduced in 3.15 with commit dad0d04fa7ba41ce603a01e8e64967650303e9a2 and fixed in 6.19-rc7 with commit 4f431d88ea8093afc7ba55edf4652978c5a68f33

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-23073
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/rsi/rsi_91x_mac80211.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/49ef094fdbc3526e5db2aebb404b84f79c5603dc
	https://git.kernel.org/stable/c/0d7c9e793e351cbbe9e06a9ca47d77b6ad288fb0
	https://git.kernel.org/stable/c/7c54d0c3e2cad4300be721ec2aecfcf8a63bc9f4
	https://git.kernel.org/stable/c/7761d7801f40e61069b4df3db88b36d80d089f8a
	https://git.kernel.org/stable/c/99129d80a5d4989ef8566f434f3589f60f28042b
	https://git.kernel.org/stable/c/31efbcff90884ea5f65bf3d1de01267db51ee3d1
	https://git.kernel.org/stable/c/4f431d88ea8093afc7ba55edf4652978c5a68f33
