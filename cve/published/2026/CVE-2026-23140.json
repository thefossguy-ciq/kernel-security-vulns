{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, test_run: Subtract size of xdp_frame from allowed metadata size\n\nThe xdp_frame structure takes up part of the XDP frame headroom,\nlimiting the size of the metadata. However, in bpf_test_run, we don't\ntake this into account, which makes it possible for userspace to supply\na metadata size that is too large (taking up the entire headroom).\n\nIf userspace supplies such a large metadata size in live packet mode,\nthe xdp_update_frame_from_buff() call in xdp_test_run_init_page() call\nwill fail, after which packet transmission proceeds with an\nuninitialised frame structure, leading to the usual Bad Stuff.\n\nThe commit in the Fixes tag fixed a related bug where the second check\nin xdp_update_frame_from_buff() could fail, but did not add any\nadditional constraints on the metadata size. Complete the fix by adding\nan additional check on the metadata size. Reorder the checks slightly to\nmake the logic clearer and add a comment."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/bpf/test_run.c"
               ],
               "versions": [
                  {
                     "version": "b6f1f780b3932ae497ed85e79bc8a1e513883624",
                     "lessThan": "e7440935063949d6f2c10f7328d960d0ff4bce90",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "b6f1f780b3932ae497ed85e79bc8a1e513883624",
                     "lessThan": "7c81ad5e580bd8441f8a521a8d34824ce6582ae5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "b6f1f780b3932ae497ed85e79bc8a1e513883624",
                     "lessThan": "6447e697cfa8a43a8e491cb81bcc390d0f28f8ba",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "b6f1f780b3932ae497ed85e79bc8a1e513883624",
                     "lessThan": "31e37f44b60679d90b9f999c91371b15291be8e0",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "b6f1f780b3932ae497ed85e79bc8a1e513883624",
                     "lessThan": "e558cca217790286e799a8baacd1610bda31b261",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/bpf/test_run.c"
               ],
               "versions": [
                  {
                     "version": "5.18",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.18",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.161",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.121",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.66",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.18.6",
                     "lessThanOrEqual": "6.18.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.19",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.18",
                           "versionEndExcluding": "6.1.161"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.18",
                           "versionEndExcluding": "6.6.121"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.18",
                           "versionEndExcluding": "6.12.66"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.18",
                           "versionEndExcluding": "6.18.6"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.18",
                           "versionEndExcluding": "6.19"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/e7440935063949d6f2c10f7328d960d0ff4bce90"
            },
            {
               "url": "https://git.kernel.org/stable/c/7c81ad5e580bd8441f8a521a8d34824ce6582ae5"
            },
            {
               "url": "https://git.kernel.org/stable/c/6447e697cfa8a43a8e491cb81bcc390d0f28f8ba"
            },
            {
               "url": "https://git.kernel.org/stable/c/31e37f44b60679d90b9f999c91371b15291be8e0"
            },
            {
               "url": "https://git.kernel.org/stable/c/e558cca217790286e799a8baacd1610bda31b261"
            }
         ],
         "title": "bpf, test_run: Subtract size of xdp_frame from allowed metadata size",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2026-23140",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
