{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nksmbd: fix infinite loop caused by next_smb2_rcv_hdr_off reset in error paths\n\nThe problem occurs when a signed request fails smb2 signature verification\ncheck. In __process_request(), if check_sign_req() returns an error,\nset_smb2_rsp_status(work, STATUS_ACCESS_DENIED) is called.\nset_smb2_rsp_status() set work->next_smb2_rcv_hdr_off as zero. By resetting\nnext_smb2_rcv_hdr_off to zero, the pointer to the next command in the chain\nis lost. Consequently, is_chained_smb2_message() continues to point to\nthe same request header instead of advancing. If the header's NextCommand\nfield is non-zero, the function returns true, causing __handle_ksmbd_work()\nto repeatedly process the same failed request in an infinite loop.\nThis results in the kernel log being flooded with \"bad smb2 signature\"\nmessages and high CPU usage.\n\nThis patch fixes the issue by changing the return value from\nSERVER_HANDLER_CONTINUE to SERVER_HANDLER_ABORT. This ensures that\nthe processing loop terminates immediately rather than attempting to\ncontinue from an invalidated offset."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/smb/server/server.c"
               ],
               "versions": [
                  {
                     "version": "943cebf9ea3415ddefcd670d24d8883e97ba3d60",
                     "lessThan": "fb3b66bd72deb5543addaefa67963b34fb163a7b",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "be0f89d4419dc5413a1cf06db3671c9949be0d52",
                     "lessThan": "5accdc5b7f28a81bbc5880ac0b8886e60c86e8c8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "be0f89d4419dc5413a1cf06db3671c9949be0d52",
                     "lessThan": "f7b1c2f5642bbd60b1beef1f3298cbac81eb232c",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "be0f89d4419dc5413a1cf06db3671c9949be0d52",
                     "lessThan": "71b5e7c528315ca360a1825a4ad2f8ae48c5dc16",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "be0f89d4419dc5413a1cf06db3671c9949be0d52",
                     "lessThan": "9135e791ec2709bcf0cda0335535c74762489498",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "be0f89d4419dc5413a1cf06db3671c9949be0d52",
                     "lessThan": "010eb01ce23b34b50531448b0da391c7f05a72af",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "4b9b7ea1ffb1e34f01fa5726d0c184931b9ba565",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/smb/server/server.c"
               ],
               "versions": [
                  {
                     "version": "6.6",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.6",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.164",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.6.125",
                     "lessThanOrEqual": "6.6.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.12.72",
                     "lessThanOrEqual": "6.12.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.18.11",
                     "lessThanOrEqual": "6.18.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.19.1",
                     "lessThanOrEqual": "6.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "7.0-rc1",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1.71",
                           "versionEndExcluding": "6.1.164"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.6",
                           "versionEndExcluding": "6.6.125"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.6",
                           "versionEndExcluding": "6.12.72"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.6",
                           "versionEndExcluding": "6.18.11"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.6",
                           "versionEndExcluding": "6.19.1"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.6",
                           "versionEndExcluding": "7.0-rc1"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.15.145"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/fb3b66bd72deb5543addaefa67963b34fb163a7b"
            },
            {
               "url": "https://git.kernel.org/stable/c/5accdc5b7f28a81bbc5880ac0b8886e60c86e8c8"
            },
            {
               "url": "https://git.kernel.org/stable/c/f7b1c2f5642bbd60b1beef1f3298cbac81eb232c"
            },
            {
               "url": "https://git.kernel.org/stable/c/71b5e7c528315ca360a1825a4ad2f8ae48c5dc16"
            },
            {
               "url": "https://git.kernel.org/stable/c/9135e791ec2709bcf0cda0335535c74762489498"
            },
            {
               "url": "https://git.kernel.org/stable/c/010eb01ce23b34b50531448b0da391c7f05a72af"
            }
         ],
         "title": "ksmbd: fix infinite loop caused by next_smb2_rcv_hdr_off reset in error paths",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2026-23220",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
