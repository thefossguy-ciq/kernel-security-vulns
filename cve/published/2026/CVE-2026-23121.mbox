From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-23121: mISDN: annotate data-race around dev->work
Message-Id: <2026021408-CVE-2026-23121-73e6@gregkh>
Content-Length: 4278
Lines: 87
X-Developer-Signature: v=1; a=openpgp-sha256; l=4366;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=mTY8GT2GzoNoVn1hbBsp7MJjYovwTqFQTTasHWz0WSY=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDJkTJgRc8LVQv71NPaw6S3q556lF09lUoy5USUxYPsPT8
 80c0RLGjlgWBkEmBlkxRZYv23iO7q84pOhlaHsaZg4rE8gQBi5OAZjIyz6GBSf3zl8Wn6d5RUzA
 d5988sRph2XlfRjmcM2OauTkr48t6rrG0J58Mm2ecocIAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mISDN: annotate data-race around dev->work

dev->work can re read locklessly in mISDN_read()
and mISDN_poll(). Add READ_ONCE()/WRITE_ONCE() annotations.

BUG: KCSAN: data-race in mISDN_ioctl / mISDN_read

write to 0xffff88812d848280 of 4 bytes by task 10864 on cpu 1:
  misdn_add_timer drivers/isdn/mISDN/timerdev.c:175 [inline]
  mISDN_ioctl+0x2fb/0x550 drivers/isdn/mISDN/timerdev.c:233
  vfs_ioctl fs/ioctl.c:51 [inline]
  __do_sys_ioctl fs/ioctl.c:597 [inline]
  __se_sys_ioctl+0xce/0x140 fs/ioctl.c:583
  __x64_sys_ioctl+0x43/0x50 fs/ioctl.c:583
  x64_sys_call+0x14b0/0x3000 arch/x86/include/generated/asm/syscalls_64.h:17
  do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]
  do_syscall_64+0xd8/0x2c0 arch/x86/entry/syscall_64.c:94
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

read to 0xffff88812d848280 of 4 bytes by task 10857 on cpu 0:
  mISDN_read+0x1f2/0x470 drivers/isdn/mISDN/timerdev.c:112
  do_loop_readv_writev fs/read_write.c:847 [inline]
  vfs_readv+0x3fb/0x690 fs/read_write.c:1020
  do_readv+0xe7/0x210 fs/read_write.c:1080
  __do_sys_readv fs/read_write.c:1165 [inline]
  __se_sys_readv fs/read_write.c:1162 [inline]
  __x64_sys_readv+0x45/0x50 fs/read_write.c:1162
  x64_sys_call+0x2831/0x3000 arch/x86/include/generated/asm/syscalls_64.h:20
  do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]
  do_syscall_64+0xd8/0x2c0 arch/x86/entry/syscall_64.c:94
 entry_SYSCALL_64_after_hwframe+0x77/0x7f

value changed: 0x00000000 -> 0x00000001

The Linux kernel CVE team has assigned CVE-2026-23121 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.27 with commit 1b2b03f8e514e4f68e293846ba511a948b80243c and fixed in 5.10.249 with commit d5d99cb9e0839093cd53aa3b28176fce2f820ca0
	Issue introduced in 2.6.27 with commit 1b2b03f8e514e4f68e293846ba511a948b80243c and fixed in 5.15.199 with commit 13f3b3b87068898056db4c79ee67052fbde11d43
	Issue introduced in 2.6.27 with commit 1b2b03f8e514e4f68e293846ba511a948b80243c and fixed in 6.1.162 with commit accc3f8266d2a49881dbcf78c459477f4efa0ff3
	Issue introduced in 2.6.27 with commit 1b2b03f8e514e4f68e293846ba511a948b80243c and fixed in 6.6.122 with commit fc8ba17fd3337bd8b1913c30b95df0fee00d8fb7
	Issue introduced in 2.6.27 with commit 1b2b03f8e514e4f68e293846ba511a948b80243c and fixed in 6.12.68 with commit aa6e33cd74ca4965f2bbcb025e0b672fb0168a69
	Issue introduced in 2.6.27 with commit 1b2b03f8e514e4f68e293846ba511a948b80243c and fixed in 6.18.8 with commit 7ac345a93af31358e18e9606eb7b354691bf6757
	Issue introduced in 2.6.27 with commit 1b2b03f8e514e4f68e293846ba511a948b80243c and fixed in 6.19 with commit 8175dbf174d487afab81e936a862a8d9b8a1ccb6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-23121
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/isdn/mISDN/timerdev.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d5d99cb9e0839093cd53aa3b28176fce2f820ca0
	https://git.kernel.org/stable/c/13f3b3b87068898056db4c79ee67052fbde11d43
	https://git.kernel.org/stable/c/accc3f8266d2a49881dbcf78c459477f4efa0ff3
	https://git.kernel.org/stable/c/fc8ba17fd3337bd8b1913c30b95df0fee00d8fb7
	https://git.kernel.org/stable/c/aa6e33cd74ca4965f2bbcb025e0b672fb0168a69
	https://git.kernel.org/stable/c/7ac345a93af31358e18e9606eb7b354691bf6757
	https://git.kernel.org/stable/c/8175dbf174d487afab81e936a862a8d9b8a1ccb6
