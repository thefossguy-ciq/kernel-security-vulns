From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2026-23144: mm/damon/sysfs: cleanup attrs subdirs on context dir setup failure

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

mm/damon/sysfs: cleanup attrs subdirs on context dir setup failure

When a context DAMON sysfs directory setup is failed after setup of attrs/
directory, subdirectories of attrs/ directory are not cleaned up.  As a
result, DAMON sysfs interface is nearly broken until the system reboots,
and the memory for the unremoved directory is leaked.

Cleanup the directories under such failures.

The Linux kernel CVE team has assigned CVE-2026-23144 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.18 with commit c951cd3b89010c7a4751b9d4ea074007e44851e6 and fixed in 6.1.162 with commit db7dfe78fc81bdd2b532d77f340fe453f2360426
	Issue introduced in 5.18 with commit c951cd3b89010c7a4751b9d4ea074007e44851e6 and fixed in 6.6.122 with commit 43964644348f6b1add3055c4a6cae8f77d892a6e
	Issue introduced in 5.18 with commit c951cd3b89010c7a4751b9d4ea074007e44851e6 and fixed in 6.12.67 with commit 5651c0c391c0029541794f9c4c9597faecfd401f
	Issue introduced in 5.18 with commit c951cd3b89010c7a4751b9d4ea074007e44851e6 and fixed in 6.18.7 with commit 78b4eb99751ebd37ceade78810bf94de80f7fb3a
	Issue introduced in 5.18 with commit c951cd3b89010c7a4751b9d4ea074007e44851e6 and fixed in 6.19 with commit 9814cc832b88bd040fc2a1817c2b5469d0f7e862

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2026-23144
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	mm/damon/sysfs.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/db7dfe78fc81bdd2b532d77f340fe453f2360426
	https://git.kernel.org/stable/c/43964644348f6b1add3055c4a6cae8f77d892a6e
	https://git.kernel.org/stable/c/5651c0c391c0029541794f9c4c9597faecfd401f
	https://git.kernel.org/stable/c/78b4eb99751ebd37ceade78810bf94de80f7fb3a
	https://git.kernel.org/stable/c/9814cc832b88bd040fc2a1817c2b5469d0f7e862
