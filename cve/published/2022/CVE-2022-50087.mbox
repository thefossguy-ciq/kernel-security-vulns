From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50087: firmware: arm_scpi: Ensure scpi_info is not assigned if the probe fails

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

firmware: arm_scpi: Ensure scpi_info is not assigned if the probe fails

When scpi probe fails, at any point, we need to ensure that the scpi_info
is not set and will remain NULL until the probe succeeds. If it is not
taken care, then it could result use-after-free as the value is exported
via get_scpi_ops() and could refer to a memory allocated via devm_kzalloc()
but freed when the probe fails.

The Linux kernel CVE team has assigned CVE-2022-50087 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.4 with commit 8cb7cf56c9fe5412de238465b27ef35b4d2801aa and fixed in 4.19.256 with commit 5aa558232edc30468d1f35108826dd5b3ffe978f
	Issue introduced in 4.4 with commit 8cb7cf56c9fe5412de238465b27ef35b4d2801aa and fixed in 5.4.211 with commit 18048cba444a7c41dbf42c180d6b46606fc24c51
	Issue introduced in 4.4 with commit 8cb7cf56c9fe5412de238465b27ef35b4d2801aa and fixed in 5.10.137 with commit 08272646cd7c310642c39b7f54348fddd7987643
	Issue introduced in 4.4 with commit 8cb7cf56c9fe5412de238465b27ef35b4d2801aa and fixed in 5.15.61 with commit 0c29e149b6bb498778ed8a1c9597b51acfba7856
	Issue introduced in 4.4 with commit 8cb7cf56c9fe5412de238465b27ef35b4d2801aa and fixed in 5.18.18 with commit 87c4896d5dd7fd9927c814cf3c6289f41de3b562
	Issue introduced in 4.4 with commit 8cb7cf56c9fe5412de238465b27ef35b4d2801aa and fixed in 5.19.2 with commit 4f2d7b46d6b53c07f44a4f8f8f4438888f0e9e87
	Issue introduced in 4.4 with commit 8cb7cf56c9fe5412de238465b27ef35b4d2801aa and fixed in 6.0 with commit 689640efc0a2c4e07e6f88affe6d42cd40cc3f85

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50087
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/firmware/arm_scpi.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5aa558232edc30468d1f35108826dd5b3ffe978f
	https://git.kernel.org/stable/c/18048cba444a7c41dbf42c180d6b46606fc24c51
	https://git.kernel.org/stable/c/08272646cd7c310642c39b7f54348fddd7987643
	https://git.kernel.org/stable/c/0c29e149b6bb498778ed8a1c9597b51acfba7856
	https://git.kernel.org/stable/c/87c4896d5dd7fd9927c814cf3c6289f41de3b562
	https://git.kernel.org/stable/c/4f2d7b46d6b53c07f44a4f8f8f4438888f0e9e87
	https://git.kernel.org/stable/c/689640efc0a2c4e07e6f88affe6d42cd40cc3f85
