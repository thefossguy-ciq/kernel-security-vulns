From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49809: net/x25: Fix skb leak in x25_lapb_receive_frame()
Message-Id: <2025050129-CVE-2022-49809-770f@gregkh>
Content-Length: 3326
Lines: 62
X-Developer-Signature: v=1; a=openpgp-sha256; l=3389;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=phUz4Feqz0Z0MTsPpZm01Fd1iMyvhzVx9tUxj/QogbQ=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBnCDTPzzH8sOMXK+anhw+MWhTmTJEXfdn39M6ls0Vvui
 76Ny9OWdsSyMAgyMciKKbJ82cZzdH/FIUUvQ9vTMHNYmUCGMHBxCsBEfmxiWHDzj53ctS2BT4+z
 Jjao6sxMjzrS3cUw38n6cmXOjyYX/QcxEfPkWYQe7Hj4FwA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net/x25: Fix skb leak in x25_lapb_receive_frame()

x25_lapb_receive_frame() using skb_copy() to get a private copy of
skb, the new skb should be freed in the undersized/fragmented skb
error handling path. Otherwise there is a memory leak.

The Linux kernel CVE team has assigned CVE-2022-49809 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.1 with commit cb101ed2c3c7c0224d16953fe77bfb9d6c2cb9df and fixed in 4.9.334 with commit fda0ba7c84b46d10947c687320804b9de149a921
	Issue introduced in 3.1 with commit cb101ed2c3c7c0224d16953fe77bfb9d6c2cb9df and fixed in 4.14.300 with commit dfcfbe4f2e4b2c81cff4e79b48502d97fda73118
	Issue introduced in 3.1 with commit cb101ed2c3c7c0224d16953fe77bfb9d6c2cb9df and fixed in 4.19.267 with commit 0ef17d966445358a55c5f4ccf2c73cca3e39192b
	Issue introduced in 3.1 with commit cb101ed2c3c7c0224d16953fe77bfb9d6c2cb9df and fixed in 5.4.225 with commit e109b41870db995cae25dfaf0cc3922f9028b1a1
	Issue introduced in 3.1 with commit cb101ed2c3c7c0224d16953fe77bfb9d6c2cb9df and fixed in 5.10.156 with commit 9f00da9c866d506998bf0a3f699ec900730472da
	Issue introduced in 3.1 with commit cb101ed2c3c7c0224d16953fe77bfb9d6c2cb9df and fixed in 5.15.80 with commit c8baf1fc248b2e88642f094fea9509a9bf98c5bb
	Issue introduced in 3.1 with commit cb101ed2c3c7c0224d16953fe77bfb9d6c2cb9df and fixed in 6.0.10 with commit 2d675be16a461310d738d93f9f1a00da62055c5a
	Issue introduced in 3.1 with commit cb101ed2c3c7c0224d16953fe77bfb9d6c2cb9df and fixed in 6.1 with commit 2929cceb2fcf0ded7182562e4888afafece82cce
	Issue introduced in 3.0.72 with commit 7f3ea0c12493c9ff38a13a89bcf08846b50c1f1c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49809
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/x25/x25_dev.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/fda0ba7c84b46d10947c687320804b9de149a921
	https://git.kernel.org/stable/c/dfcfbe4f2e4b2c81cff4e79b48502d97fda73118
	https://git.kernel.org/stable/c/0ef17d966445358a55c5f4ccf2c73cca3e39192b
	https://git.kernel.org/stable/c/e109b41870db995cae25dfaf0cc3922f9028b1a1
	https://git.kernel.org/stable/c/9f00da9c866d506998bf0a3f699ec900730472da
	https://git.kernel.org/stable/c/c8baf1fc248b2e88642f094fea9509a9bf98c5bb
	https://git.kernel.org/stable/c/2d675be16a461310d738d93f9f1a00da62055c5a
	https://git.kernel.org/stable/c/2929cceb2fcf0ded7182562e4888afafece82cce
