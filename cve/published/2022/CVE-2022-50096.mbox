From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50096: x86/kprobes: Update kcb status flag after singlestepping

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

x86/kprobes: Update kcb status flag after singlestepping

Fix kprobes to update kcb (kprobes control block) status flag to
KPROBE_HIT_SSDONE even if the kp->post_handler is not set.

This bug may cause a kernel panic if another INT3 user runs right
after kprobes because kprobe_int3_handler() misunderstands the
INT3 is kprobe's single stepping INT3.

The Linux kernel CVE team has assigned CVE-2022-50096 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.13 with commit 6256e668b7af9d81472e03c6a171630c08f8858a and fixed in 5.15.61 with commit 1cbf3882cb372bbe752efd7c3045ca1c9ab40ac6
	Issue introduced in 5.13 with commit 6256e668b7af9d81472e03c6a171630c08f8858a and fixed in 5.18.18 with commit b9c3401f7cac6ae291a16784dadcd1bf116218fe
	Issue introduced in 5.13 with commit 6256e668b7af9d81472e03c6a171630c08f8858a and fixed in 5.19.2 with commit 663cdda2716b70751df9c7e60b81bd0850fdfe3c
	Issue introduced in 5.13 with commit 6256e668b7af9d81472e03c6a171630c08f8858a and fixed in 6.0 with commit dec8784c9088b131a1523f582c2194cfc8107dc0

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50096
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/x86/kernel/kprobes/core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/edc2ac7c7265b33660fa0190898966b49966b855
	https://git.kernel.org/stable/c/1cbf3882cb372bbe752efd7c3045ca1c9ab40ac6
	https://git.kernel.org/stable/c/b9c3401f7cac6ae291a16784dadcd1bf116218fe
	https://git.kernel.org/stable/c/663cdda2716b70751df9c7e60b81bd0850fdfe3c
	https://git.kernel.org/stable/c/dec8784c9088b131a1523f582c2194cfc8107dc0
