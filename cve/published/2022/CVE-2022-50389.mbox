From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50389: tpm: tpm_crb: Add the missed acpi_put_table() to fix memory leak
Message-Id: <2025091853-CVE-2022-50389-17eb@gregkh>
Content-Length: 3311
Lines: 62
X-Developer-Signature: v=1; a=openpgp-sha256; l=3374;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=o6vAKRGVd6nH6btIJwpKnZZQS1Mn+WJMxxjWjMrMZ6A=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlnuBxPmhVaJft7LmNOZHx4i0957o3QxNBJrHtFTl1sc
 49pbV/WEcvCIMjEICumyPJlG8/R/RWHFL0MbU/DzGFlAhnCwMUpABOReMQw379+9xd1rdi/QZGy
 t7V3J547fyGYlWF+ovKpiCMSbB+/aRnHvrHa8MvIknMHAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

tpm: tpm_crb: Add the missed acpi_put_table() to fix memory leak

In crb_acpi_add(), we get the TPM2 table to retrieve information
like start method, and then assign them to the priv data, so the
TPM2 table is not used after the init, should be freed, call
acpi_put_table() to fix the memory leak.

The Linux kernel CVE team has assigned CVE-2022-50389 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.0 with commit 30fc8d138e9123f374a3c3867e7c7c5cd4004941 and fixed in 4.14.303 with commit 08fd965521d0e172d540cf945517810895fcb199
	Issue introduced in 4.0 with commit 30fc8d138e9123f374a3c3867e7c7c5cd4004941 and fixed in 4.19.270 with commit 1af2232b13837ce0f3a082b9f43735b09aafc367
	Issue introduced in 4.0 with commit 30fc8d138e9123f374a3c3867e7c7c5cd4004941 and fixed in 5.4.229 with commit 927860dfa161ae8392a264197257dbdc52b26b0f
	Issue introduced in 4.0 with commit 30fc8d138e9123f374a3c3867e7c7c5cd4004941 and fixed in 5.10.163 with commit 0bd9b4be721c776f77adcaf34105dfca3007ddb9
	Issue introduced in 4.0 with commit 30fc8d138e9123f374a3c3867e7c7c5cd4004941 and fixed in 5.15.87 with commit 986cd9a9b95423e35a2cbb8e9105aec0e0d7f337
	Issue introduced in 4.0 with commit 30fc8d138e9123f374a3c3867e7c7c5cd4004941 and fixed in 6.0.17 with commit 2fcd3dc8b97a14f1672729c86b7041a1a89b052a
	Issue introduced in 4.0 with commit 30fc8d138e9123f374a3c3867e7c7c5cd4004941 and fixed in 6.1.3 with commit b0785edaf649e5f04dc7f75533e810f4c00e4106
	Issue introduced in 4.0 with commit 30fc8d138e9123f374a3c3867e7c7c5cd4004941 and fixed in 6.2 with commit 37e90c374dd11cf4919c51e847c6d6ced0abc555

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50389
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/char/tpm/tpm_crb.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/08fd965521d0e172d540cf945517810895fcb199
	https://git.kernel.org/stable/c/1af2232b13837ce0f3a082b9f43735b09aafc367
	https://git.kernel.org/stable/c/927860dfa161ae8392a264197257dbdc52b26b0f
	https://git.kernel.org/stable/c/0bd9b4be721c776f77adcaf34105dfca3007ddb9
	https://git.kernel.org/stable/c/986cd9a9b95423e35a2cbb8e9105aec0e0d7f337
	https://git.kernel.org/stable/c/2fcd3dc8b97a14f1672729c86b7041a1a89b052a
	https://git.kernel.org/stable/c/b0785edaf649e5f04dc7f75533e810f4c00e4106
	https://git.kernel.org/stable/c/37e90c374dd11cf4919c51e847c6d6ced0abc555
