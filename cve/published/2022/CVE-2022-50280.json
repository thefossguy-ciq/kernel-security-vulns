{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npnode: terminate at peers of source\n\nThe propagate_mnt() function handles mount propagation when creating\nmounts and propagates the source mount tree @source_mnt to all\napplicable nodes of the destination propagation mount tree headed by\n@dest_mnt.\n\nUnfortunately it contains a bug where it fails to terminate at peers of\n@source_mnt when looking up copies of the source mount that become\nmasters for copies of the source mount tree mounted on top of slaves in\nthe destination propagation tree causing a NULL dereference.\n\nOnce the mechanics of the bug are understood it's easy to trigger.\nBecause of unprivileged user namespaces it is available to unprivileged\nusers.\n\nWhile fixing this bug we've gotten confused multiple times due to\nunclear terminology or missing concepts. So let's start this with some\nclarifications:\n\n* The terms \"master\" or \"peer\" denote a shared mount. A shared mount\n  belongs to a peer group.\n\n* A peer group is a set of shared mounts that propagate to each other.\n  They are identified by a peer group id. The peer group id is available\n  in @shared_mnt->mnt_group_id.\n  Shared mounts within the same peer group have the same peer group id.\n  The peers in a peer group can be reached via @shared_mnt->mnt_share.\n\n* The terms \"slave mount\" or \"dependent mount\" denote a mount that\n  receives propagation from a peer in a peer group. IOW, shared mounts\n  may have slave mounts and slave mounts have shared mounts as their\n  master. Slave mounts of a given peer in a peer group are listed on\n  that peers slave list available at @shared_mnt->mnt_slave_list.\n\n* The term \"master mount\" denotes a mount in a peer group. IOW, it\n  denotes a shared mount or a peer mount in a peer group. The term\n  \"master mount\" - or \"master\" for short - is mostly used when talking\n  in the context of slave mounts that receive propagation from a master\n  mount. A master mount of a slave identifies the closest peer group a\n  slave mount receives propagation from. The master mount of a slave can\n  be identified via @slave_mount->mnt_master. Different slaves may point\n  to different masters in the same peer group.\n\n* Multiple peers in a peer group can have non-empty ->mnt_slave_lists.\n  Non-empty ->mnt_slave_lists of peers don't intersect. Consequently, to\n  ensure all slave mounts of a peer group are visited the\n  ->mnt_slave_lists of all peers in a peer group have to be walked.\n\n* Slave mounts point to a peer in the closest peer group they receive\n  propagation from via @slave_mnt->mnt_master (see above). Together with\n  these peers they form a propagation group (see below). The closest\n  peer group can thus be identified through the peer group id\n  @slave_mnt->mnt_master->mnt_group_id of the peer/master that a slave\n  mount receives propagation from.\n\n* A shared-slave mount is a slave mount to a peer group pg1 while also\n  a peer in another peer group pg2. IOW, a peer group may receive\n  propagation from another peer group.\n\n  If a peer group pg1 is a slave to another peer group pg2 then all\n  peers in peer group pg1 point to the same peer in peer group pg2 via\n  ->mnt_master. IOW, all peers in peer group pg1 appear on the same\n  ->mnt_slave_list. IOW, they cannot be slaves to different peer groups.\n\n* A pure slave mount is a slave mount that is a slave to a peer group\n  but is not a peer in another peer group.\n\n* A propagation group denotes the set of mounts consisting of a single\n  peer group pg1 and all slave mounts and shared-slave mounts that point\n  to a peer in that peer group via ->mnt_master. IOW, all slave mounts\n  such that @slave_mnt->mnt_master->mnt_group_id is equal to\n  @shared_mnt->mnt_group_id.\n\n  The concept of a propagation group makes it easier to talk about a\n  single propagation level in a propagation tree.\n\n  For example, in propagate_mnt() the immediate peers of @dest_mnt and\n  all slaves of @dest_mnt's peer group form a propagation group pr\n---truncated---"
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/pnode.c"
               ],
               "versions": [
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "cad0d17fb2b0540180ab59e2cd48ad348cc1ee4c",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "cc997490be65da0af8c75a6244fc80bb66c53ce0",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "7f57df69de7f05302fad584eb8e3f34de39e0311",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "2dae4211b579ce98985876a73a78466e285238ff",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "b591b2919d018ef91b4a9571edca94105bcad3df",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "c24cc476acd8bccb5af54849aac5e779d8223bf5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "e7c9f10c44a8919cd8bbd51b228c84d0caf7d518",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "784a4f995ee24460aa72e00b085612fad57ebce5",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "f2ebb3a921c1ca1e2ddd9242e95a1989a50c4c68",
                     "lessThan": "11933cf1d91d57da9e5c53822a540bbdc2656c16",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "fc7b1646bf29f722277bdd19551e01420ce9da8f",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/pnode.c"
               ],
               "versions": [
                  {
                     "version": "3.15",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "3.15",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.9.337",
                     "lessThanOrEqual": "4.9.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.14.303",
                     "lessThanOrEqual": "4.14.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "4.19.270",
                     "lessThanOrEqual": "4.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.4.229",
                     "lessThanOrEqual": "5.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.10.163",
                     "lessThanOrEqual": "5.10.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.87",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.0.17",
                     "lessThanOrEqual": "6.0.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.3",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.2",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "4.9.337"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "4.14.303"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "4.19.270"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "5.4.229"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "5.10.163"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "5.15.87"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "6.0.17"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "6.1.3"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.15",
                           "versionEndExcluding": "6.2"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.14.3"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/cad0d17fb2b0540180ab59e2cd48ad348cc1ee4c"
            },
            {
               "url": "https://git.kernel.org/stable/c/cc997490be65da0af8c75a6244fc80bb66c53ce0"
            },
            {
               "url": "https://git.kernel.org/stable/c/7f57df69de7f05302fad584eb8e3f34de39e0311"
            },
            {
               "url": "https://git.kernel.org/stable/c/2dae4211b579ce98985876a73a78466e285238ff"
            },
            {
               "url": "https://git.kernel.org/stable/c/b591b2919d018ef91b4a9571edca94105bcad3df"
            },
            {
               "url": "https://git.kernel.org/stable/c/c24cc476acd8bccb5af54849aac5e779d8223bf5"
            },
            {
               "url": "https://git.kernel.org/stable/c/e7c9f10c44a8919cd8bbd51b228c84d0caf7d518"
            },
            {
               "url": "https://git.kernel.org/stable/c/784a4f995ee24460aa72e00b085612fad57ebce5"
            },
            {
               "url": "https://git.kernel.org/stable/c/11933cf1d91d57da9e5c53822a540bbdc2656c16"
            }
         ],
         "title": "pnode: terminate at peers of source",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2022-50280",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
