From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49923: nfc: nxp-nci: Fix potential memory leak in nxp_nci_send()
Message-Id: <2025050109-CVE-2022-49923-a098@gregkh>
Content-Length: 2481
Lines: 55
X-Developer-Signature: v=1; a=openpgp-sha256; l=2537;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=es4cRt6drJFwvqqXJf4HUqUtzE6GS/hVQZtYNJQY5Xs=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBnCDQe/ptxb/WC2fUze95lzOe+k7Ji+dsbXuB8RumHPX
 CtTd86o7ohlYRBkYpAVU2T5so3n6P6KQ4pehranYeawMoEMYeDiFICJbGRiWDD5RYXl6tIsn9/W
 zZmXnvxnU0urKWWYK7nObTq3edUZXw1nichiw16Hua2/AA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

nfc: nxp-nci: Fix potential memory leak in nxp_nci_send()

nxp_nci_send() will call nxp_nci_i2c_write(), and only free skb when
nxp_nci_i2c_write() failed. However, even if the nxp_nci_i2c_write()
run succeeds, the skb will not be freed in nxp_nci_i2c_write(). As the
result, the skb will memleak. nxp_nci_send() should also free the skb
when nxp_nci_i2c_write() succeeds.

The Linux kernel CVE team has assigned CVE-2022-49923 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.1 with commit dece45855a8b0d1dcf48eb01d0822070ded6a4c8 and fixed in 5.10.154 with commit 9ae2c9a91ff068f4c3e392f47e8e26a1c9f85ebb
	Issue introduced in 4.1 with commit dece45855a8b0d1dcf48eb01d0822070ded6a4c8 and fixed in 5.15.78 with commit 3cba1f061bfe23fece2841129ca2862cdec29d5c
	Issue introduced in 4.1 with commit dece45855a8b0d1dcf48eb01d0822070ded6a4c8 and fixed in 6.0.8 with commit 3ecf0f4227029b2c42e036b10ff6e5d09e20821e
	Issue introduced in 4.1 with commit dece45855a8b0d1dcf48eb01d0822070ded6a4c8 and fixed in 6.1 with commit 7bf1ed6aff0f70434bd0cdd45495e83f1dffb551

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49923
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/nfc/nxp-nci/core.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/9ae2c9a91ff068f4c3e392f47e8e26a1c9f85ebb
	https://git.kernel.org/stable/c/3cba1f061bfe23fece2841129ca2862cdec29d5c
	https://git.kernel.org/stable/c/3ecf0f4227029b2c42e036b10ff6e5d09e20821e
	https://git.kernel.org/stable/c/7bf1ed6aff0f70434bd0cdd45495e83f1dffb551
