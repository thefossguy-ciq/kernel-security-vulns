From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49918: ipvs: fix WARNING in __ip_vs_cleanup_batch()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ipvs: fix WARNING in __ip_vs_cleanup_batch()

During the initialization of ip_vs_conn_net_init(), if file ip_vs_conn
or ip_vs_conn_sync fails to be created, the initialization is successful
by default. Therefore, the ip_vs_conn or ip_vs_conn_sync file doesn't
be found during the remove.

The following is the stack information:
name 'ip_vs_conn_sync'
WARNING: CPU: 3 PID: 9 at fs/proc/generic.c:712
remove_proc_entry+0x389/0x460
Modules linked in:
Workqueue: netns cleanup_net
RIP: 0010:remove_proc_entry+0x389/0x460
Call Trace:
<TASK>
__ip_vs_cleanup_batch+0x7d/0x120
ops_exit_list+0x125/0x170
cleanup_net+0x4ea/0xb00
process_one_work+0x9bf/0x1710
worker_thread+0x665/0x1080
kthread+0x2e4/0x3a0
ret_from_fork+0x1f/0x30
</TASK>

The Linux kernel CVE team has assigned CVE-2022-49918 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.39 with commit 61b1ab4583e275af216c8454b9256de680499b19 and fixed in 4.19.265 with commit f08ee2aa24c076f81d84e26e213d8c6f4efd9f50
	Issue introduced in 2.6.39 with commit 61b1ab4583e275af216c8454b9256de680499b19 and fixed in 5.4.224 with commit 7effc4ce3d1434ce6ff286866585a6e905fdbfc1
	Issue introduced in 2.6.39 with commit 61b1ab4583e275af216c8454b9256de680499b19 and fixed in 5.10.154 with commit 931f56d59c854263b32075bfac56fdb3b1598d1b
	Issue introduced in 2.6.39 with commit 61b1ab4583e275af216c8454b9256de680499b19 and fixed in 5.15.78 with commit 5ee2d6b726b0ce339e36569e5849692f4cf4595e
	Issue introduced in 2.6.39 with commit 61b1ab4583e275af216c8454b9256de680499b19 and fixed in 6.0.8 with commit e724220b826e008764309d2a1f55a9434a4e1530
	Issue introduced in 2.6.39 with commit 61b1ab4583e275af216c8454b9256de680499b19 and fixed in 6.1 with commit 3d00c6a0da8ddcf75213e004765e4a42acc71d5d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49918
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/netfilter/ipvs/ip_vs_conn.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/f08ee2aa24c076f81d84e26e213d8c6f4efd9f50
	https://git.kernel.org/stable/c/7effc4ce3d1434ce6ff286866585a6e905fdbfc1
	https://git.kernel.org/stable/c/931f56d59c854263b32075bfac56fdb3b1598d1b
	https://git.kernel.org/stable/c/5ee2d6b726b0ce339e36569e5849692f4cf4595e
	https://git.kernel.org/stable/c/e724220b826e008764309d2a1f55a9434a4e1530
	https://git.kernel.org/stable/c/3d00c6a0da8ddcf75213e004765e4a42acc71d5d
