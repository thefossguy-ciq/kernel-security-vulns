From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50565: wifi: plfxlc: fix potential memory leak in __lf_x_usb_enable_rx()
Message-Id: <2025102207-CVE-2022-50565-ddc2@gregkh>
Content-Length: 2141
Lines: 51
X-Developer-Signature: v=1; a=openpgp-sha256; l=2193;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=Ql9zX6K+7qraa7xVzySgC2Zv4mk4PwZHj2NceaNugC8=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBk/bn0/NfvI4tkCQswSWr82iMr06tW/kkuYvPnXjbRNc
 4rdDh4S7IhlYRBkYpAVU2T5so3n6P6KQ4pehranYeawMoEMYeDiFICJSE9hmKeyu8fVPNKsxInx
 K8PSPrUJecpPShkWbOYW+Lpo9vuFmlNWLGawtxdlXr44EgA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: plfxlc: fix potential memory leak in __lf_x_usb_enable_rx()

urbs does not be freed in exception paths in __lf_x_usb_enable_rx().
That will trigger memory leak. To fix it, add kfree() for urbs within
"error" label. Compile tested only.

The Linux kernel CVE team has assigned CVE-2022-50565 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.19 with commit 68d57a07bfe5bb29b80cd8b8fa24c9d1ea104124 and fixed in 6.0.16 with commit 286464463a05cb4bad80b134e24f8ffaab20bee4
	Issue introduced in 5.19 with commit 68d57a07bfe5bb29b80cd8b8fa24c9d1ea104124 and fixed in 6.1.2 with commit fce7e46273649d9cdcd98d89551975a65f206a14
	Issue introduced in 5.19 with commit 68d57a07bfe5bb29b80cd8b8fa24c9d1ea104124 and fixed in 6.2 with commit 895b3b06efc285c1245242e9638b9ae251dc13ec

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50565
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/purelifi/plfxlc/usb.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/286464463a05cb4bad80b134e24f8ffaab20bee4
	https://git.kernel.org/stable/c/fce7e46273649d9cdcd98d89551975a65f206a14
	https://git.kernel.org/stable/c/895b3b06efc285c1245242e9638b9ae251dc13ec
