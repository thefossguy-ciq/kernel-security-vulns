From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50047: net: dsa: mv88e6060: prevent crash on an unused port
Message-Id: <2025061844-CVE-2022-50047-db43@gregkh>
Content-Length: 3493
Lines: 71
X-Developer-Signature: v=1; a=openpgp-sha256; l=3565;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=vLCoMtcdqOAHtBNu0i3X6TR4EZzySIgyIzvR9SY0LYQ=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlBc2JbTNLvfytRKOuIn9B0sYer/1PRhXu7zWKU1M5an
 FOPf6zdEcvCIMjEICumyPJlG8/R/RWHFL0MbU/DzGFlAhnCwMUpABMJYWaYH3anoiaEoXr+k8AL
 f4R5jzFlHeKpYJhn/PXRWRmbO+lNza8yA/pnP/20L2EhAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: dsa: mv88e6060: prevent crash on an unused port

If the port isn't a CPU port nor a user port, 'cpu_dp'
is a null pointer and a crash happened on dereferencing
it in mv88e6060_setup_port():

[    9.575872] Unable to handle kernel NULL pointer dereference at virtual address 00000014
...
[    9.942216]  mv88e6060_setup from dsa_register_switch+0x814/0xe84
[    9.948616]  dsa_register_switch from mdio_probe+0x2c/0x54
[    9.954433]  mdio_probe from really_probe.part.0+0x98/0x2a0
[    9.960375]  really_probe.part.0 from driver_probe_device+0x30/0x10c
[    9.967029]  driver_probe_device from __device_attach_driver+0xb8/0x13c
[    9.973946]  __device_attach_driver from bus_for_each_drv+0x90/0xe0
[    9.980509]  bus_for_each_drv from __device_attach+0x110/0x184
[    9.986632]  __device_attach from bus_probe_device+0x8c/0x94
[    9.992577]  bus_probe_device from deferred_probe_work_func+0x78/0xa8
[    9.999311]  deferred_probe_work_func from process_one_work+0x290/0x73c
[   10.006292]  process_one_work from worker_thread+0x30/0x4b8
[   10.012155]  worker_thread from kthread+0xd4/0x10c
[   10.017238]  kthread from ret_from_fork+0x14/0x3c

The Linux kernel CVE team has assigned CVE-2022-50047 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.15 with commit 0abfd494deefdbab66ac03c1181a614285e7d90c and fixed in 5.4.211 with commit cb1753bc689c7a7f94da6eee7efc1ae6d8abb36c
	Issue introduced in 4.15 with commit 0abfd494deefdbab66ac03c1181a614285e7d90c and fixed in 5.10.138 with commit 92dc64e8f591425ce4dabf7d479ebf6e67fb8853
	Issue introduced in 4.15 with commit 0abfd494deefdbab66ac03c1181a614285e7d90c and fixed in 5.15.63 with commit dd236b62d25e44ecfa26b0910a12f8d8251aff00
	Issue introduced in 4.15 with commit 0abfd494deefdbab66ac03c1181a614285e7d90c and fixed in 5.19.4 with commit f3a4b55829617cad2d36fa6524367ef629566ba6
	Issue introduced in 4.15 with commit 0abfd494deefdbab66ac03c1181a614285e7d90c and fixed in 6.0 with commit 246bbf2f977ea36aaf41f5d24370fef433250728

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50047
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/dsa/mv88e6060.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cb1753bc689c7a7f94da6eee7efc1ae6d8abb36c
	https://git.kernel.org/stable/c/92dc64e8f591425ce4dabf7d479ebf6e67fb8853
	https://git.kernel.org/stable/c/dd236b62d25e44ecfa26b0910a12f8d8251aff00
	https://git.kernel.org/stable/c/f3a4b55829617cad2d36fa6524367ef629566ba6
	https://git.kernel.org/stable/c/246bbf2f977ea36aaf41f5d24370fef433250728
