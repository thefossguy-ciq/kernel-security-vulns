From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50355: staging: vt6655: fix some erroneous memory clean-up loops
Message-Id: <2025091714-CVE-2022-50355-11ce@gregkh>
Content-Length: 3524
Lines: 68
X-Developer-Signature: v=1; a=openpgp-sha256; l=3593;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=uVI3OYcdukx4s9d8oO0z/AMtoftInX0hlmaIHE0+4f8=;
 b=kA0DAAIRMUfUDdst+ykByyZiAGjKzA6hmG/AcTHEsrx+BfaHuH3CaedpJLazctJw6YIgEcMB9
 ohdBAARAgAdFiEE9LYMxb94wiFKMT3LMUfUDdst+ykFAmjKzA4ACgkQMUfUDdst+yn6FACfajMP
 B5FvBVCK0UWzk1Bv5sTdIHQAnj0W4/WEMx7vuc+GRI7qXW1+F6JA
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

staging: vt6655: fix some erroneous memory clean-up loops

In some initialization functions of this driver, memory is allocated with
'i' acting as an index variable and increasing from 0. The commit in
"Fixes" introduces some clean-up codes in case of allocation failure,
which free memory in reverse order with 'i' decreasing to 0. However,
there are some problems:
  - The case i=0 is left out. Thus memory is leaked.
  - In case memory allocation fails right from the start, the memory
    freeing loops will start with i=-1 and invalid memory locations will
    be accessed.

One of these loops has been fixed in commit c8ff91535880 ("staging:
vt6655: fix potential memory leak"). Fix the remaining erroneous loops.

The Linux kernel CVE team has assigned CVE-2022-50355 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.18 with commit 5341ee0adb17d12a96dc5344e0d267cd12b52135 and fixed in 4.19.262 with commit 637672a71f5016a40b0a6c0f3c8ad25eacedc8c3
	Issue introduced in 4.18 with commit 5341ee0adb17d12a96dc5344e0d267cd12b52135 and fixed in 5.4.220 with commit 88b9cc60f26e8a05d1ddbddf91b09ca2915f20e0
	Issue introduced in 4.18 with commit 5341ee0adb17d12a96dc5344e0d267cd12b52135 and fixed in 5.10.150 with commit 95ac62e8545be2b0a8cae0beef7c682e2e470e48
	Issue introduced in 4.18 with commit 5341ee0adb17d12a96dc5344e0d267cd12b52135 and fixed in 5.15.75 with commit f19e5b7df54590c831f350381963f25585c8f7d5
	Issue introduced in 4.18 with commit 5341ee0adb17d12a96dc5344e0d267cd12b52135 and fixed in 5.19.17 with commit a9e9806d1c315bc50dce05479a079b9a104474b8
	Issue introduced in 4.18 with commit 5341ee0adb17d12a96dc5344e0d267cd12b52135 and fixed in 6.0.3 with commit ed11b73c963292e7b49c0f37025c58ed3b7921d6
	Issue introduced in 4.18 with commit 5341ee0adb17d12a96dc5344e0d267cd12b52135 and fixed in 6.1 with commit 2a2db520e3ca5aafba7c211abfd397666c9b5f9d

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50355
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/staging/vt6655/device_main.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/637672a71f5016a40b0a6c0f3c8ad25eacedc8c3
	https://git.kernel.org/stable/c/88b9cc60f26e8a05d1ddbddf91b09ca2915f20e0
	https://git.kernel.org/stable/c/95ac62e8545be2b0a8cae0beef7c682e2e470e48
	https://git.kernel.org/stable/c/f19e5b7df54590c831f350381963f25585c8f7d5
	https://git.kernel.org/stable/c/a9e9806d1c315bc50dce05479a079b9a104474b8
	https://git.kernel.org/stable/c/ed11b73c963292e7b49c0f37025c58ed3b7921d6
	https://git.kernel.org/stable/c/2a2db520e3ca5aafba7c211abfd397666c9b5f9d
