From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50134: RDMA/hfi1: fix potential memory leak in setup_base_ctxt()
Message-Id: <2025061816-CVE-2022-50134-f6bd@gregkh>
Content-Length: 3382
Lines: 64
X-Developer-Signature: v=1; a=openpgp-sha256; l=3447;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=gQZw71X2m8CWMkUpehkU5wLmr9WEJMg7fOhICRz0eYQ=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlBc2rMrv83vbXke5DqztPi8RHtC8Md5z/YeHjP9thTY
 QofJn+v6YhlYRBkYpAVU2T5so3n6P6KQ4pehranYeawMoEMYeDiFICJdExjWLDqjXvFyUlz7qrn
 rhRXv8UUFS6//w/DXAFLheMb5suHt7ulz071sjmwt8/9OwA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

RDMA/hfi1: fix potential memory leak in setup_base_ctxt()

setup_base_ctxt() allocates a memory chunk for uctxt->groups with
hfi1_alloc_ctxt_rcv_groups(). When init_user_ctxt() fails, uctxt->groups
is not released, which will lead to a memory leak.

We should release the uctxt->groups with hfi1_free_ctxt_rcv_groups()
when init_user_ctxt() fails.

The Linux kernel CVE team has assigned CVE-2022-50134 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.14 with commit e87473bc1b6c2cb08f1b760cfc8cd012822241a6 and fixed in 4.14.291 with commit fc4de8009fd6c2ca51986c6757efa964040e7d02
	Issue introduced in 4.14 with commit e87473bc1b6c2cb08f1b760cfc8cd012822241a6 and fixed in 4.19.256 with commit 90ef48a718f88935d4af53d7dadd1ceafe103ce6
	Issue introduced in 4.14 with commit e87473bc1b6c2cb08f1b760cfc8cd012822241a6 and fixed in 5.4.211 with commit 2f90813f1c21c3d780585390af961bd17c8515ae
	Issue introduced in 4.14 with commit e87473bc1b6c2cb08f1b760cfc8cd012822241a6 and fixed in 5.10.137 with commit a85c7dd1edadcdeca24e603a6618153a3bcc81ca
	Issue introduced in 4.14 with commit e87473bc1b6c2cb08f1b760cfc8cd012822241a6 and fixed in 5.15.61 with commit e25b828553aecb3185a8d8d0c4f9b4e133fb5db6
	Issue introduced in 4.14 with commit e87473bc1b6c2cb08f1b760cfc8cd012822241a6 and fixed in 5.18.18 with commit 1750be1e9f18787cf717c24dbc5fa029fc372a22
	Issue introduced in 4.14 with commit e87473bc1b6c2cb08f1b760cfc8cd012822241a6 and fixed in 5.19.2 with commit a9055dfe437efae77e28e57205437c878a03ccb7
	Issue introduced in 4.14 with commit e87473bc1b6c2cb08f1b760cfc8cd012822241a6 and fixed in 6.0 with commit aa2a1df3a2c85f855af7d54466ac10bd48645d63

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50134
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/infiniband/hw/hfi1/file_ops.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/fc4de8009fd6c2ca51986c6757efa964040e7d02
	https://git.kernel.org/stable/c/90ef48a718f88935d4af53d7dadd1ceafe103ce6
	https://git.kernel.org/stable/c/2f90813f1c21c3d780585390af961bd17c8515ae
	https://git.kernel.org/stable/c/a85c7dd1edadcdeca24e603a6618153a3bcc81ca
	https://git.kernel.org/stable/c/e25b828553aecb3185a8d8d0c4f9b4e133fb5db6
	https://git.kernel.org/stable/c/1750be1e9f18787cf717c24dbc5fa029fc372a22
	https://git.kernel.org/stable/c/a9055dfe437efae77e28e57205437c878a03ccb7
	https://git.kernel.org/stable/c/aa2a1df3a2c85f855af7d54466ac10bd48645d63
