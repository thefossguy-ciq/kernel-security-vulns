From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49794: iio: adc: at91_adc: fix possible memory leak in at91_adc_allocate_trigger()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

iio: adc: at91_adc: fix possible memory leak in at91_adc_allocate_trigger()

If iio_trigger_register() returns error, it should call iio_trigger_free()
to give up the reference that hold in iio_trigger_alloc(), so that it can
call iio_trig_release() to free memory when the refcount hit to 0.

The Linux kernel CVE team has assigned CVE-2022-49794 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.5 with commit 0e589d5fb3172b0dde7fdad3a4829ce5352dd30d and fixed in 4.9.334 with commit c3ce73f60599a483dca7becd4112508833a40ef9
	Issue introduced in 3.5 with commit 0e589d5fb3172b0dde7fdad3a4829ce5352dd30d and fixed in 4.14.300 with commit a0d98ae5a62a7bbad8fcf9fa22e0a1274197bbc4
	Issue introduced in 3.5 with commit 0e589d5fb3172b0dde7fdad3a4829ce5352dd30d and fixed in 4.19.267 with commit 2b29a7f2d52fb5281b30cf61c947d88bab18a29b
	Issue introduced in 3.5 with commit 0e589d5fb3172b0dde7fdad3a4829ce5352dd30d and fixed in 5.4.225 with commit 7b75515728b628a9a7540f201efdeb8ca7299385
	Issue introduced in 3.5 with commit 0e589d5fb3172b0dde7fdad3a4829ce5352dd30d and fixed in 5.10.156 with commit 85d2a8b287a89853c0dcfc5a97b5e9d36376fe37
	Issue introduced in 3.5 with commit 0e589d5fb3172b0dde7fdad3a4829ce5352dd30d and fixed in 5.15.80 with commit 1bf8c0aff8fb5c4edf3ba6728e6bedbd610d7f4b
	Issue introduced in 3.5 with commit 0e589d5fb3172b0dde7fdad3a4829ce5352dd30d and fixed in 6.0.10 with commit c27a3b6ba23350708cf5ab9962337447b51eb76d
	Issue introduced in 3.5 with commit 0e589d5fb3172b0dde7fdad3a4829ce5352dd30d and fixed in 6.1 with commit 65f20301607d07ee279b0804d11a05a62a6c1a1c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49794
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/iio/adc/at91_adc.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/c3ce73f60599a483dca7becd4112508833a40ef9
	https://git.kernel.org/stable/c/a0d98ae5a62a7bbad8fcf9fa22e0a1274197bbc4
	https://git.kernel.org/stable/c/2b29a7f2d52fb5281b30cf61c947d88bab18a29b
	https://git.kernel.org/stable/c/7b75515728b628a9a7540f201efdeb8ca7299385
	https://git.kernel.org/stable/c/85d2a8b287a89853c0dcfc5a97b5e9d36376fe37
	https://git.kernel.org/stable/c/1bf8c0aff8fb5c4edf3ba6728e6bedbd610d7f4b
	https://git.kernel.org/stable/c/c27a3b6ba23350708cf5ab9962337447b51eb76d
	https://git.kernel.org/stable/c/65f20301607d07ee279b0804d11a05a62a6c1a1c
