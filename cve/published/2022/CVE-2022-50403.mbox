From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50403: ext4: fix undefined behavior in bit shift for ext4_check_flag_values

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ext4: fix undefined behavior in bit shift for ext4_check_flag_values

Shifting signed 32-bit value by 31 bits is undefined, so changing
significant bit to unsigned. The UBSAN warning calltrace like below:

UBSAN: shift-out-of-bounds in fs/ext4/ext4.h:591:2
left shift of 1 by 31 places cannot be represented in type 'int'
Call Trace:
 <TASK>
 dump_stack_lvl+0x7d/0xa5
 dump_stack+0x15/0x1b
 ubsan_epilogue+0xe/0x4e
 __ubsan_handle_shift_out_of_bounds+0x1e7/0x20c
 ext4_init_fs+0x5a/0x277
 do_one_initcall+0x76/0x430
 kernel_init_freeable+0x3b3/0x422
 kernel_init+0x24/0x1e0
 ret_from_fork+0x1f/0x30
 </TASK>

The Linux kernel CVE team has assigned CVE-2022-50403 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 4.9.337 with commit dd5639d36a5e4e42fd0fe05cc0b2ad9ddd3fca9d
	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 4.14.303 with commit d7f93fc6fba8ff017be871be7edf8614a785ccad
	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 4.19.270 with commit 743e9d708743d98464ccbd56e820d87dc6d1d629
	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 5.4.229 with commit 4690a4bdcf1470cb161aff1be30bd143b9dffd89
	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 5.10.163 with commit f9cd6980800bbfd11bf94eb5f942049d4d4eaa52
	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 5.15.87 with commit 205ac16628aca9093931fcbdb4bcd00d0eb94132
	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 6.0.18 with commit 5da9e607547f73dc7a643f35b0487992fd66910f
	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 6.1.4 with commit 7753d6657873a2523a9989e6c09090cd503bbcda
	Issue introduced in 3.8 with commit 9a4c8019471386c6fb039ae9e30f5216b6b55a9e and fixed in 6.2 with commit 3bf678a0f9c017c9ba7c581541dbc8453452a7ae

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50403
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/ext4/ext4.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/dd5639d36a5e4e42fd0fe05cc0b2ad9ddd3fca9d
	https://git.kernel.org/stable/c/d7f93fc6fba8ff017be871be7edf8614a785ccad
	https://git.kernel.org/stable/c/743e9d708743d98464ccbd56e820d87dc6d1d629
	https://git.kernel.org/stable/c/4690a4bdcf1470cb161aff1be30bd143b9dffd89
	https://git.kernel.org/stable/c/f9cd6980800bbfd11bf94eb5f942049d4d4eaa52
	https://git.kernel.org/stable/c/205ac16628aca9093931fcbdb4bcd00d0eb94132
	https://git.kernel.org/stable/c/5da9e607547f73dc7a643f35b0487992fd66910f
	https://git.kernel.org/stable/c/7753d6657873a2523a9989e6c09090cd503bbcda
	https://git.kernel.org/stable/c/3bf678a0f9c017c9ba7c581541dbc8453452a7ae
