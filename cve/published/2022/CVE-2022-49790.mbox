From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49790: Input: iforce - invert valid length check when fetching device IDs

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Input: iforce - invert valid length check when fetching device IDs

syzbot is reporting uninitialized value at iforce_init_device() [1], for
commit 6ac0aec6b0a6 ("Input: iforce - allow callers supply data buffer
when fetching device IDs") is checking that valid length is shorter than
bytes to read. Since iforce_get_id_packet() stores valid length when
returning 0, the caller needs to check that valid length is longer than or
equals to bytes to read.

The Linux kernel CVE team has assigned CVE-2022-49790 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.3 with commit 6ac0aec6b0a651d64eef759fddf17d9145b51033 and fixed in 5.4.225 with commit 5d53797ce7ce8fb1d95a5bebc5efa9418c4217a3
	Issue introduced in 5.3 with commit 6ac0aec6b0a651d64eef759fddf17d9145b51033 and fixed in 5.10.156 with commit 24cc679abbf31477d0cc6106ec83c2fbae6b3cdf
	Issue introduced in 5.3 with commit 6ac0aec6b0a651d64eef759fddf17d9145b51033 and fixed in 5.15.80 with commit fdd57c20d4408cac3c3c535c120d244e083406c9
	Issue introduced in 5.3 with commit 6ac0aec6b0a651d64eef759fddf17d9145b51033 and fixed in 6.0.10 with commit 6365569d62a75ddf53fb0c2936c16587a365984c
	Issue introduced in 5.3 with commit 6ac0aec6b0a651d64eef759fddf17d9145b51033 and fixed in 6.1 with commit b8ebf250997c5fb253582f42bfe98673801ebebd

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49790
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/input/joystick/iforce/iforce-main.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5d53797ce7ce8fb1d95a5bebc5efa9418c4217a3
	https://git.kernel.org/stable/c/24cc679abbf31477d0cc6106ec83c2fbae6b3cdf
	https://git.kernel.org/stable/c/fdd57c20d4408cac3c3c535c120d244e083406c9
	https://git.kernel.org/stable/c/6365569d62a75ddf53fb0c2936c16587a365984c
	https://git.kernel.org/stable/c/b8ebf250997c5fb253582f42bfe98673801ebebd
