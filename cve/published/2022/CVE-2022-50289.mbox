From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50289: ocfs2: fix memory leak in ocfs2_stack_glue_init()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ocfs2: fix memory leak in ocfs2_stack_glue_init()

ocfs2_table_header should be free in ocfs2_stack_glue_init() if
ocfs2_sysfs_init() failed, otherwise kmemleak will report memleak.

BUG: memory leak
unreferenced object 0xffff88810eeb5800 (size 128):
  comm "modprobe", pid 4507, jiffies 4296182506 (age 55.888s)
  hex dump (first 32 bytes):
    c0 40 14 a0 ff ff ff ff 00 00 00 00 01 00 00 00  .@..............
    01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
  backtrace:
    [<000000001e59e1cd>] __register_sysctl_table+0xca/0xef0
    [<00000000c04f70f7>] 0xffffffffa0050037
    [<000000001bd12912>] do_one_initcall+0xdb/0x480
    [<0000000064f766c9>] do_init_module+0x1cf/0x680
    [<000000002ba52db0>] load_module+0x6441/0x6f20
    [<000000009772580d>] __do_sys_finit_module+0x12f/0x1c0
    [<00000000380c1f22>] do_syscall_64+0x3f/0x90
    [<000000004cf473bc>] entry_SYSCALL_64_after_hwframe+0x63/0xcd

The Linux kernel CVE team has assigned CVE-2022-50289 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 4.9.337 with commit 0000281f019111526f7abccc61f2746d2eb626ca
	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 4.14.303 with commit 802abe2bc654e87334e6a0ab6c1adc2b6d5f6394
	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 4.19.270 with commit b0822faebd79971617abd495beb2d6f5356b88bf
	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 5.4.229 with commit 7c8bf45cea9c8d6fb3e14d8cd5ae60e0372f39b7
	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 5.10.163 with commit f5f2682d3a34dd8350bf63f232d885fd95f25b92
	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 5.15.86 with commit 61d68cf2ba79128c48d4b3fa4d10c34dc18ba572
	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 6.0.16 with commit 6f6c13776cbee4b6a515f4cd3b859f046be4f6f9
	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 6.1.2 with commit 0b2128b70849f2728949babfc1c760096ef72f5d
	Issue introduced in 2.6.26 with commit 3878f110f71a0971ff7acc15dd6db711b6ef37c6 and fixed in 6.2 with commit 13b6269dd022aaa69ca8d1df374ab327504121cf

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50289
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/ocfs2/stackglue.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/0000281f019111526f7abccc61f2746d2eb626ca
	https://git.kernel.org/stable/c/802abe2bc654e87334e6a0ab6c1adc2b6d5f6394
	https://git.kernel.org/stable/c/b0822faebd79971617abd495beb2d6f5356b88bf
	https://git.kernel.org/stable/c/7c8bf45cea9c8d6fb3e14d8cd5ae60e0372f39b7
	https://git.kernel.org/stable/c/f5f2682d3a34dd8350bf63f232d885fd95f25b92
	https://git.kernel.org/stable/c/61d68cf2ba79128c48d4b3fa4d10c34dc18ba572
	https://git.kernel.org/stable/c/6f6c13776cbee4b6a515f4cd3b859f046be4f6f9
	https://git.kernel.org/stable/c/0b2128b70849f2728949babfc1c760096ef72f5d
	https://git.kernel.org/stable/c/13b6269dd022aaa69ca8d1df374ab327504121cf
