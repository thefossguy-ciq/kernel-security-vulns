From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49431: powerpc/iommu: Add missing of_node_put in iommu_init_early_dart

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

powerpc/iommu: Add missing of_node_put in iommu_init_early_dart

The device_node pointer is returned by of_find_compatible_node
with refcount incremented. We should use of_node_put() to avoid
the refcount leak.

The Linux kernel CVE team has assigned CVE-2022-49431 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.4.198 with commit cb4f2dc513e99c5d0485661f114e4dda73612d10
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.10.121 with commit dfc308d6f29aa28463deb9a12278a85a382385ca
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.15.46 with commit df6d8b689252c0acc0448d4ae3d33f2d6db048ab
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.17.14 with commit 8657e8ea23325949091da72453ba84fb73cc2bd9
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.18.3 with commit 7e3f1dfb9e21733d7276bc9ccea4daada163f2ba
	Issue introduced in 2.6.12 with commit 1da177e4c3f41524e886b7f1b8a0c1fc7321cac2 and fixed in 5.19 with commit 57b742a5b8945118022973e6416b71351df512fb

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49431
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/powerpc/sysdev/dart_iommu.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cb4f2dc513e99c5d0485661f114e4dda73612d10
	https://git.kernel.org/stable/c/dfc308d6f29aa28463deb9a12278a85a382385ca
	https://git.kernel.org/stable/c/df6d8b689252c0acc0448d4ae3d33f2d6db048ab
	https://git.kernel.org/stable/c/8657e8ea23325949091da72453ba84fb73cc2bd9
	https://git.kernel.org/stable/c/7e3f1dfb9e21733d7276bc9ccea4daada163f2ba
	https://git.kernel.org/stable/c/57b742a5b8945118022973e6416b71351df512fb
