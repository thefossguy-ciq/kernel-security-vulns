From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50189: tools/power turbostat: Fix file pointer leak

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

tools/power turbostat: Fix file pointer leak

Currently if a fscanf fails then an early return leaks an open
file pointer. Fix this by fclosing the file before the return.
Detected using static analysis with cppcheck:

tools/power/x86/turbostat/turbostat.c:2039:3: error: Resource leak: fp [resourceLeak]

The Linux kernel CVE team has assigned CVE-2022-50189 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.19 with commit eae97e053fe306edbbe60c934031edf9a8affd3f and fixed in 5.19.2 with commit 2ebf6f5946817f33fb33e613e359229e98164eb3
	Issue introduced in 5.19 with commit eae97e053fe306edbbe60c934031edf9a8affd3f and fixed in 6.0 with commit 5e5fd36c58d6c820f7292ee492c3731c9a104a41

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50189
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	tools/power/x86/turbostat/turbostat.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/2ebf6f5946817f33fb33e613e359229e98164eb3
	https://git.kernel.org/stable/c/5e5fd36c58d6c820f7292ee492c3731c9a104a41
