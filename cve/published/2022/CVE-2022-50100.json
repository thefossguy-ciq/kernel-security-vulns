{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nsched/core: Do not requeue task on CPU excluded from cpus_mask\n\nThe following warning was triggered on a large machine early in boot on\na distribution kernel but the same problem should also affect mainline.\n\n   WARNING: CPU: 439 PID: 10 at ../kernel/workqueue.c:2231 process_one_work+0x4d/0x440\n   Call Trace:\n    <TASK>\n    rescuer_thread+0x1f6/0x360\n    kthread+0x156/0x180\n    ret_from_fork+0x22/0x30\n    </TASK>\n\nCommit c6e7bd7afaeb (\"sched/core: Optimize ttwu() spinning on p->on_cpu\")\noptimises ttwu by queueing a task that is descheduling on the wakelist,\nbut does not check if the task descheduling is still allowed to run on that CPU.\n\nIn this warning, the problematic task is a workqueue rescue thread which\nchecks if the rescue is for a per-cpu workqueue and running on the wrong CPU.\nWhile this is early in boot and it should be possible to create workers,\nthe rescue thread may still used if the MAYDAY_INITIAL_TIMEOUT is reached\nor MAYDAY_INTERVAL and on a sufficiently large machine, the rescue\nthread is being used frequently.\n\nTracing confirmed that the task should have migrated properly using the\nstopper thread to handle the migration. However, a parallel wakeup from udev\nrunning on another CPU that does not share CPU cache observes p->on_cpu and\nuses task_cpu(p), queues the task on the old CPU and triggers the warning.\n\nCheck that the wakee task that is descheduling is still allowed to run\non its current CPU and if not, wait for the descheduling to complete\nand select an allowed CPU."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "kernel/sched/core.c"
               ],
               "versions": [
                  {
                     "version": "c6e7bd7afaeb3af55ffac122828035f1c01d1d7b",
                     "lessThan": "748d2e9585ae53cb6be48e84f93d2f082ae1d135",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c6e7bd7afaeb3af55ffac122828035f1c01d1d7b",
                     "lessThan": "fde45283f4c8a91c367ea5f20f87036468755121",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c6e7bd7afaeb3af55ffac122828035f1c01d1d7b",
                     "lessThan": "302f7b0fc337746f41c69eb08522907f6a90c643",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "c6e7bd7afaeb3af55ffac122828035f1c01d1d7b",
                     "lessThan": "751d4cbc43879229dbc124afefe240b70fd29a85",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "kernel/sched/core.c"
               ],
               "versions": [
                  {
                     "version": "5.8",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.8",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.61",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.18.18",
                     "lessThanOrEqual": "5.18.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.19.2",
                     "lessThanOrEqual": "5.19.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.0",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.8",
                           "versionEndExcluding": "5.15.61"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.8",
                           "versionEndExcluding": "5.18.18"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.8",
                           "versionEndExcluding": "5.19.2"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.8",
                           "versionEndExcluding": "6.0"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/748d2e9585ae53cb6be48e84f93d2f082ae1d135"
            },
            {
               "url": "https://git.kernel.org/stable/c/fde45283f4c8a91c367ea5f20f87036468755121"
            },
            {
               "url": "https://git.kernel.org/stable/c/302f7b0fc337746f41c69eb08522907f6a90c643"
            },
            {
               "url": "https://git.kernel.org/stable/c/751d4cbc43879229dbc124afefe240b70fd29a85"
            }
         ],
         "title": "sched/core: Do not requeue task on CPU excluded from cpus_mask",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2022-50100",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
