From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49874: HID: hyperv: fix possible memory leak in mousevsc_probe()
Message-Id: <2025050152-CVE-2022-49874-3c3e@gregkh>
Content-Length: 3203
Lines: 60
X-Developer-Signature: v=1; a=openpgp-sha256; l=3264;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=m56hJiocqaE4Qj9+wAx8/QbuXKFP1KTSsL6wNHtX7ak=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBnCDRsmvLW65jytz3rh16B7xVNXtSrEOyStYzVqn2c9K
 XNB4Y5JHbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAjCRO9wMs9m2Rq2UTpiWczvA
 pOu/hcHTyGyeBQyzmFik0rnV/LZ/LOrRv64+SabtsCgHAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

HID: hyperv: fix possible memory leak in mousevsc_probe()

If hid_add_device() returns error, it should call hid_destroy_device()
to free hid_dev which is allocated in hid_allocate_device().

The Linux kernel CVE team has assigned CVE-2022-49874 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.3 with commit 74c4fb058083b47571a4f76dcfce95085f2d8098 and fixed in 4.9.334 with commit ed75d1a1c31a0cae8ecc8bcea710b25c0be68da0
	Issue introduced in 3.3 with commit 74c4fb058083b47571a4f76dcfce95085f2d8098 and fixed in 4.14.300 with commit 249b743801c00542e9324f87b380032e957a43e8
	Issue introduced in 3.3 with commit 74c4fb058083b47571a4f76dcfce95085f2d8098 and fixed in 4.19.267 with commit a6d2fb1874c52ace1f5cf1966ee558829c5c19b6
	Issue introduced in 3.3 with commit 74c4fb058083b47571a4f76dcfce95085f2d8098 and fixed in 5.4.225 with commit e29289d0d8193fca6d2c1f0a1de75cfc80edec00
	Issue introduced in 3.3 with commit 74c4fb058083b47571a4f76dcfce95085f2d8098 and fixed in 5.10.155 with commit 8597b59e3d22b27849bd3e4f92a3d466774bfb04
	Issue introduced in 3.3 with commit 74c4fb058083b47571a4f76dcfce95085f2d8098 and fixed in 5.15.79 with commit 5ad95d71344b7ffec360d62591633b3c465dc049
	Issue introduced in 3.3 with commit 74c4fb058083b47571a4f76dcfce95085f2d8098 and fixed in 6.0.9 with commit 5f3aba6566b866f5b0a4916f0b2e8a6ae66a6451
	Issue introduced in 3.3 with commit 74c4fb058083b47571a4f76dcfce95085f2d8098 and fixed in 6.1 with commit b5bcb94b0954a026bbd671741fdb00e7141f9c91

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49874
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/hid/hid-hyperv.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ed75d1a1c31a0cae8ecc8bcea710b25c0be68da0
	https://git.kernel.org/stable/c/249b743801c00542e9324f87b380032e957a43e8
	https://git.kernel.org/stable/c/a6d2fb1874c52ace1f5cf1966ee558829c5c19b6
	https://git.kernel.org/stable/c/e29289d0d8193fca6d2c1f0a1de75cfc80edec00
	https://git.kernel.org/stable/c/8597b59e3d22b27849bd3e4f92a3d466774bfb04
	https://git.kernel.org/stable/c/5ad95d71344b7ffec360d62591633b3c465dc049
	https://git.kernel.org/stable/c/5f3aba6566b866f5b0a4916f0b2e8a6ae66a6451
	https://git.kernel.org/stable/c/b5bcb94b0954a026bbd671741fdb00e7141f9c91
