From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50544: usb: host: xhci: Fix potential memory leak in xhci_alloc_stream_info()
Message-Id: <2025100757-CVE-2022-50544-f012@gregkh>
Content-Length: 2954
Lines: 68
X-Developer-Signature: v=1; a=openpgp-sha256; l=3023;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=9A7ipZsLNPO4ghpesqhmw1wos3mWOl+gDGuN1lKOvAI=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlP9W/uFuPtTzhyVFf42LEDJ36y1wX8W8C7xOhOumOnU
 ZZ+PMOFjlgWBkEmBlkxRZYv23iO7q84pOhlaHsaZg4rE8gQBi5OAZjIgTqGBctV8qU/JwhW64Q9
 L5ugX7QjuKn5O8OClhVNJ28tOC0To19/83M8T8v5K3XOAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

usb: host: xhci: Fix potential memory leak in xhci_alloc_stream_info()

xhci_alloc_stream_info() allocates stream context array for stream_info
->stream_ctx_array with xhci_alloc_stream_ctx(). When some error occurs,
stream_info->stream_ctx_array is not released, which will lead to a
memory leak.

We can fix it by releasing the stream_info->stream_ctx_array with
xhci_free_stream_ctx() on the error path to avoid the potential memory
leak.

The Linux kernel CVE team has assigned CVE-2022-50544 to this issue.


Affected and fixed versions
===========================

	Fixed in 4.9.331 with commit 7fc6bab3413e6a42bb1264ff7c9149808c93a4c7
	Fixed in 4.14.296 with commit e702de2f5c893bf2cdb0152191f99a6ad1411823
	Fixed in 4.19.262 with commit ddab9fe76296840aad686c66888a9c1dfdbff5ff
	Fixed in 5.4.220 with commit 9fa81cbd2dd300aa8fe9bac70e068b9a11cbb144
	Fixed in 5.10.150 with commit 91271a3e772e180bbb8afb114c72fd294a02f93d
	Fixed in 5.15.75 with commit fcd594da0b5955119d9707e4e0a8d0fb1c969101
	Fixed in 5.19.17 with commit a40ad475236022f3432880e3091c380e46e71a71
	Fixed in 6.0.3 with commit 782c873f8e7686f5b3c47e8b099f7e08c3dd1fdc
	Fixed in 6.1 with commit 7e271f42a5cc3768cd2622b929ba66859ae21f97

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50544
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/usb/host/xhci-mem.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/7fc6bab3413e6a42bb1264ff7c9149808c93a4c7
	https://git.kernel.org/stable/c/e702de2f5c893bf2cdb0152191f99a6ad1411823
	https://git.kernel.org/stable/c/ddab9fe76296840aad686c66888a9c1dfdbff5ff
	https://git.kernel.org/stable/c/9fa81cbd2dd300aa8fe9bac70e068b9a11cbb144
	https://git.kernel.org/stable/c/91271a3e772e180bbb8afb114c72fd294a02f93d
	https://git.kernel.org/stable/c/fcd594da0b5955119d9707e4e0a8d0fb1c969101
	https://git.kernel.org/stable/c/a40ad475236022f3432880e3091c380e46e71a71
	https://git.kernel.org/stable/c/782c873f8e7686f5b3c47e8b099f7e08c3dd1fdc
	https://git.kernel.org/stable/c/7e271f42a5cc3768cd2622b929ba66859ae21f97
