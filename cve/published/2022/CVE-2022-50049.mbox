From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50049: ASoC: DPCM: Don't pick up BE without substream
Message-Id: <2025061845-CVE-2022-50049-f6d9@gregkh>
Content-Length: 2554
Lines: 62
X-Developer-Signature: v=1; a=openpgp-sha256; l=2617;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=iS4msz9+cEjcLPe+fuaxB1gkMuEzbPTLzvnS9LXfNw4=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlBc2LfFU9utjpzrr7ukmtLlGD51oSbor8XTPjwySiiS
 i9wQxdrRywLgyATg6yYIsuXbTxH91ccUvQytD0NM4eVCWQIAxenAEyky4BhnknyiddJ8lMOibSu
 ETqaoC7YedpTgmHBYtmoVQVJG9K3aj9uPeewboEl0wYXAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ASoC: DPCM: Don't pick up BE without substream

When DPCM tries to add valid BE connections at dpcm_add_paths(), it
doesn't check whether the picked BE actually supports for the given
stream direction.  Due to that, when an asymmetric BE stream is
present, it picks up wrongly and this may result in a NULL dereference
at a later point where the code assumes the existence of a
corresponding BE substream.

This patch adds the check for the presence of the substream for the
target BE for avoiding the problem above.

Note that we have already some fix for non-existing BE substream at
commit 6246f283d5e0 ("ASoC: dpcm: skip missing substream while
applying symmetry").  But the code path we've hit recently is rather
happening before the previous fix.  So this patch tries to fix at
picking up a BE instead of parsing BE lists.

The Linux kernel CVE team has assigned CVE-2022-50049 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.17 with commit bbf7d3b1c4f40eb02dd1dffb500ba00b0bff0303 and fixed in 5.19.4 with commit 6a840e8ef6b6c56d1b7e6a555adc31135e517875
	Issue introduced in 5.17 with commit bbf7d3b1c4f40eb02dd1dffb500ba00b0bff0303 and fixed in 6.0 with commit 754590651ccbbcc74a7c20907be4bb15d642bde3

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50049
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	sound/soc/soc-pcm.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/aa803e6ecac78e93b24ebefa17c207d6392d8ad4
	https://git.kernel.org/stable/c/6a840e8ef6b6c56d1b7e6a555adc31135e517875
	https://git.kernel.org/stable/c/754590651ccbbcc74a7c20907be4bb15d642bde3
