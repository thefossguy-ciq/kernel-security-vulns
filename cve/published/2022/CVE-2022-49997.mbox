From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49997: net: lantiq_xrx200: restore buffer if memory allocation failed
Message-Id: <2025061826-CVE-2022-49997-f087@gregkh>
Content-Length: 2166
Lines: 52
X-Developer-Signature: v=1; a=openpgp-sha256; l=2219;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=EuB1jiNmeVMPdtICKLWo+VoK156tcpPciJS3BW7HxeI=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBlBc7yd7LhsnjwxXyoQeOtJRPg6rvYHyxsX7T5U0hmeq
 e4v3+jVEcvCIMjEICumyPJlG8/R/RWHFL0MbU/DzGFlAhnCwMUpABPRn8gwV/Z0lfvXc8Uf8yT3
 Rnh+Krj+1y9Xi2F+4dKmkLxZgX8Ty9gTtP409P6Km+QGAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: lantiq_xrx200: restore buffer if memory allocation failed

In a situation where memory allocation fails, an invalid buffer address
is stored. When this descriptor is used again, the system panics in the
build_skb() function when accessing memory.

The Linux kernel CVE team has assigned CVE-2022-49997 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.13 with commit 7ea6cd16f1599c1eac6018751eadbc5fc736b99a and fixed in 5.19.6 with commit 3ef2786e32d93e562cd40601248a14ae090de873
	Issue introduced in 5.13 with commit 7ea6cd16f1599c1eac6018751eadbc5fc736b99a and fixed in 6.0 with commit c9c3b1775f80fa21f5bff874027d2ccb10f5d90c
	Issue introduced in 5.4.128 with commit 217395c5ab15e92a4fd84fe77fab6b0b1bb4e456
	Issue introduced in 5.10.46 with commit 70c8418469fb22a679fe5015ebe60fe15011ea43
	Issue introduced in 5.12.13 with commit 5e006cdb9b759f604c4fc69b410aab37cf45f5b4

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49997
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/lantiq_xrx200.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3ef2786e32d93e562cd40601248a14ae090de873
	https://git.kernel.org/stable/c/c9c3b1775f80fa21f5bff874027d2ccb10f5d90c
