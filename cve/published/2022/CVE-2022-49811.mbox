From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-49811: drbd: use after free in drbd_create_device()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drbd: use after free in drbd_create_device()

The drbd_destroy_connection() frees the "connection" so use the _safe()
iterator to prevent a use after free.

The Linux kernel CVE team has assigned CVE-2022-49811 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.15 with commit b6f85ef9538b2111a8ba0bbfae9aaebabfc94961 and fixed in 4.14.300 with commit fc1897f16ebcfd22364f2afcc27f53a740f3bc7a
	Issue introduced in 3.15 with commit b6f85ef9538b2111a8ba0bbfae9aaebabfc94961 and fixed in 4.19.267 with commit bf47ca1b35fc1f55091ffaff5fbe41ea0c6f59a1
	Issue introduced in 3.15 with commit b6f85ef9538b2111a8ba0bbfae9aaebabfc94961 and fixed in 5.4.225 with commit 813a8dd9c45fd46f5cbbfbedf0791afa7740ccf5
	Issue introduced in 3.15 with commit b6f85ef9538b2111a8ba0bbfae9aaebabfc94961 and fixed in 5.10.156 with commit 9ed51414aef6e59e832e2960f10766dce2d5b1a1
	Issue introduced in 3.15 with commit b6f85ef9538b2111a8ba0bbfae9aaebabfc94961 and fixed in 5.15.80 with commit 7d93417d596402ddd46bd76c721f205d09d0d025
	Issue introduced in 3.15 with commit b6f85ef9538b2111a8ba0bbfae9aaebabfc94961 and fixed in 6.0.10 with commit c2a00b149836d60c222930bbea6b2139caf34d4f
	Issue introduced in 3.15 with commit b6f85ef9538b2111a8ba0bbfae9aaebabfc94961 and fixed in 6.1 with commit a7a1598189228b5007369a9622ccdf587be0730f

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-49811
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/block/drbd/drbd_main.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/fc1897f16ebcfd22364f2afcc27f53a740f3bc7a
	https://git.kernel.org/stable/c/bf47ca1b35fc1f55091ffaff5fbe41ea0c6f59a1
	https://git.kernel.org/stable/c/813a8dd9c45fd46f5cbbfbedf0791afa7740ccf5
	https://git.kernel.org/stable/c/9ed51414aef6e59e832e2960f10766dce2d5b1a1
	https://git.kernel.org/stable/c/7d93417d596402ddd46bd76c721f205d09d0d025
	https://git.kernel.org/stable/c/c2a00b149836d60c222930bbea6b2139caf34d4f
	https://git.kernel.org/stable/c/a7a1598189228b5007369a9622ccdf587be0730f
