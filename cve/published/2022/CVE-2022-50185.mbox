From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2022-50185: drm/radeon: fix potential buffer overflow in ni_set_mc_special_registers()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/radeon: fix potential buffer overflow in ni_set_mc_special_registers()

The last case label can write two buffers 'mc_reg_address[j]' and
'mc_data[j]' with 'j' offset equal to SMC_NISLANDS_MC_REGISTER_ARRAY_SIZE
since there are no checks for this value in both case labels after the
last 'j++'.

Instead of changing '>' to '>=' there, add the bounds check at the start
of the second 'case' (the first one already has it).

Also, remove redundant last checks for 'j' index bigger than array size.
The expression is always false. Moreover, before or after the patch
'table->last' can be equal to SMC_NISLANDS_MC_REGISTER_ARRAY_SIZE and it
seems it can be a valid value.

Detected using the static analysis tool - Svace.

The Linux kernel CVE team has assigned CVE-2022-50185 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.11 with commit 69e0b57a91adca2e3eb56ed4db39ab90f3ae1043 and fixed in 4.14.291 with commit ea73869df6ef386fc0feeb28ff66742ca835b18f
	Issue introduced in 3.11 with commit 69e0b57a91adca2e3eb56ed4db39ab90f3ae1043 and fixed in 4.19.256 with commit 1f341053852be76f82610ce47a505d930512f05c
	Issue introduced in 3.11 with commit 69e0b57a91adca2e3eb56ed4db39ab90f3ae1043 and fixed in 5.4.211 with commit db1a9add3f90ff1c641974d5bb910c16b87af4ef
	Issue introduced in 3.11 with commit 69e0b57a91adca2e3eb56ed4db39ab90f3ae1043 and fixed in 5.10.137 with commit 8508d6d23a247c29792ce2fc0df3f3404d6a6a80
	Issue introduced in 3.11 with commit 69e0b57a91adca2e3eb56ed4db39ab90f3ae1043 and fixed in 5.15.61 with commit deb603c5928e546609c0d5798e231d0205748943
	Issue introduced in 3.11 with commit 69e0b57a91adca2e3eb56ed4db39ab90f3ae1043 and fixed in 5.18.18 with commit 782e413e38dffd37cc85b08b1ccb982adb4a93ce
	Issue introduced in 3.11 with commit 69e0b57a91adca2e3eb56ed4db39ab90f3ae1043 and fixed in 5.19.2 with commit 9faff03617afeced1c4e5daa89e79b3906374342
	Issue introduced in 3.11 with commit 69e0b57a91adca2e3eb56ed4db39ab90f3ae1043 and fixed in 6.0 with commit 136f614931a2bb73616b292cf542da3a18daefd5

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2022-50185
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/radeon/ni_dpm.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ea73869df6ef386fc0feeb28ff66742ca835b18f
	https://git.kernel.org/stable/c/1f341053852be76f82610ce47a505d930512f05c
	https://git.kernel.org/stable/c/db1a9add3f90ff1c641974d5bb910c16b87af4ef
	https://git.kernel.org/stable/c/8508d6d23a247c29792ce2fc0df3f3404d6a6a80
	https://git.kernel.org/stable/c/deb603c5928e546609c0d5798e231d0205748943
	https://git.kernel.org/stable/c/782e413e38dffd37cc85b08b1ccb982adb4a93ce
	https://git.kernel.org/stable/c/9faff03617afeced1c4e5daa89e79b3906374342
	https://git.kernel.org/stable/c/136f614931a2bb73616b292cf542da3a18daefd5
