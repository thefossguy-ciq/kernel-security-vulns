From bippy-c9c4e1df01b2 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-43841: wifi: virt_wifi: avoid reporting connection success with wrong SSID
Message-Id: <2024081730-CVE-2024-43841-8143@gregkh>
Content-Length: 2569
Lines: 62
X-Developer-Signature: v=1; a=openpgp-sha256; l=2632;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=/iKctCBKpPZbYucw7mw4jAYqwvHfe1Cxo91tj/Sqso4=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDGkHsq8ptHSu3LTh562zholVd4XyD2pf+Xkr0bVszxxb3
 bf/8r9e74hlYRBkYpAVU2T5so3n6P6KQ4pehranYeawMoEMYeDiFICJzDzOsGDvk3279PzuFc+/
 /PfM972+B5+ISvxhmGd8Y/EEkZhLbw21VgYU/pL61X5WiB0A
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: virt_wifi: avoid reporting connection success with wrong SSID

When user issues a connection with a different SSID than the one
virt_wifi has advertised, the __cfg80211_connect_result() will
trigger the warning: WARN_ON(bss_not_found).

The issue is because the connection code in virt_wifi does not
check the SSID from user space (it only checks the BSSID), and
virt_wifi will call cfg80211_connect_result() with WLAN_STATUS_SUCCESS
even if the SSID is different from the one virt_wifi has advertised.
Eventually cfg80211 won't be able to find the cfg80211_bss and generate
the warning.

Fixed it by checking the SSID (from user space) in the connection code.

The Linux kernel CVE team has assigned CVE-2024-43841 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.0 with commit c7cdba31ed8b and fixed in 6.1.103 with commit d3cc85a10abc
	Issue introduced in 5.0 with commit c7cdba31ed8b and fixed in 6.6.44 with commit 36e92b5edc8e
	Issue introduced in 5.0 with commit c7cdba31ed8b and fixed in 6.10.3 with commit 416d3c1538df
	Issue introduced in 5.0 with commit c7cdba31ed8b and fixed in 6.11-rc1 with commit b5d14b0c6716

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-43841
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/virtual/virt_wifi.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/d3cc85a10abc8eae48988336cdd3689ab92581b3
	https://git.kernel.org/stable/c/36e92b5edc8e0daa18e9325674313802ce3fbc29
	https://git.kernel.org/stable/c/416d3c1538df005195721a200b0371d39636e05d
	https://git.kernel.org/stable/c/b5d14b0c6716fad7f0c94ac6e1d6f60a49f985c7
