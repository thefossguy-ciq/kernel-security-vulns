From bippy-8df59b4913de Mon Sep 17 00:00:00 2001
From: Lee Jones <lee@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-26634: net: fix removing a namespace with conflicting altnames
X-Developer-Signature: v=1; a=openpgp-sha256; l=2455; i=lee@kernel.org;
 h=from:subject; bh=FQyAevjXSuvGEKyiEqO0qtLIE3mDDZilCpK5Tb8S9DY=;
 b=owEBbQKS/ZANAwAKAVGvii+H/HdhAcsmYgBl+BQjXDAkAzz/WmDTd5tV2AUWoxADR8dSlvyQn
 6vhIv2AmR6JAjMEAAEKAB0WIQR2tsk1o74gmpTwh0hRr4ovh/x3YQUCZfgUIwAKCRBRr4ovh/x3
 YWicEACQi6O2DG3L71ZarWdxoNMPR2WeyjC8bKRl086xrxBeI+56ay8W1dqO8BmBxf33mbBSzQY
 OSJsbVgJfu88D5gKO3zOn5g+pTaMJh1iqNSaC6ErCMY1r/ZB7ZmmdMmH04AttC53X2F324VezCL
 yl6fFcyPDAwfAM2wr5xmguVY4SbxWmRj+nAzLWTIlz5LNxadds+RZG4yMUUbHGFJ4Yp6ots+7K9
 brv2NJjQ0eY1bznMQBzPLeiEUzGNIFG8anC2CGeJ29i0o20LsXD6kyAACG9InLUMh3Zc4jnW7q/
 i2uIBCkRtmY2dIpTCfXXgwiZw8r76zap/kW7N3fvMjddRZU+BJ08nt67Gcp+QMg8lJZ8pNcnqhy
 ED/8CitHWeUMicr1TWhDMxG5wKL8dtDVxogegKNaikzv/yT5vQJCC7XQ9IZRknV2wwtTNy0v/fm
 gCM+p+5uNJrC69wEAwWid+50vCxbsqXy1Q662aiBfGgG0Y1KF1pbOqqUyoM59iQBhwG9X2FmHEn
 Az2ZF33vVnzudCl3cCpXU9rYglONmkS4MgLP094kWN0tjB8zWAIW/jsdH/IB85XacJoQRHjzh1S
 27Gpn4rdNxiu42Xz9pUjyrcwLGVdtsURfvBVGHaO5Vzae5oNqwAgfaM6aYO98HWm+AjtkyFOPg0
 vpSIn4h/ePz3ibg==
X-Developer-Key: i=lee@kernel.org; a=openpgp;
 fpr=76B6C935A3BE209A94F0874851AF8A2F87FC7761

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

net: fix removing a namespace with conflicting altnames

Mark reports a BUG() when a net namespace is removed.

    kernel BUG at net/core/dev.c:11520!

Physical interfaces moved outside of init_net get "refunded"
to init_net when that namespace disappears. The main interface
name may get overwritten in the process if it would have
conflicted. We need to also discard all conflicting altnames.
Recent fixes addressed ensuring that altnames get moved
with the main interface, which surfaced this problem.

The Linux kernel CVE team has assigned CVE-2024-26634 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.1.60 with commit 673edcffa096 and fixed in 6.1.76 with commit a2232f29bf52
	Issue introduced in 6.6 with commit 7663d522099e and fixed in 6.6.15 with commit e855dded4b70
	Issue introduced in 6.6 with commit 7663d522099e and fixed in 6.7.3 with commit 8072699aa9e6
	Issue introduced in 6.6 with commit 7663d522099e and fixed in 6.8 with commit d09486a04f5d

Please see https://www.kernel.org or a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-26634
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/core/dev.c
	net/core/dev.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a2232f29bf52c24f827865b3c90829c44b6c695b
	https://git.kernel.org/stable/c/e855dded4b70d1975ee7b9fed0c700391e3c8ea6
	https://git.kernel.org/stable/c/8072699aa9e67d1727692cfb3c347263bb627fb9
	https://git.kernel.org/stable/c/d09486a04f5da0a812c26217213b89a3b1acf836
