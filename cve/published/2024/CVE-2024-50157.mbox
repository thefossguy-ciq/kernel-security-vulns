From bippy-9e1c9544281a Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-50157: RDMA/bnxt_re: Avoid CPU lockups due fifo occupancy check loop
Message-Id: <2024110746-CVE-2024-50157-5d80@gregkh>
Content-Length: 2133
Lines: 55
X-Developer-Signature: v=1; a=openpgp-sha256; l=2189;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=Yr0qVK1Wipe7/7p4+YRNeoRuUtFrw151Wk4jWNj2E/Q=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDOk6ndseJmrXzb7o2Tbz7V/DRzdtJKwqI+zmbf2/+V/v9
 vNZQpcedsSyMAgyMciKKbJ82cZzdH/FIUUvQ9vTMHNYmUCGMHBxCsBEPEIZ5jvqZAvt/2bZqBsu
 Y2xdfG6vRMbvOIa54oKp0/k+6geuvS5d5LH7D2fvjt3GAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

RDMA/bnxt_re: Avoid CPU lockups due fifo occupancy check loop

Driver waits indefinitely for the fifo occupancy to go below a threshold
as soon as the pacing interrupt is received. This can cause soft lockup on
one of the processors, if the rate of DB is very high.

Add a loop count for FPGA and exit the __wait_for_fifo_occupancy_below_th
if the loop is taking more time. Pacing will be continuing until the
occupancy is below the threshold. This is ensured by the checks in
bnxt_re_pacing_timer_exp and further scheduling the work for pacing based
on the fifo occupancy.

The Linux kernel CVE team has assigned CVE-2024-50157 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.6 with commit 2ad4e6303a6d and fixed in 6.11.6 with commit 2fb6b2e82413
	Issue introduced in 6.6 with commit 2ad4e6303a6d and fixed in 6.12-rc4 with commit 8be3e5b0c96b

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-50157
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/infiniband/hw/bnxt_re/main.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/2fb6b2e82413e401b72dfeacd7a60416fcfc5b41
	https://git.kernel.org/stable/c/8be3e5b0c96beeefe9d5486b96575d104d3e7d17
