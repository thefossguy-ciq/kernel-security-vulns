From bippy-a5840b7849dd Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-38620: Bluetooth: HCI: Remove HCI_AMP support
Message-Id: <2024062047-CVE-2024-38620-64ef@gregkh>
Content-Length: 2766
Lines: 75
X-Developer-Signature: v=1; a=openpgp-sha256; l=2842;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=REffH7Jg//ItapHGOL47R3tSZ0tY7/e6RZVSLU4H79Q=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDGnFj5Jn/zCxOH+skGfPBPm04OaDB5ccf/ixJu+E4tsOz
 08yfj3cHbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAjCRVRwMC04sPiDB8zGydqni
 7Vnxzs+eakfPqmGYZ+Ops2hiIyNXl/crq4eRE7/8fMP0GgA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Bluetooth: HCI: Remove HCI_AMP support

Since BT_HS has been remove HCI_AMP controllers no longer has any use so
remove it along with the capability of creating AMP controllers.

Since we no longer need to differentiate between AMP and Primary
controllers, as only HCI_PRIMARY is left, this also remove
hdev->dev_type altogether.

The Linux kernel CVE team has assigned CVE-2024-38620 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.3 with commit 244bc377591c and fixed in 6.6.33 with commit 5af2e235b0d5
	Issue introduced in 4.3 with commit 244bc377591c and fixed in 6.8.12 with commit d3c7b012d912
	Issue introduced in 4.3 with commit 244bc377591c and fixed in 6.9.3 with commit af1d425b6dc6
	Issue introduced in 4.3 with commit 244bc377591c and fixed in 6.10-rc1 with commit 84a4bb6548a2

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-38620
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/bluetooth/btmrvl_main.c
	drivers/bluetooth/btrsi.c
	drivers/bluetooth/btsdio.c
	drivers/bluetooth/btusb.c
	drivers/bluetooth/hci_bcm4377.c
	drivers/bluetooth/hci_ldisc.c
	drivers/bluetooth/hci_serdev.c
	drivers/bluetooth/hci_uart.h
	drivers/bluetooth/hci_vhci.c
	drivers/bluetooth/virtio_bt.c
	include/net/bluetooth/hci.h
	include/net/bluetooth/hci_core.h
	include/uapi/linux/virtio_bt.h
	net/bluetooth/hci_conn.c
	net/bluetooth/hci_core.c
	net/bluetooth/hci_event.c
	net/bluetooth/hci_sock.c
	net/bluetooth/hci_sync.c
	net/bluetooth/l2cap_core.c
	net/bluetooth/mgmt.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5af2e235b0d5b797e9531a00c50058319130e156
	https://git.kernel.org/stable/c/d3c7b012d912b31ad23b9349c0e499d6dddd48ec
	https://git.kernel.org/stable/c/af1d425b6dc67cd67809f835dd7afb6be4d43e03
	https://git.kernel.org/stable/c/84a4bb6548a29326564f0e659fb8064503ecc1c7
