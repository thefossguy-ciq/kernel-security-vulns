From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2024-58241: Bluetooth: hci_core: Disable works on hci_unregister_dev

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Bluetooth: hci_core: Disable works on hci_unregister_dev

This make use of disable_work_* on hci_unregister_dev since the hci_dev is
about to be freed new submissions are not disarable.

The Linux kernel CVE team has assigned CVE-2024-58241 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.10 with commit 0d151a103775dd9645c78c97f77d6e2a5298d913 and fixed in 6.11.6 with commit cfdb13a54e05eb98d9940cb6d1a13e7f994d811f
	Issue introduced in 6.10 with commit 0d151a103775dd9645c78c97f77d6e2a5298d913 and fixed in 6.12 with commit 989fa5171f005ecf63440057218d8aeb1795287d
	Issue introduced in 4.19.319 with commit 48542881997e17b49dc16b93fe910e0cfcf7a9f9
	Issue introduced in 5.4.281 with commit 9cfc84b1d464cc024286f42a090718f9067b80ed
	Issue introduced in 5.10.223 with commit ddeda6ca5f218b668b560d90fc31ae469adbfd92
	Issue introduced in 5.15.164 with commit d2ce562a5aff1dcd0c50d9808ea825ef90da909f
	Issue introduced in 6.1.101 with commit 96600c2e5ee8213dbab5df1617293d8e847bb4fa
	Issue introduced in 6.6.42 with commit d6cbce18370641a21dd889e8613d8153df15eb39
	Issue introduced in 6.9.11 with commit 3f939bd73fed12dddc2a32a76116c19ca47c7678

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2024-58241
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/bluetooth/hci_core.c
	net/bluetooth/hci_sync.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cfdb13a54e05eb98d9940cb6d1a13e7f994d811f
	https://git.kernel.org/stable/c/989fa5171f005ecf63440057218d8aeb1795287d
