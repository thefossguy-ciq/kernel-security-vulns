{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nubifs: ubifs_releasepage: Remove ubifs_assert(0) to valid this process\n\nThere are two states for ubifs writing pages:\n1. Dirty, Private\n2. Not Dirty, Not Private\n\nThe normal process cannot go to ubifs_releasepage() which means there\nexists pages being private but not dirty. Reproducer[1] shows that it\ncould occur (which maybe related to [2]) with following process:\n\n     PA                     PB                    PC\nlock(page)[PA]\nubifs_write_end\n  attach_page_private         // set Private\n  __set_page_dirty_nobuffers  // set Dirty\nunlock(page)\n\nwrite_cache_pages[PA]\n  lock(page)\n  clear_page_dirty_for_io(page)\t// clear Dirty\n  ubifs_writepage\n\n                        do_truncation[PB]\n\t\t\t  truncate_setsize\n\t\t\t    i_size_write(inode, newsize) // newsize = 0\n\n    i_size = i_size_read(inode)\t// i_size = 0\n    end_index = i_size >> PAGE_SHIFT\n    if (page->index > end_index)\n      goto out // jump\nout:\nunlock(page)   // Private, Not Dirty\n\n\t\t\t\t\t\tgeneric_fadvise[PC]\n\t\t\t\t\t\t  lock(page)\n\t\t\t\t\t\t  invalidate_inode_page\n\t\t\t\t\t\t    try_to_release_page\n\t\t\t\t\t\t      ubifs_releasepage\n\t\t\t\t\t\t        ubifs_assert(c, 0)\n\t\t                                        // bad assertion!\n\t\t\t\t\t\t  unlock(page)\n\t\t\t  truncate_pagecache[PB]\n\nThen we may get following assertion failed:\n  UBIFS error (ubi0:0 pid 1683): ubifs_assert_failed [ubifs]:\n  UBIFS assert failed: 0, in fs/ubifs/file.c:1513\n  UBIFS warning (ubi0:0 pid 1683): ubifs_ro_mode [ubifs]:\n  switched to read-only mode, error -22\n  CPU: 2 PID: 1683 Comm: aa Not tainted 5.16.0-rc5-00184-g0bca5994cacc-dirty #308\n  Call Trace:\n    dump_stack+0x13/0x1b\n    ubifs_ro_mode+0x54/0x60 [ubifs]\n    ubifs_assert_failed+0x4b/0x80 [ubifs]\n    ubifs_releasepage+0x67/0x1d0 [ubifs]\n    try_to_release_page+0x57/0xe0\n    invalidate_inode_page+0xfb/0x130\n    __invalidate_mapping_pages+0xb9/0x280\n    invalidate_mapping_pagevec+0x12/0x20\n    generic_fadvise+0x303/0x3c0\n    ksys_fadvise64_64+0x4c/0xb0\n\n[1] https://bugzilla.kernel.org/show_bug.cgi?id=215373\n[2] https://linux-mtd.infradead.narkive.com/NQoBeT1u/patch-rfc-ubifs-fix-assert-failed-in-ubifs-set-page-dirty"
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/ubifs/file.c"
               ],
               "versions": [
                  {
                     "version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d",
                     "lessThan": "7750be5d3e18500b454714677463b500a0b8b0d8",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d",
                     "lessThan": "bd188ff1c8a1935c93a1e3cacf3be62667fdf762",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "1e51764a3c2ac05a23a22b2a95ddee4d9bffb16d",
                     "lessThan": "66f4742e93523ab2f062d9d9828b3e590bc61536",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "fs/ubifs/file.c"
               ],
               "versions": [
                  {
                     "version": "2.6.27",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "2.6.27",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.18",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.2.5",
                     "lessThanOrEqual": "6.2.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.3",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "2.6.27",
                           "versionEndExcluding": "6.1.18"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "2.6.27",
                           "versionEndExcluding": "6.2.5"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "2.6.27",
                           "versionEndExcluding": "6.3"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/7750be5d3e18500b454714677463b500a0b8b0d8"
            },
            {
               "url": "https://git.kernel.org/stable/c/bd188ff1c8a1935c93a1e3cacf3be62667fdf762"
            },
            {
               "url": "https://git.kernel.org/stable/c/66f4742e93523ab2f062d9d9828b3e590bc61536"
            }
         ],
         "title": "ubifs: ubifs_releasepage: Remove ubifs_assert(0) to valid this process",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-53584",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
