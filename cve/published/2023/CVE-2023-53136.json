{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\naf_unix: fix struct pid leaks in OOB support\n\nsyzbot reported struct pid leak [1].\n\nIssue is that queue_oob() calls maybe_add_creds() which potentially\nholds a reference on a pid.\n\nBut skb->destructor is not set (either directly or by calling\nunix_scm_to_skb())\n\nThis means that subsequent kfree_skb() or consume_skb() would leak\nthis reference.\n\nIn this fix, I chose to fully support scm even for the OOB message.\n\n[1]\nBUG: memory leak\nunreferenced object 0xffff8881053e7f80 (size 128):\ncomm \"syz-executor242\", pid 5066, jiffies 4294946079 (age 13.220s)\nhex dump (first 32 bytes):\n01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................\n00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................\nbacktrace:\n[<ffffffff812ae26a>] alloc_pid+0x6a/0x560 kernel/pid.c:180\n[<ffffffff812718df>] copy_process+0x169f/0x26c0 kernel/fork.c:2285\n[<ffffffff81272b37>] kernel_clone+0xf7/0x610 kernel/fork.c:2684\n[<ffffffff812730cc>] __do_sys_clone+0x7c/0xb0 kernel/fork.c:2825\n[<ffffffff849ad699>] do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n[<ffffffff849ad699>] do_syscall_64+0x39/0xb0 arch/x86/entry/common.c:80\n[<ffffffff84a0008b>] entry_SYSCALL_64_after_hwframe+0x63/0xcd"
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/unix/af_unix.c"
               ],
               "versions": [
                  {
                     "version": "314001f0bf927015e459c9d387d62a231fe93af3",
                     "lessThan": "f3969427fb06a2c3cd6efd7faab63505cfa76e76",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "314001f0bf927015e459c9d387d62a231fe93af3",
                     "lessThan": "ac1968ac399205fda9ee3b18f7de7416cb3a5d0d",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "314001f0bf927015e459c9d387d62a231fe93af3",
                     "lessThan": "a59d6306263c38e5c0592ea4451ca26a0778c947",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "314001f0bf927015e459c9d387d62a231fe93af3",
                     "lessThan": "2aab4b96900272885bc157f8b236abf1cdc02e08",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/unix/af_unix.c"
               ],
               "versions": [
                  {
                     "version": "5.15",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.15",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.103",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.20",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.2.7",
                     "lessThanOrEqual": "6.2.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.3",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/f3969427fb06a2c3cd6efd7faab63505cfa76e76"
            },
            {
               "url": "https://git.kernel.org/stable/c/ac1968ac399205fda9ee3b18f7de7416cb3a5d0d"
            },
            {
               "url": "https://git.kernel.org/stable/c/a59d6306263c38e5c0592ea4451ca26a0778c947"
            },
            {
               "url": "https://git.kernel.org/stable/c/2aab4b96900272885bc157f8b236abf1cdc02e08"
            }
         ],
         "title": "af_unix: fix struct pid leaks in OOB support",
         "x_generator": {
            "engine": "bippy-1.1.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-53136",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
