{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nPCI: Fix dropping valid root bus resources with .end = zero\n\nOn r8a7791/koelsch:\n\n  kmemleak: 1 new suspected memory leaks (see /sys/kernel/debug/kmemleak)\n  # cat /sys/kernel/debug/kmemleak\n  unreferenced object 0xc3a34e00 (size 64):\n    comm \"swapper/0\", pid 1, jiffies 4294937460 (age 199.080s)\n    hex dump (first 32 bytes):\n      b4 5d 81 f0 b4 5d 81 f0 c0 b0 a2 c3 00 00 00 00  .]...]..........\n      00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................\n    backtrace:\n      [<fe3aa979>] __kmalloc+0xf0/0x140\n      [<34bd6bc0>] resource_list_create_entry+0x18/0x38\n      [<767046bc>] pci_add_resource_offset+0x20/0x68\n      [<b3f3edf2>] devm_of_pci_get_host_bridge_resources.constprop.0+0xb0/0x390\n\nWhen coalescing two resources for a contiguous aperture, the second\nresource is enlarged to cover the full contiguous range, while the first\nresource is marked invalid.  This invalidation is done by clearing the\nflags, start, and end members.\n\nWhen adding the initial resources to the bus later, invalid resources are\nskipped.  Unfortunately, the check for an invalid resource considers only\nthe end member, causing false positives.\n\nE.g. on r8a7791/koelsch, root bus resource 0 (\"bus 00\") is skipped, and no\nlonger registered with pci_bus_insert_busn_res() (causing the memory leak),\nnor printed:\n\n   pci-rcar-gen2 ee090000.pci: host bridge /soc/pci@ee090000 ranges:\n   pci-rcar-gen2 ee090000.pci:      MEM 0x00ee080000..0x00ee08ffff -> 0x00ee080000\n   pci-rcar-gen2 ee090000.pci: PCI: revision 11\n   pci-rcar-gen2 ee090000.pci: PCI host bridge to bus 0000:00\n  -pci_bus 0000:00: root bus resource [bus 00]\n   pci_bus 0000:00: root bus resource [mem 0xee080000-0xee08ffff]\n\nFix this by only skipping resources where all of the flags, start, and end\nmembers are zero."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/pci/probe.c"
               ],
               "versions": [
                  {
                     "version": "fd168b7d1d7cfc61cea561b1e3cc47aefc9e8f19",
                     "lessThan": "e4af080f3ef6a65b0d702988c2471a47c9ae2cc0",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "7c3855c423b17f6ca211858afb0cef20569914c7",
                     "lessThan": "fe6a1fbe83f5b23d7db93596b793561230f06b40",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "7c3855c423b17f6ca211858afb0cef20569914c7",
                     "lessThan": "7e6f2714d93cdf977b6124a80af2cf0e14e2d407",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "7c3855c423b17f6ca211858afb0cef20569914c7",
                     "lessThan": "9d8ba74a181b1c81def21168795ed96cbe6f05ed",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/pci/probe.c"
               ],
               "versions": [
                  {
                     "version": "5.16",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.16",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.16",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.2.3",
                     "lessThanOrEqual": "6.2.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.3",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.16",
                           "versionEndExcluding": "6.1.16"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.16",
                           "versionEndExcluding": "6.2.3"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.16",
                           "versionEndExcluding": "6.3"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/e4af080f3ef6a65b0d702988c2471a47c9ae2cc0"
            },
            {
               "url": "https://git.kernel.org/stable/c/fe6a1fbe83f5b23d7db93596b793561230f06b40"
            },
            {
               "url": "https://git.kernel.org/stable/c/7e6f2714d93cdf977b6124a80af2cf0e14e2d407"
            },
            {
               "url": "https://git.kernel.org/stable/c/9d8ba74a181b1c81def21168795ed96cbe6f05ed"
            }
         ],
         "title": "PCI: Fix dropping valid root bus resources with .end = zero",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-53814",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
