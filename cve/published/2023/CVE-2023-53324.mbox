From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53324: drm/msm/mdp5: Don't leak some plane state
Message-Id: <2025091644-CVE-2023-53324-631a@gregkh>
Content-Length: 3413
Lines: 66
X-Developer-Signature: v=1; a=openpgp-sha256; l=3480;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=O3bEMlQk0AaCB1aTBShmJMYWiJL/IZhCpJmm/z2sMgk=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBknexzcnq0/c+FJYBB7Q15orOOGf5z2t+R/rPLUdJpv2
 XXr4tyZHbEsDIJMDLJiiixftvEc3V9xSNHL0PY0zBxWJpAhDFycAjCRm+sY5kcV5PhqZJ32mM34
 N/1/FcsXj8YoboZ5qqbH6vrLGjin3Hx4X56P5fNH532iAA==
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/msm/mdp5: Don't leak some plane state

Apparently no one noticed that mdp5 plane states leak like a sieve
ever since we introduced plane_state->commit refcount a few years ago
in 21a01abbe32a ("drm/atomic: Fix freeing connector/plane state too
early by tracking commits, v3.")

Fix it by using the right helpers.

Patchwork: https://patchwork.freedesktop.org/patch/551236/

The Linux kernel CVE team has assigned CVE-2023-53324 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.15 with commit 21a01abbe32a3cbeb903378a24e504bfd9fe0648 and fixed in 4.19.295 with commit 7fc11a830b2eb07a0e3c6f917e5e636df6fc5d4c
	Issue introduced in 4.15 with commit 21a01abbe32a3cbeb903378a24e504bfd9fe0648 and fixed in 5.4.257 with commit b8a61df6f40448cf46611f7af05b00970d08d620
	Issue introduced in 4.15 with commit 21a01abbe32a3cbeb903378a24e504bfd9fe0648 and fixed in 5.10.195 with commit 815e42029f6e1e762898079f85546d6a0391ab95
	Issue introduced in 4.15 with commit 21a01abbe32a3cbeb903378a24e504bfd9fe0648 and fixed in 5.15.132 with commit c0b1eee648702e04f1005d451f9689575b7f52ed
	Issue introduced in 4.15 with commit 21a01abbe32a3cbeb903378a24e504bfd9fe0648 and fixed in 6.1.53 with commit 2965015006ef18ca96d2eab9ebe6bca884c63291
	Issue introduced in 4.15 with commit 21a01abbe32a3cbeb903378a24e504bfd9fe0648 and fixed in 6.4.16 with commit 5b0dd3a102f64996598bd1e8d8388848a7c561bc
	Issue introduced in 4.15 with commit 21a01abbe32a3cbeb903378a24e504bfd9fe0648 and fixed in 6.5.3 with commit 12dfd02cbd1a678fbd66be0c2f79d5299c4921a9
	Issue introduced in 4.15 with commit 21a01abbe32a3cbeb903378a24e504bfd9fe0648 and fixed in 6.6 with commit fd0ad3b2365c1c58aa5a761c18efc4817193beb6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53324
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/msm/disp/mdp5/mdp5_plane.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/7fc11a830b2eb07a0e3c6f917e5e636df6fc5d4c
	https://git.kernel.org/stable/c/b8a61df6f40448cf46611f7af05b00970d08d620
	https://git.kernel.org/stable/c/815e42029f6e1e762898079f85546d6a0391ab95
	https://git.kernel.org/stable/c/c0b1eee648702e04f1005d451f9689575b7f52ed
	https://git.kernel.org/stable/c/2965015006ef18ca96d2eab9ebe6bca884c63291
	https://git.kernel.org/stable/c/5b0dd3a102f64996598bd1e8d8388848a7c561bc
	https://git.kernel.org/stable/c/12dfd02cbd1a678fbd66be0c2f79d5299c4921a9
	https://git.kernel.org/stable/c/fd0ad3b2365c1c58aa5a761c18efc4817193beb6
