{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nxen: speed up grant-table reclaim\n\nWhen a grant entry is still in use by the remote domain, Linux must put\nit on a deferred list.  Normally, this list is very short, because\nthe PV network and block protocols expect the backend to unmap the grant\nfirst.  However, Qubes OS's GUI protocol is subject to the constraints\nof the X Window System, and as such winds up with the frontend unmapping\nthe window first.  As a result, the list can grow very large, resulting\nin a massive memory leak and eventual VM freeze.\n\nTo partially solve this problem, make the number of entries that the VM\nwill attempt to free at each iteration tunable.  The default is still\n10, but it can be overridden via a module parameter.\n\nThis is Cc: stable because (when combined with appropriate userspace\nchanges) it fixes a severe performance and stability problem for Qubes\nOS users."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "Documentation/ABI/testing/sysfs-module",
                  "drivers/xen/grant-table.c"
               ],
               "versions": [
                  {
                     "version": "569ca5b3f94cd0b3295ec5943aa457cf4a4f6a3a",
                     "lessThan": "cd1a8952ff529adc210e62306849fd6f256608c0",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "569ca5b3f94cd0b3295ec5943aa457cf4a4f6a3a",
                     "lessThan": "c76d96c555895ac602c1587b001e5cf656abc371",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "569ca5b3f94cd0b3295ec5943aa457cf4a4f6a3a",
                     "lessThan": "c04e9894846c663f3278a414f34416e6e45bbe68",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "Documentation/ABI/testing/sysfs-module",
                  "drivers/xen/grant-table.c"
               ],
               "versions": [
                  {
                     "version": "3.5",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "3.5",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.43",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.4.8",
                     "lessThanOrEqual": "6.4.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.5",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.5",
                           "versionEndExcluding": "6.1.43"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.5",
                           "versionEndExcluding": "6.4.8"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "3.5",
                           "versionEndExcluding": "6.5"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/cd1a8952ff529adc210e62306849fd6f256608c0"
            },
            {
               "url": "https://git.kernel.org/stable/c/c76d96c555895ac602c1587b001e5cf656abc371"
            },
            {
               "url": "https://git.kernel.org/stable/c/c04e9894846c663f3278a414f34416e6e45bbe68"
            }
         ],
         "title": "xen: speed up grant-table reclaim",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-54081",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
