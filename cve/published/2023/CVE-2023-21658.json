{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "memstick: fix memory leak if card device is never registered\n\nWhen calling dev_set_name() memory is allocated for the name for the\nstruct device.  Once that structure device is registered, or attempted\nto be registerd, with the driver core, the driver core will handle\ncleaning up that memory when the device is removed from the system.\n\nUnfortunatly for the memstick code, there is an error path that causes\nthe struct device to never be registered, and so the memory allocated in\ndev_set_name will be leaked.  Fix that leak by manually freeing it right\nbefore the memory for the device is freed."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "versions": [
                  {
                     "version": "2.6.29",
                     "lessThan": "4.14.314",
                     "status": "affected",
                     "versionType": "custom"
                  },
                  {
                     "version": "2.6.29",
                     "lessThan": "4.19.282",
                     "status": "affected",
                     "versionType": "custom"
                  },
                  {
                     "version": "2.6.29",
                     "lessThan": "5.4.242",
                     "status": "affected",
                     "versionType": "custom"
                  },
                  {
                     "version": "2.6.29",
                     "lessThan": "5.10.179",
                     "status": "affected",
                     "versionType": "custom"
                  },
                  {
                     "version": "2.6.29",
                     "lessThan": "5.15.109",
                     "status": "affected",
                     "versionType": "custom"
                  },
                  {
                     "version": "2.6.29",
                     "lessThan": "6.1.26",
                     "status": "affected",
                     "versionType": "custom"
                  },
                  {
                     "version": "2.6.29",
                     "lessThan": "6.2.13",
                     "status": "affected",
                     "versionType": "custom"
                  },
                  {
                     "version": "2.6.29",
                     "lessThan": "6.3",
                     "status": "affected",
                     "versionType": "custom"
                  },
                  {
                     "version": "0252c3b4f018",
                     "lessThan": "052d22bf5453",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0252c3b4f018",
                     "lessThan": "70ae89da72f3",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0252c3b4f018",
                     "lessThan": "1b8b54fc55a4",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0252c3b4f018",
                     "lessThan": "e10a6d88ae9b",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0252c3b4f018",
                     "lessThan": "ebab1a86ca3e",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0252c3b4f018",
                     "lessThan": "a3a93b46833f",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0252c3b4f018",
                     "lessThan": "d299776014ba",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "0252c3b4f018",
                     "lessThan": "4b6d621c9d85",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/linux/c/052d22bf5453"
            },
            {
               "url": "https://git.kernel.org/stable/linux/c/70ae89da72f3"
            },
            {
               "url": "https://git.kernel.org/stable/linux/c/1b8b54fc55a4"
            },
            {
               "url": "https://git.kernel.org/stable/linux/c/e10a6d88ae9b"
            },
            {
               "url": "https://git.kernel.org/stable/linux/c/ebab1a86ca3e"
            },
            {
               "url": "https://git.kernel.org/stable/linux/c/a3a93b46833f"
            },
            {
               "url": "https://git.kernel.org/stable/linux/c/d299776014ba"
            },
            {
               "url": "https://git.kernel.org/stable/linux/c/4b6d621c9d85"
            }
         ],
         "title": "memstick: fix memory leak if card device is never registered",
         "x_generator": {
            "engine": "bippy-989a34f9de21"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-21658",
      "requesterUserId": "gregkh@linuxfoundation.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
