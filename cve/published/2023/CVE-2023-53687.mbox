From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53687: tty: serial: samsung_tty: Fix a memory leak in s3c24xx_serial_getclk() when iterating clk

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

tty: serial: samsung_tty: Fix a memory leak in s3c24xx_serial_getclk() when iterating clk

When the best clk is searched, we iterate over all possible clk.

If we find a better match, the previous one, if any, needs to be freed.
If a better match has already been found, we still need to free the new
one, otherwise it leaks.

The Linux kernel CVE team has assigned CVE-2023-53687 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.3 with commit 5f5a7a5578c5885201cf9c85856f023fe8b81765 and fixed in 4.14.322 with commit 933e5b2998bc3a527d15efbf1e97c9e63297aa3c
	Issue introduced in 3.3 with commit 5f5a7a5578c5885201cf9c85856f023fe8b81765 and fixed in 4.19.291 with commit 01dd8a43a84616c830782166ba3cceb01ad95363
	Issue introduced in 3.3 with commit 5f5a7a5578c5885201cf9c85856f023fe8b81765 and fixed in 5.4.251 with commit 46574e5a0a2aee41e6ebb979cfe1dbaea8693e16
	Issue introduced in 3.3 with commit 5f5a7a5578c5885201cf9c85856f023fe8b81765 and fixed in 5.10.188 with commit 1962717c4649e026a4252fe6625175affd28a593
	Issue introduced in 3.3 with commit 5f5a7a5578c5885201cf9c85856f023fe8b81765 and fixed in 5.15.121 with commit 9dd8091959bc41fee51d0827276a2b982e84adf0
	Issue introduced in 3.3 with commit 5f5a7a5578c5885201cf9c85856f023fe8b81765 and fixed in 6.1.40 with commit f0bf102ef9b05d7294bd8d506755465f6867d944
	Issue introduced in 3.3 with commit 5f5a7a5578c5885201cf9c85856f023fe8b81765 and fixed in 6.4.5 with commit 1f426293fef1c13742b2a685bf7e363f51f6ee03
	Issue introduced in 3.3 with commit 5f5a7a5578c5885201cf9c85856f023fe8b81765 and fixed in 6.5 with commit 832e231cff476102e8204a9e7bddfe5c6154a375

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53687
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/tty/serial/samsung_tty.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/933e5b2998bc3a527d15efbf1e97c9e63297aa3c
	https://git.kernel.org/stable/c/01dd8a43a84616c830782166ba3cceb01ad95363
	https://git.kernel.org/stable/c/46574e5a0a2aee41e6ebb979cfe1dbaea8693e16
	https://git.kernel.org/stable/c/1962717c4649e026a4252fe6625175affd28a593
	https://git.kernel.org/stable/c/9dd8091959bc41fee51d0827276a2b982e84adf0
	https://git.kernel.org/stable/c/f0bf102ef9b05d7294bd8d506755465f6867d944
	https://git.kernel.org/stable/c/1f426293fef1c13742b2a685bf7e363f51f6ee03
	https://git.kernel.org/stable/c/832e231cff476102e8204a9e7bddfe5c6154a375
