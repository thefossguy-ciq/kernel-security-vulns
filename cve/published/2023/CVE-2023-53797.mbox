From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53797: HID: wacom: Use ktime_t rather than int when dealing with timestamps

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

HID: wacom: Use ktime_t rather than int when dealing with timestamps

Code which interacts with timestamps needs to use the ktime_t type
returned by functions like ktime_get. The int type does not offer
enough space to store these values, and attempting to use it is a
recipe for problems. In this particular case, overflows would occur
when calculating/storing timestamps leading to incorrect values being
reported to userspace. In some cases these bad timestamps cause input
handling in userspace to appear hung.

The Linux kernel CVE team has assigned CVE-2023-53797 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4.243 with commit f9e27d4bdb1fe257c1453d02560e3adc3e5b6023 and fixed in 5.4.251 with commit 99036f1aed7e82773904f5d91a9897bb3e507fd9
	Issue introduced in 5.10.180 with commit 4502ebbdc0e21e44a8a706428e420ae9c1bb9bba and fixed in 5.10.188 with commit 9598a647ecc8f300b0540abf9d3b3439859d163b
	Issue introduced in 5.15.112 with commit 5047a228d4c8e2b5d1b856f21a00ecf717945a9c and fixed in 5.15.120 with commit 67ce7724637c6adb66f788677cb50b82615de0ac
	Issue introduced in 6.1.29 with commit fb98336e23c11e9c8c7dd5425ec71adbbef7f773 and fixed in 6.1.37 with commit d89750b19681581796dfbe3689bbb5d439b99b24
	Issue introduced in 6.3.3 with commit 694d3e4387bfa69925e075053894385351106e64 and fixed in 6.3.11 with commit bdeaa883b765709f231f47f9d6cc76c837a15396
	Issue introduced in 6.4 with commit 17d793f3ed53080dab6bbeabfc82de890c901001 and fixed in 6.4.1 with commit d0198363f9108e4adb2511e607ba91e44779e8b1
	Issue introduced in 6.4 with commit 17d793f3ed53080dab6bbeabfc82de890c901001 and fixed in 6.5 with commit 9a6c0e28e215535b2938c61ded54603b4e5814c5
	Issue introduced in 6.2.16 with commit 82a136c35506dc788a6c03ffeb11b10c907b0e26

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53797
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/hid/wacom_wac.c
	drivers/hid/wacom_wac.h


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/99036f1aed7e82773904f5d91a9897bb3e507fd9
	https://git.kernel.org/stable/c/9598a647ecc8f300b0540abf9d3b3439859d163b
	https://git.kernel.org/stable/c/67ce7724637c6adb66f788677cb50b82615de0ac
	https://git.kernel.org/stable/c/d89750b19681581796dfbe3689bbb5d439b99b24
	https://git.kernel.org/stable/c/bdeaa883b765709f231f47f9d6cc76c837a15396
	https://git.kernel.org/stable/c/d0198363f9108e4adb2511e607ba91e44779e8b1
	https://git.kernel.org/stable/c/9a6c0e28e215535b2938c61ded54603b4e5814c5
