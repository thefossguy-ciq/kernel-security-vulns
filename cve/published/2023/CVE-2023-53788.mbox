From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53788: ALSA: hda/ca0132: fixup buffer overrun at tuning_ctl_set()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ALSA: hda/ca0132: fixup buffer overrun at tuning_ctl_set()

tuning_ctl_set() might have buffer overrun at (X) if it didn't break
from loop by matching (A).

	static int tuning_ctl_set(...)
	{
		for (i = 0; i < TUNING_CTLS_COUNT; i++)
(A)			if (nid == ca0132_tuning_ctls[i].nid)
				break;

		snd_hda_power_up(...);
(X)		dspio_set_param(..., ca0132_tuning_ctls[i].mid, ...);
		snd_hda_power_down(...);                ^

		return 1;
	}

We will get below error by cppcheck

	sound/pci/hda/patch_ca0132.c:4229:2: note: After for loop, i has value 12
	 for (i = 0; i < TUNING_CTLS_COUNT; i++)
	 ^
	sound/pci/hda/patch_ca0132.c:4234:43: note: Array index out of bounds
	 dspio_set_param(codec, ca0132_tuning_ctls[i].mid, 0x20,
	                                           ^
This patch cares non match case.

The Linux kernel CVE team has assigned CVE-2023-53788 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.9 with commit 44f0c9782cc6ab71ea947f8f710a46f2078a151c and fixed in 4.14.312 with commit ff5e8b49348f6a550c136b74efaf8b3c1d3ceaea
	Issue introduced in 3.9 with commit 44f0c9782cc6ab71ea947f8f710a46f2078a151c and fixed in 4.19.280 with commit 3590498117a11aa1f92a97e8a04d95320e347ebd
	Issue introduced in 3.9 with commit 44f0c9782cc6ab71ea947f8f710a46f2078a151c and fixed in 5.4.240 with commit 7f12f99b8017ad5ed5aff4b0aefe3bb7bbdf8a99
	Issue introduced in 3.9 with commit 44f0c9782cc6ab71ea947f8f710a46f2078a151c and fixed in 5.10.177 with commit baef27176ea5fdc7ad0947e2dc7733855e35db71
	Issue introduced in 3.9 with commit 44f0c9782cc6ab71ea947f8f710a46f2078a151c and fixed in 5.15.106 with commit d23f65f08247068576a01e28b297e995b7dc3965
	Issue introduced in 3.9 with commit 44f0c9782cc6ab71ea947f8f710a46f2078a151c and fixed in 6.1.23 with commit 32854bc91ae7debcdefdc7ae881ed83385a04792
	Issue introduced in 3.9 with commit 44f0c9782cc6ab71ea947f8f710a46f2078a151c and fixed in 6.2.10 with commit 734a3deb6614e3597e7e9ef7fb6006c593c5ee18
	Issue introduced in 3.9 with commit 44f0c9782cc6ab71ea947f8f710a46f2078a151c and fixed in 6.3 with commit 98e5eb110095ec77cb6d775051d181edbf9cd3cf

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53788
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	sound/pci/hda/patch_ca0132.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ff5e8b49348f6a550c136b74efaf8b3c1d3ceaea
	https://git.kernel.org/stable/c/3590498117a11aa1f92a97e8a04d95320e347ebd
	https://git.kernel.org/stable/c/7f12f99b8017ad5ed5aff4b0aefe3bb7bbdf8a99
	https://git.kernel.org/stable/c/baef27176ea5fdc7ad0947e2dc7733855e35db71
	https://git.kernel.org/stable/c/d23f65f08247068576a01e28b297e995b7dc3965
	https://git.kernel.org/stable/c/32854bc91ae7debcdefdc7ae881ed83385a04792
	https://git.kernel.org/stable/c/734a3deb6614e3597e7e9ef7fb6006c593c5ee18
	https://git.kernel.org/stable/c/98e5eb110095ec77cb6d775051d181edbf9cd3cf
