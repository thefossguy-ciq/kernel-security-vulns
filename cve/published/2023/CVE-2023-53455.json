{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrm/vc4: drop all currently held locks if deadlock happens\n\nIf vc4_hdmi_reset_link() returns -EDEADLK, it means that a deadlock\nhappened in the locking context. This situation should be addressed by\ndropping all currently held locks and block until the contended lock\nbecomes available. Currently, vc4 is not dealing with the deadlock\nproperly, producing the following output when PROVE_LOCKING is enabled:\n\n[  825.612809] ------------[ cut here ]------------\n[  825.612852] WARNING: CPU: 1 PID: 116 at drivers/gpu/drm/drm_modeset_lock.c:276 drm_modeset_drop_locks+0x60/0x68 [drm]\n[  825.613458] Modules linked in: 8021q mrp garp stp llc\nraspberrypi_cpufreq brcmfmac brcmutil crct10dif_ce hci_uart cfg80211\nbtqca btbcm bluetooth vc4 raspberrypi_hwmon snd_soc_hdmi_codec cec\nclk_raspberrypi ecdh_generic drm_display_helper ecc rfkill\ndrm_dma_helper drm_kms_helper pwm_bcm2835 bcm2835_thermal bcm2835_rng\nrng_core i2c_bcm2835 drm fuse ip_tables x_tables ipv6\n[  825.613735] CPU: 1 PID: 116 Comm: kworker/1:2 Tainted: G        W 6.1.0-rc6-01399-g941aae326315 #3\n[  825.613759] Hardware name: Raspberry Pi 3 Model B Rev 1.2 (DT)\n[  825.613777] Workqueue: events output_poll_execute [drm_kms_helper]\n[  825.614038] pstate: 60000005 (nZCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\n[  825.614063] pc : drm_modeset_drop_locks+0x60/0x68 [drm]\n[  825.614603] lr : drm_helper_probe_detect+0x120/0x1b4 [drm_kms_helper]\n[  825.614829] sp : ffff800008313bf0\n[  825.614844] x29: ffff800008313bf0 x28: ffffcd7778b8b000 x27: 0000000000000000\n[  825.614883] x26: 0000000000000001 x25: 0000000000000001 x24: ffff677cc35c2758\n[  825.614920] x23: ffffcd7707d01430 x22: ffffcd7707c3edc7 x21: 0000000000000001\n[  825.614958] x20: 0000000000000000 x19: ffff800008313c10 x18: 000000000000b6d3\n[  825.614995] x17: ffffcd777835e214 x16: ffffcd7777cef870 x15: fffff81000000000\n[  825.615033] x14: 0000000000000000 x13: 0000000000000099 x12: 0000000000000002\n[  825.615070] x11: 72917988020af800 x10: 72917988020af800 x9 : 72917988020af800\n[  825.615108] x8 : ffff677cc665e0a8 x7 : d00a8c180000110c x6 : ffffcd77774c0054\n[  825.615145] x5 : 0000000000000000 x4 : 0000000000000001 x3 : 0000000000000000\n[  825.615181] x2 : ffff677cc55e1880 x1 : ffffcd7777cef8ec x0 : ffff800008313c10\n[  825.615219] Call trace:\n[  825.615232]  drm_modeset_drop_locks+0x60/0x68 [drm]\n[  825.615773]  drm_helper_probe_detect+0x120/0x1b4 [drm_kms_helper]\n[  825.616003]  output_poll_execute+0xe4/0x224 [drm_kms_helper]\n[  825.616233]  process_one_work+0x2b4/0x618\n[  825.616264]  worker_thread+0x24c/0x464\n[  825.616288]  kthread+0xec/0x110\n[  825.616310]  ret_from_fork+0x10/0x20\n[  825.616335] irq event stamp: 7634\n[  825.616349] hardirqs last  enabled at (7633): [<ffffcd777831ee90>] _raw_spin_unlock_irq+0x3c/0x78\n[  825.616384] hardirqs last disabled at (7634): [<ffffcd7778315a78>] __schedule+0x134/0x9f0\n[  825.616411] softirqs last  enabled at (7630): [<ffffcd7707aacea0>] local_bh_enable+0x4/0x30 [ipv6]\n[  825.617019] softirqs last disabled at (7618): [<ffffcd7707aace70>] local_bh_disable+0x4/0x30 [ipv6]\n[  825.617586] ---[ end trace 0000000000000000 ]---\n\nTherefore, deal with the deadlock as suggested by [1], using the\nfunction drm_modeset_backoff().\n\n[1] https://docs.kernel.org/gpu/drm-kms.html?highlight=kms#kms-locking"
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/gpu/drm/vc4/vc4_hdmi.c"
               ],
               "versions": [
                  {
                     "version": "6bed2ea3cb3856edf37cca20753e689ee8774793",
                     "lessThan": "41286a53e7f54202fd277cd516724de3ab7497c7",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "6bed2ea3cb3856edf37cca20753e689ee8774793",
                     "lessThan": "f483eda89a2e717daa7b15c8ca228a209f65617b",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "6bed2ea3cb3856edf37cca20753e689ee8774793",
                     "lessThan": "479d4f0be4237ba33bc9432787aeb62c90e30f95",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/gpu/drm/vc4/vc4_hdmi.c"
               ],
               "versions": [
                  {
                     "version": "6.1",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.1",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.16",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.2.3",
                     "lessThanOrEqual": "6.2.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.3",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1",
                           "versionEndExcluding": "6.1.16"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1",
                           "versionEndExcluding": "6.2.3"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.1",
                           "versionEndExcluding": "6.3"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/41286a53e7f54202fd277cd516724de3ab7497c7"
            },
            {
               "url": "https://git.kernel.org/stable/c/f483eda89a2e717daa7b15c8ca228a209f65617b"
            },
            {
               "url": "https://git.kernel.org/stable/c/479d4f0be4237ba33bc9432787aeb62c90e30f95"
            }
         ],
         "title": "drm/vc4: drop all currently held locks if deadlock happens",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-53455",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
