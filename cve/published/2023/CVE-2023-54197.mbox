From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-54197: Revert "Bluetooth: btsdio: fix use after free bug in btsdio_remove due to unfinished work"

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

Revert "Bluetooth: btsdio: fix use after free bug in btsdio_remove due to unfinished work"

This reverts commit 1e9ac114c4428fdb7ff4635b45d4f46017e8916f.

This patch introduces a possible null-ptr-def problem. Revert it. And the
fixed bug by this patch have resolved by commit 73f7b171b7c0 ("Bluetooth:
btsdio: fix use after free bug in btsdio_remove due to race condition").

The Linux kernel CVE team has assigned CVE-2023-54197 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.14.312 with commit 95eacef5692545f199fae4e52abfbfa273acb351 and fixed in 4.14.315 with commit 3b4ed52009723f7dfca7a8ca95163bfb441bfb76
	Issue introduced in 4.19.280 with commit af4d48754d5517d33bac5e504ff1f1de0808e29e and fixed in 4.19.283 with commit 70a104588e3131415e559c06deb834ce259a285a
	Issue introduced in 5.4.240 with commit a18fb433ceb56e0787546a9d77056dd0f215e762 and fixed in 5.4.243 with commit de0ffb5145c9f418ad76f00e58d4b91c680410b2
	Issue introduced in 5.10.177 with commit da3d3fdfb4d523c5da30e35a8dd90e04f0fd8962 and fixed in 5.10.180 with commit 0837d10f6c37a47a0c73bccf1e39513613a2fcc2
	Issue introduced in 5.15.105 with commit 8efae2112d910d8e5166dd0a836791b08721eef1 and fixed in 5.15.111 with commit a789192f366147a0fbb395650079906d1d04e0b9
	Issue introduced in 6.1.22 with commit cbf8deacb7053ce3e3fed64b277c6c6989e65bba and fixed in 6.1.28 with commit 952030c914b5f2288609efe868537afcff7a3f51
	Issue introduced in 6.2.9 with commit c59c65a14e8f7d738429648833f3bb3f9df0513f and fixed in 6.2.15 with commit 8f83fa62614c282dd5d1211a0dd99c6a0a515b81
	Issue introduced in 6.3 with commit 1e9ac114c4428fdb7ff4635b45d4f46017e8916f and fixed in 6.3.2 with commit d8d7ce037d9a8f1f0714ece268c4c2c50845bbc3
	Issue introduced in 6.3 with commit 1e9ac114c4428fdb7ff4635b45d4f46017e8916f and fixed in 6.4 with commit db2bf510bd5d57f064d9e1db395ed86a08320c54

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-54197
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/bluetooth/btsdio.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/3b4ed52009723f7dfca7a8ca95163bfb441bfb76
	https://git.kernel.org/stable/c/70a104588e3131415e559c06deb834ce259a285a
	https://git.kernel.org/stable/c/de0ffb5145c9f418ad76f00e58d4b91c680410b2
	https://git.kernel.org/stable/c/0837d10f6c37a47a0c73bccf1e39513613a2fcc2
	https://git.kernel.org/stable/c/a789192f366147a0fbb395650079906d1d04e0b9
	https://git.kernel.org/stable/c/952030c914b5f2288609efe868537afcff7a3f51
	https://git.kernel.org/stable/c/8f83fa62614c282dd5d1211a0dd99c6a0a515b81
	https://git.kernel.org/stable/c/d8d7ce037d9a8f1f0714ece268c4c2c50845bbc3
	https://git.kernel.org/stable/c/db2bf510bd5d57f064d9e1db395ed86a08320c54
