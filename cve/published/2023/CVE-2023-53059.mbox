From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53059: platform/chrome: cros_ec_chardev: fix kernel data leak from ioctl

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

platform/chrome: cros_ec_chardev: fix kernel data leak from ioctl

It is possible to peep kernel page's data by providing larger `insize`
in struct cros_ec_command[1] when invoking EC host commands.

Fix it by using zeroed memory.

[1]: https://elixir.bootlin.com/linux/v6.2/source/include/linux/platform_data/cros_ec_proto.h#L74

The Linux kernel CVE team has assigned CVE-2023-53059 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4 with commit eda2e30c6684d67288edb841c6125d48c608a242 and fixed in 5.4.240 with commit 13493ad6a220cb3f6f3552a16b4f2753a118b633
	Issue introduced in 5.4 with commit eda2e30c6684d67288edb841c6125d48c608a242 and fixed in 5.10.177 with commit f86ff88a1548ccf5a13960c0e7625ca787ea0993
	Issue introduced in 5.4 with commit eda2e30c6684d67288edb841c6125d48c608a242 and fixed in 5.15.105 with commit ebea2e16504f40d2c2bac42ad5c5a3de5ce034b4
	Issue introduced in 5.4 with commit eda2e30c6684d67288edb841c6125d48c608a242 and fixed in 6.1.22 with commit eab28bfafcd1245a3510df9aa9eb940589956ea6
	Issue introduced in 5.4 with commit eda2e30c6684d67288edb841c6125d48c608a242 and fixed in 6.2.9 with commit a0d8644784f73fa39f57f72f374eefaba2bf48a0
	Issue introduced in 5.4 with commit eda2e30c6684d67288edb841c6125d48c608a242 and fixed in 6.3 with commit b20cf3f89c56b5f6a38b7f76a8128bf9f291bbd3

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53059
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/platform/chrome/cros_ec_chardev.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/13493ad6a220cb3f6f3552a16b4f2753a118b633
	https://git.kernel.org/stable/c/f86ff88a1548ccf5a13960c0e7625ca787ea0993
	https://git.kernel.org/stable/c/ebea2e16504f40d2c2bac42ad5c5a3de5ce034b4
	https://git.kernel.org/stable/c/eab28bfafcd1245a3510df9aa9eb940589956ea6
	https://git.kernel.org/stable/c/a0d8644784f73fa39f57f72f374eefaba2bf48a0
	https://git.kernel.org/stable/c/b20cf3f89c56b5f6a38b7f76a8128bf9f291bbd3
