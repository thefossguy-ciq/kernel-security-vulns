From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-54110: usb: rndis_host: Secure rndis_query check against int overflow

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

usb: rndis_host: Secure rndis_query check against int overflow

Variables off and len typed as uint32 in rndis_query function
are controlled by incoming RNDIS response message thus their
value may be manipulated. Setting off to a unexpectetly large
value will cause the sum with len and 8 to overflow and pass
the implemented validation step. Consequently the response
pointer will be referring to a location past the expected
buffer boundaries allowing information leakage e.g. via
RNDIS_OID_802_3_PERMANENT_ADDRESS OID.

The Linux kernel CVE team has assigned CVE-2023-54110 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.22 with commit ddda08624013e8435e9f7cfc34a35bd7b3520b6d and fixed in 4.14.303 with commit 55782f6d63a5a3dd3b84c1e0627738fc5b146b4e
	Issue introduced in 2.6.22 with commit ddda08624013e8435e9f7cfc34a35bd7b3520b6d and fixed in 4.19.270 with commit 02ffb4ecf0614c58e3d0e5bfbe99588c9ddc77c0
	Issue introduced in 2.6.22 with commit ddda08624013e8435e9f7cfc34a35bd7b3520b6d and fixed in 5.4.229 with commit ebe6d2fcf7835f98cdbb1bd5e0414be20c321578
	Issue introduced in 2.6.22 with commit ddda08624013e8435e9f7cfc34a35bd7b3520b6d and fixed in 5.10.163 with commit 232ef345e5d76e5542f430a29658a85dbef07f0b
	Issue introduced in 2.6.22 with commit ddda08624013e8435e9f7cfc34a35bd7b3520b6d and fixed in 5.15.87 with commit 11cd4ec6359d90b13ffb8f85a9df8637f0cf8d95
	Issue introduced in 2.6.22 with commit ddda08624013e8435e9f7cfc34a35bd7b3520b6d and fixed in 6.0.19 with commit 39eadaf5611ddd064ad1c53da65c02d2b0fe22a4
	Issue introduced in 2.6.22 with commit ddda08624013e8435e9f7cfc34a35bd7b3520b6d and fixed in 6.1.5 with commit a713602807f32afc04add331410c77ef790ef77a
	Issue introduced in 2.6.22 with commit ddda08624013e8435e9f7cfc34a35bd7b3520b6d and fixed in 6.2 with commit c7dd13805f8b8fc1ce3b6d40f6aff47e66b72ad2

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-54110
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/usb/rndis_host.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/55782f6d63a5a3dd3b84c1e0627738fc5b146b4e
	https://git.kernel.org/stable/c/02ffb4ecf0614c58e3d0e5bfbe99588c9ddc77c0
	https://git.kernel.org/stable/c/ebe6d2fcf7835f98cdbb1bd5e0414be20c321578
	https://git.kernel.org/stable/c/232ef345e5d76e5542f430a29658a85dbef07f0b
	https://git.kernel.org/stable/c/11cd4ec6359d90b13ffb8f85a9df8637f0cf8d95
	https://git.kernel.org/stable/c/39eadaf5611ddd064ad1c53da65c02d2b0fe22a4
	https://git.kernel.org/stable/c/a713602807f32afc04add331410c77ef790ef77a
	https://git.kernel.org/stable/c/c7dd13805f8b8fc1ce3b6d40f6aff47e66b72ad2
