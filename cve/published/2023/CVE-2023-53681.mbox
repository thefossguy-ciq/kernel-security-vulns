From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53681: bcache: Fix __bch_btree_node_alloc to make the failure behavior consistent

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

bcache: Fix __bch_btree_node_alloc to make the failure behavior consistent

In some specific situations, the return value of __bch_btree_node_alloc
may be NULL. This may lead to a potential NULL pointer dereference in
caller function like a calling chain :
btree_split->bch_btree_node_alloc->__bch_btree_node_alloc.

Fix it by initializing the return value in __bch_btree_node_alloc.

The Linux kernel CVE team has assigned CVE-2023-53681 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.10 with commit cafe563591446cf80bfbc2fe3bc72a2e36cf1060 and fixed in 4.19.291 with commit 587b4e8bb5dac682f09280ab35db4632b29d5ac4
	Issue introduced in 3.10 with commit cafe563591446cf80bfbc2fe3bc72a2e36cf1060 and fixed in 5.4.253 with commit b070f29a61436f6f8a2e3abc7ea4f4be81695198
	Issue introduced in 3.10 with commit cafe563591446cf80bfbc2fe3bc72a2e36cf1060 and fixed in 5.10.188 with commit a4405f6ee03323410d7b10966fd67b35f71b1944
	Issue introduced in 3.10 with commit cafe563591446cf80bfbc2fe3bc72a2e36cf1060 and fixed in 5.15.121 with commit f67b0e3081f2a24170280a33ac66f6b112083c03
	Issue introduced in 3.10 with commit cafe563591446cf80bfbc2fe3bc72a2e36cf1060 and fixed in 6.1.39 with commit 7ecea5ce3dc17339c280c75b58ac93d8c8620d9f
	Issue introduced in 3.10 with commit cafe563591446cf80bfbc2fe3bc72a2e36cf1060 and fixed in 6.4.4 with commit 4514847aee18d9391a0cf3aad75d3567c72795a4
	Issue introduced in 3.10 with commit cafe563591446cf80bfbc2fe3bc72a2e36cf1060 and fixed in 6.5 with commit 80fca8a10b604afad6c14213fdfd816c4eda3ee4

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53681
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/md/bcache/btree.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/587b4e8bb5dac682f09280ab35db4632b29d5ac4
	https://git.kernel.org/stable/c/b070f29a61436f6f8a2e3abc7ea4f4be81695198
	https://git.kernel.org/stable/c/a4405f6ee03323410d7b10966fd67b35f71b1944
	https://git.kernel.org/stable/c/f67b0e3081f2a24170280a33ac66f6b112083c03
	https://git.kernel.org/stable/c/7ecea5ce3dc17339c280c75b58ac93d8c8620d9f
	https://git.kernel.org/stable/c/4514847aee18d9391a0cf3aad75d3567c72795a4
	https://git.kernel.org/stable/c/80fca8a10b604afad6c14213fdfd816c4eda3ee4
