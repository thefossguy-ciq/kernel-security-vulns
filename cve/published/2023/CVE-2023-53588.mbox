From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53588: wifi: mac80211: check for station first in client probe

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: mac80211: check for station first in client probe

When probing a client, first check if we have it, and then
check for the channel context, otherwise you can trigger
the warning there easily by probing when the AP isn't even
started yet. Since a client existing means the AP is also
operating, we can then keep the warning.

Also simplify the moved code a bit.

The Linux kernel CVE team has assigned CVE-2023-53588 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.8 with commit 55de908ab292c03f1eb280f51170ddb9c6b57e31 and fixed in 6.1.55 with commit 7e1cda5cf07f848e6b50b4e5e7761ffbce905a3d
	Issue introduced in 3.8 with commit 55de908ab292c03f1eb280f51170ddb9c6b57e31 and fixed in 6.5.5 with commit 7dce2deb0b03aaf46c87ceedea81ef4153e26c40
	Issue introduced in 3.8 with commit 55de908ab292c03f1eb280f51170ddb9c6b57e31 and fixed in 6.6 with commit 67dfa589aa8806c7959cbca2f4613b8d41c75a06

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53588
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/mac80211/cfg.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/7e1cda5cf07f848e6b50b4e5e7761ffbce905a3d
	https://git.kernel.org/stable/c/7dce2deb0b03aaf46c87ceedea81ef4153e26c40
	https://git.kernel.org/stable/c/67dfa589aa8806c7959cbca2f4613b8d41c75a06
