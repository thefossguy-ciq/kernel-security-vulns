From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-4515: ksmbd: validate command request size
Message-Id: <2025081654-CVE-2023-4515-3864@gregkh>
Content-Length: 2463
Lines: 55
X-Developer-Signature: v=1; a=openpgp-sha256; l=2519;
 i=gregkh@linuxfoundation.org; h=from:subject:message-id;
 bh=7Szh4Hkh3ukXa45uIfJpwloBXcB59a1xv5oFGVfFo8Q=;
 b=owGbwMvMwCRo6H6F97bub03G02pJDBkL2h7VNkrarZp3bd/uVdPTvgfUBt0wmlPUGBcRWLKjo
 maGceamjlgWBkEmBlkxRZYv23iO7q84pOhlaHsaZg4rE8gQBi5OAZjIu68Ms9nLvYIOX0llfBV3
 yDmYfYpX/cNTnQzzXW/Nl7XhmpN26m2za4Dykq8/zB5uAgA=
X-Developer-Key: i=gregkh@linuxfoundation.org; a=openpgp;
 fpr=F4B60CC5BF78C2214A313DCB3147D40DDB2DFB29

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ksmbd: validate command request size

In commit 2b9b8f3b68ed ("ksmbd: validate command payload size"), except
for SMB2_OPLOCK_BREAK_HE command, the request size of other commands
is not checked, it's not expected. Fix it by add check for request
size of other commands.

The Linux kernel CVE team has assigned CVE-2023-4515 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.15.121 with commit 35f450f54dca1519bb24faacd0428db09f89a11f and fixed in 5.15.127 with commit 595679098bdcdbfbba91ebe07a2f7f208df93870
	Issue introduced in 6.1.36 with commit 9650cf70ec9d94ff34daa088b643229231723c26 and fixed in 6.1.46 with commit c6bef3bc30fd4a175aef846b7d928a6c40d091cd
	Issue introduced in 6.4 with commit 2b9b8f3b68edb3d67d79962f02e26dbb5ae3808d and fixed in 6.4.11 with commit ff7236b66d69582f90cf5616e63cfc3dc18142bb
	Issue introduced in 6.4 with commit 2b9b8f3b68edb3d67d79962f02e26dbb5ae3808d and fixed in 6.5 with commit 5aa4fda5aa9c2a5a7bac67b4a12b089ab81fee3c
	Issue introduced in 6.3.10 with commit 768caf4019f0391c0b6452afe34cea1704133f7b

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-4515
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/smb/server/smb2misc.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/595679098bdcdbfbba91ebe07a2f7f208df93870
	https://git.kernel.org/stable/c/c6bef3bc30fd4a175aef846b7d928a6c40d091cd
	https://git.kernel.org/stable/c/ff7236b66d69582f90cf5616e63cfc3dc18142bb
	https://git.kernel.org/stable/c/5aa4fda5aa9c2a5a7bac67b4a12b089ab81fee3c
