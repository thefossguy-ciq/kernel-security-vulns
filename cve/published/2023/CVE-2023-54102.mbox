From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-54102: scsi: lpfc: Prevent lpfc_debugfs_lockstat_write() buffer overflow

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

scsi: lpfc: Prevent lpfc_debugfs_lockstat_write() buffer overflow

A static code analysis tool flagged the possibility of buffer overflow when
using copy_from_user() for a debugfs entry.

Currently, it is possible that copy_from_user() copies more bytes than what
would fit in the mybuf char array.  Add a min() restriction check between
sizeof(mybuf) - 1 and nbytes passed from the userspace buffer to protect
against buffer overflow.

The Linux kernel CVE team has assigned CVE-2023-54102 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.1 with commit 6a828b0f6192b4930894925d1c1d0dc1f1d99e6e and fixed in 5.4.244 with commit 644a9d5e22761a41d5005a26996a643da96de962
	Issue introduced in 5.1 with commit 6a828b0f6192b4930894925d1c1d0dc1f1d99e6e and fixed in 5.10.181 with commit e0e7faee3a7dd6f51350cda64997116a247eb045
	Issue introduced in 5.1 with commit 6a828b0f6192b4930894925d1c1d0dc1f1d99e6e and fixed in 5.15.113 with commit f91037487036e2d2f18d3c2481be6b9a366bde7f
	Issue introduced in 5.1 with commit 6a828b0f6192b4930894925d1c1d0dc1f1d99e6e and fixed in 6.1.30 with commit a9df88cb31dcbd72104ec5883f35cbc1fb587e47
	Issue introduced in 5.1 with commit 6a828b0f6192b4930894925d1c1d0dc1f1d99e6e and fixed in 6.3.4 with commit ad050f6cf681ebb850a9d4bc19474d3896476301
	Issue introduced in 5.1 with commit 6a828b0f6192b4930894925d1c1d0dc1f1d99e6e and fixed in 6.4 with commit c6087b82a9146826564a55c5ca0164cac40348f5

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-54102
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/scsi/lpfc/lpfc_debugfs.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/644a9d5e22761a41d5005a26996a643da96de962
	https://git.kernel.org/stable/c/e0e7faee3a7dd6f51350cda64997116a247eb045
	https://git.kernel.org/stable/c/f91037487036e2d2f18d3c2481be6b9a366bde7f
	https://git.kernel.org/stable/c/a9df88cb31dcbd72104ec5883f35cbc1fb587e47
	https://git.kernel.org/stable/c/ad050f6cf681ebb850a9d4bc19474d3896476301
	https://git.kernel.org/stable/c/c6087b82a9146826564a55c5ca0164cac40348f5
