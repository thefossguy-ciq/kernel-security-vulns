From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53674: clk: Fix memory leak in devm_clk_notifier_register()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

clk: Fix memory leak in devm_clk_notifier_register()

devm_clk_notifier_register() allocates a devres resource for clk
notifier but didn't register that to the device, so the notifier didn't
get unregistered on device detach and the allocated resource was leaked.

Fix the issue by registering the resource through devres_add().

This issue was found with kmemleak on a Chromebook.

The Linux kernel CVE team has assigned CVE-2023-53674 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.11 with commit 6d30d50d037dfa092f9d5d1fffa348ab4abb7163 and fixed in 5.15.121 with commit a326cf0107b197e649bbaa2a2b1355894826ce32
	Issue introduced in 5.11 with commit 6d30d50d037dfa092f9d5d1fffa348ab4abb7163 and fixed in 6.1.39 with commit 49451db71b746df990888068961f1033f7c9b734
	Issue introduced in 5.11 with commit 6d30d50d037dfa092f9d5d1fffa348ab4abb7163 and fixed in 6.3.13 with commit cb1b04fd4283fc8f9acefe0ddc61ba072ed44877
	Issue introduced in 5.11 with commit 6d30d50d037dfa092f9d5d1fffa348ab4abb7163 and fixed in 6.4.4 with commit efbbda79b2881a04dcd0e8f28634933d79e17e49
	Issue introduced in 5.11 with commit 6d30d50d037dfa092f9d5d1fffa348ab4abb7163 and fixed in 6.5 with commit 7fb933e56f77a57ef7cfc59fc34cbbf1b1fa31ff

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53674
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/clk/clk.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/a326cf0107b197e649bbaa2a2b1355894826ce32
	https://git.kernel.org/stable/c/49451db71b746df990888068961f1033f7c9b734
	https://git.kernel.org/stable/c/cb1b04fd4283fc8f9acefe0ddc61ba072ed44877
	https://git.kernel.org/stable/c/efbbda79b2881a04dcd0e8f28634933d79e17e49
	https://git.kernel.org/stable/c/7fb933e56f77a57ef7cfc59fc34cbbf1b1fa31ff
