From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53288: drm/client: Fix memory leak in drm_client_modeset_probe

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

drm/client: Fix memory leak in drm_client_modeset_probe

When a new mode is set to modeset->mode, the previous mode should be freed.
This fixes the following kmemleak report:

drm_mode_duplicate+0x45/0x220 [drm]
drm_client_modeset_probe+0x944/0xf50 [drm]
__drm_fb_helper_initial_config_and_unlock+0xb4/0x2c0 [drm_kms_helper]
drm_fbdev_client_hotplug+0x2bc/0x4d0 [drm_kms_helper]
drm_client_register+0x169/0x240 [drm]
ast_pci_probe+0x142/0x190 [ast]
local_pci_probe+0xdc/0x180
work_for_cpu_fn+0x4e/0xa0
process_one_work+0x8b7/0x1540
worker_thread+0x70a/0xed0
kthread+0x29f/0x340
ret_from_fork+0x1f/0x30

The Linux kernel CVE team has assigned CVE-2023-53288 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.9 with commit a2889606636d135148de101fe3311dfea67baf1c and fixed in 5.4.251 with commit 5d580017bdb9b3e930b6009e467e5e1589f8ca8a
	Issue introduced in 4.9 with commit a2889606636d135148de101fe3311dfea67baf1c and fixed in 5.10.188 with commit 5f2a12f64347f535c6ef55fa7eb36a2874d69b59
	Issue introduced in 4.9 with commit a2889606636d135148de101fe3311dfea67baf1c and fixed in 5.15.123 with commit 1369d0c586ad44f2d18fe2f4cbc5bcb24132fa71
	Issue introduced in 4.9 with commit a2889606636d135148de101fe3311dfea67baf1c and fixed in 6.1.42 with commit 917bef37cfaca07781c6fbaf6cd9404d27e64e6f
	Issue introduced in 4.9 with commit a2889606636d135148de101fe3311dfea67baf1c and fixed in 6.4.7 with commit 8108a494639e56aea77e7196a1d6ea89792b9d4a
	Issue introduced in 4.9 with commit a2889606636d135148de101fe3311dfea67baf1c and fixed in 6.5 with commit 2329cc7a101af1a844fbf706c0724c0baea38365
	Issue introduced in 4.8.7 with commit 0cc98b5963f8886887aab0ded61970bdccfc2350

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53288
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/gpu/drm/drm_client_modeset.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/5d580017bdb9b3e930b6009e467e5e1589f8ca8a
	https://git.kernel.org/stable/c/5f2a12f64347f535c6ef55fa7eb36a2874d69b59
	https://git.kernel.org/stable/c/1369d0c586ad44f2d18fe2f4cbc5bcb24132fa71
	https://git.kernel.org/stable/c/917bef37cfaca07781c6fbaf6cd9404d27e64e6f
	https://git.kernel.org/stable/c/8108a494639e56aea77e7196a1d6ea89792b9d4a
	https://git.kernel.org/stable/c/2329cc7a101af1a844fbf706c0724c0baea38365
