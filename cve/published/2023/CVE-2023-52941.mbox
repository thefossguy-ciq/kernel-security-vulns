From bippy-5f407fcff5a0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-52941: can: isotp: split tx timer into transmission and timeout

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

can: isotp: split tx timer into transmission and timeout

The timer for the transmission of isotp PDUs formerly had two functions:
1. send two consecutive frames with a given time gap
2. monitor the timeouts for flow control frames and the echo frames

This led to larger txstate checks and potentially to a problem discovered
by syzbot which enabled the panic_on_warn feature while testing.

The former 'txtimer' function is split into 'txfrtimer' and 'txtimer'
to handle the two above functionalities with separate timer callbacks.

The two simplified timers now run in one-shot mode and make the state
transitions (especially with isotp_rcv_echo) better understandable.

The Linux kernel CVE team has assigned CVE-2023-52941 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 6.1 with commit 866337865f3747c68a3e7bb837611e39cec1ecd6 and fixed in 6.1.11 with commit cae4c9bc35f72af5d4a079bb9d9fd62c4088a411
	Issue introduced in 6.1 with commit 866337865f3747c68a3e7bb837611e39cec1ecd6 and fixed in 6.2 with commit 4f027cba8216f42a18b544842efab134f8b1f9f4
	Issue introduced in 6.0.9 with commit 3cb476cf834edca47f4470c276feb0f519401fb7

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-52941
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/can/isotp.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/cae4c9bc35f72af5d4a079bb9d9fd62c4088a411
	https://git.kernel.org/stable/c/4f027cba8216f42a18b544842efab134f8b1f9f4
