From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-54064: ipmi:ssif: Fix a memory leak when scanning for an adapter

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ipmi:ssif: Fix a memory leak when scanning for an adapter

The adapter scan ssif_info_find() sets info->adapter_name if the adapter
info came from SMBIOS, as it's not set in that case.  However, this
function can be called more than once, and it will leak the adapter name
if it had already been set.  So check for NULL before setting it.

The Linux kernel CVE team has assigned CVE-2023-54064 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4 with commit c4436c9149c5d2bc0c49ab57ec85c75ea1c4d61c and fixed in 5.4.257 with commit de677f4379fa67f650e367c188a0f80bee9b6732
	Issue introduced in 5.4 with commit c4436c9149c5d2bc0c49ab57ec85c75ea1c4d61c and fixed in 5.10.195 with commit 13623b966bb6d36ba61646b69cd49cdac6e4978a
	Issue introduced in 5.4 with commit c4436c9149c5d2bc0c49ab57ec85c75ea1c4d61c and fixed in 5.15.132 with commit 3ad53071fe8547eb8d8813971844cc43246008ee
	Issue introduced in 5.4 with commit c4436c9149c5d2bc0c49ab57ec85c75ea1c4d61c and fixed in 6.1.53 with commit 74a1194cce60a90723d0fe148863c18931a31153
	Issue introduced in 5.4 with commit c4436c9149c5d2bc0c49ab57ec85c75ea1c4d61c and fixed in 6.4.16 with commit 7db16d2e791bf2ec3e0249f56b7ec81c35bba6e6
	Issue introduced in 5.4 with commit c4436c9149c5d2bc0c49ab57ec85c75ea1c4d61c and fixed in 6.5.3 with commit b870caeb18041f856893066ded81c560db3d56cc
	Issue introduced in 5.4 with commit c4436c9149c5d2bc0c49ab57ec85c75ea1c4d61c and fixed in 6.6 with commit b8d72e32e1453d37ee5c8a219f24e7eeadc471ef

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-54064
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/char/ipmi/ipmi_ssif.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/de677f4379fa67f650e367c188a0f80bee9b6732
	https://git.kernel.org/stable/c/13623b966bb6d36ba61646b69cd49cdac6e4978a
	https://git.kernel.org/stable/c/3ad53071fe8547eb8d8813971844cc43246008ee
	https://git.kernel.org/stable/c/74a1194cce60a90723d0fe148863c18931a31153
	https://git.kernel.org/stable/c/7db16d2e791bf2ec3e0249f56b7ec81c35bba6e6
	https://git.kernel.org/stable/c/b870caeb18041f856893066ded81c560db3d56cc
	https://git.kernel.org/stable/c/b8d72e32e1453d37ee5c8a219f24e7eeadc471ef
