From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-54053: wifi: iwlwifi: pcie: fix possible NULL pointer dereference

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: iwlwifi: pcie: fix possible NULL pointer dereference

It is possible that iwl_pci_probe() will fail and free the trans,
then afterwards iwl_pci_remove() will be called and crash by trying
to access trans which is already freed, fix it.

iwlwifi 0000:01:00.0: Detected crf-id 0xa5a5a5a2, cnv-id 0xa5a5a5a2
		      wfpm id 0xa5a5a5a2
iwlwifi 0000:01:00.0: Can't find a correct rfid for crf id 0x5a2
...
BUG: kernel NULL pointer dereference, address: 0000000000000028
...
RIP: 0010:iwl_pci_remove+0x12/0x30 [iwlwifi]
pci_device_remove+0x3e/0xb0
device_release_driver_internal+0x103/0x1f0
driver_detach+0x4c/0x90
bus_remove_driver+0x5c/0xd0
driver_unregister+0x31/0x50
pci_unregister_driver+0x40/0x90
iwl_pci_unregister_driver+0x15/0x20 [iwlwifi]
__exit_compat+0x9/0x98 [iwlwifi]
__x64_sys_delete_module+0x147/0x260

The Linux kernel CVE team has assigned CVE-2023-54053 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.4 with commit 809805a820c6445f7a701ded24fdc6bbc841d1e4 and fixed in 5.4.244 with commit f6f2d16c77f936041b8ac495fceabded4ec6c83c
	Issue introduced in 5.4 with commit 809805a820c6445f7a701ded24fdc6bbc841d1e4 and fixed in 5.10.181 with commit 0fc0d287c1e7dcb39a3b9bb0f8679cd68c2156c7
	Issue introduced in 5.4 with commit 809805a820c6445f7a701ded24fdc6bbc841d1e4 and fixed in 5.15.113 with commit 7545f21eee1356ec98581125c4dba9c4c0cc7397
	Issue introduced in 5.4 with commit 809805a820c6445f7a701ded24fdc6bbc841d1e4 and fixed in 6.1.30 with commit 0f9a1bcb94016d3a3c455a77b01f6bb06e15f6eb
	Issue introduced in 5.4 with commit 809805a820c6445f7a701ded24fdc6bbc841d1e4 and fixed in 6.3.4 with commit dcd23aa6cc0ded7950b60ce1badb80b84045c6c0
	Issue introduced in 5.4 with commit 809805a820c6445f7a701ded24fdc6bbc841d1e4 and fixed in 6.4 with commit b655b9a9f8467684cfa8906713d33b71ea8c8f54

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-54053
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/wireless/intel/iwlwifi/pcie/drv.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/f6f2d16c77f936041b8ac495fceabded4ec6c83c
	https://git.kernel.org/stable/c/0fc0d287c1e7dcb39a3b9bb0f8679cd68c2156c7
	https://git.kernel.org/stable/c/7545f21eee1356ec98581125c4dba9c4c0cc7397
	https://git.kernel.org/stable/c/0f9a1bcb94016d3a3c455a77b01f6bb06e15f6eb
	https://git.kernel.org/stable/c/dcd23aa6cc0ded7950b60ce1badb80b84045c6c0
	https://git.kernel.org/stable/c/b655b9a9f8467684cfa8906713d33b71ea8c8f54
