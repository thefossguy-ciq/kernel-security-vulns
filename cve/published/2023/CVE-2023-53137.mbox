From bippy-1.1.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53137: ext4: Fix possible corruption when moving a directory

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ext4: Fix possible corruption when moving a directory

When we are renaming a directory to a different directory, we need to
update '..' entry in the moved directory. However nothing prevents moved
directory from being modified and even converted from the inline format
to the normal format. When such race happens the rename code gets
confused and we crash. Fix the problem by locking the moved directory.

The Linux kernel CVE team has assigned CVE-2023-53137 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.8 with commit 32f7f22c0b52e8189fef83986b16dc7abe95f2c4 and fixed in 5.4.237 with commit 8dac5a63cf79707b547ea3d425fead5f4482198f
	Issue introduced in 3.8 with commit 32f7f22c0b52e8189fef83986b16dc7abe95f2c4 and fixed in 5.10.175 with commit 0c440f14558bfacd22c6935ae1fd4b2a09e96b5d
	Issue introduced in 3.8 with commit 32f7f22c0b52e8189fef83986b16dc7abe95f2c4 and fixed in 5.15.103 with commit c50fc503ee1b97f12c98e26afc39fdaebebcf04f
	Issue introduced in 3.8 with commit 32f7f22c0b52e8189fef83986b16dc7abe95f2c4 and fixed in 6.1.20 with commit b0bb13612292ca90fa4c2a7e425375649bc50d3e
	Issue introduced in 3.8 with commit 32f7f22c0b52e8189fef83986b16dc7abe95f2c4 and fixed in 6.2.7 with commit 291cd19d107e197306869cb3237c1bba62d13182
	Issue introduced in 3.8 with commit 32f7f22c0b52e8189fef83986b16dc7abe95f2c4 and fixed in 6.3 with commit 0813299c586b175d7edb25f56412c54b812d0379

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53137
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/ext4/namei.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/8dac5a63cf79707b547ea3d425fead5f4482198f
	https://git.kernel.org/stable/c/0c440f14558bfacd22c6935ae1fd4b2a09e96b5d
	https://git.kernel.org/stable/c/c50fc503ee1b97f12c98e26afc39fdaebebcf04f
	https://git.kernel.org/stable/c/b0bb13612292ca90fa4c2a7e425375649bc50d3e
	https://git.kernel.org/stable/c/291cd19d107e197306869cb3237c1bba62d13182
	https://git.kernel.org/stable/c/0813299c586b175d7edb25f56412c54b812d0379
