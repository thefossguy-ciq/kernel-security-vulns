From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53454: HID: multitouch: Correct devm device reference for hidinput input_dev name

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

HID: multitouch: Correct devm device reference for hidinput input_dev name

Reference the HID device rather than the input device for the devm
allocation of the input_dev name. Referencing the input_dev would lead to a
use-after-free when the input_dev was unregistered and subsequently fires a
uevent that depends on the name. At the point of firing the uevent, the
name would be freed by devres management.

Use devm_kasprintf to simplify the logic for allocating memory and
formatting the input_dev name string.

The Linux kernel CVE team has assigned CVE-2023-53454 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 4.14.326 with commit ac0d389402a6ff9ad92cea02c2d8c711483b91ab
	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 4.19.295 with commit 39c70c19456e50dcb3abfe53539220dff0490f1d
	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 5.4.257 with commit df7ca43fe090e1a56c216c8ebc106ef5fd49afc6
	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 5.10.195 with commit 15ec7cb55e7d88755aa01d44a7a1015a42bfce86
	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 5.15.132 with commit dde88ab4e45beb60b217026207aa9c14c88d71ab
	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 6.1.53 with commit 2763732ec1e68910719c75b6b896e11b6d3d622b
	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 6.4.16 with commit 1d7833db9fd118415dace2ca157bfa603dec9c8c
	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 6.5.3 with commit b70ac7849248ec8128fa12f86e3655ba38838f29
	Issue introduced in 3.12 with commit c08d46aa805ba46d501f610c2448d07bea979780 and fixed in 6.6 with commit 4794394635293a3e74591351fff469cea7ad15a2

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53454
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/hid/hid-multitouch.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/ac0d389402a6ff9ad92cea02c2d8c711483b91ab
	https://git.kernel.org/stable/c/39c70c19456e50dcb3abfe53539220dff0490f1d
	https://git.kernel.org/stable/c/df7ca43fe090e1a56c216c8ebc106ef5fd49afc6
	https://git.kernel.org/stable/c/15ec7cb55e7d88755aa01d44a7a1015a42bfce86
	https://git.kernel.org/stable/c/dde88ab4e45beb60b217026207aa9c14c88d71ab
	https://git.kernel.org/stable/c/2763732ec1e68910719c75b6b896e11b6d3d622b
	https://git.kernel.org/stable/c/1d7833db9fd118415dace2ca157bfa603dec9c8c
	https://git.kernel.org/stable/c/b70ac7849248ec8128fa12f86e3655ba38838f29
	https://git.kernel.org/stable/c/4794394635293a3e74591351fff469cea7ad15a2
