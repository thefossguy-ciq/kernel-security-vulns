From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53683: fs: hfsplus: remove WARN_ON() from hfsplus_cat_{read,write}_inode()

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

fs: hfsplus: remove WARN_ON() from hfsplus_cat_{read,write}_inode()

syzbot is hitting WARN_ON() in hfsplus_cat_{read,write}_inode(), for
crafted filesystem image can contain bogus length. There conditions are
not kernel bugs that can justify kernel to panic.

The Linux kernel CVE team has assigned CVE-2023-53683 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.14.303 with commit f62f5ee63052324ad94dd05091743d9e09f72070 and fixed in 4.14.316 with commit 61af77acd039ffd221bf7adf0dc95d0a4d377505
	Issue introduced in 4.19.270 with commit ab778439c6fa0071698b62a351f79d319fd72c53 and fixed in 4.19.284 with commit c074913b12db3632b11588b31bbfb0fa80a0a1c9
	Issue introduced in 5.4.229 with commit 781fa141414ef18b52f15037497155f80bf0ecab and fixed in 5.4.244 with commit a75d9211a07fed513c08c5d4861c4a36ac6a74fe
	Issue introduced in 5.10.163 with commit 1f881d9201f6e0a917004a14329f9ff3d0bfa1e5 and fixed in 5.10.181 with commit c8daee66585897a4c90d937c91e762100237bff9
	Issue introduced in 5.15.87 with commit 48d9e2e6de01ed35e965eb549758a837c07b601d and fixed in 5.15.113 with commit 37cab61a52d6f42b2d961c51bcf369f09e235fb5
	Issue introduced in 5.16 with commit 55d1cbbbb29e6656c662ee8f73ba1fc4777532eb and fixed in 6.1.30 with commit 48960a503fcec76d3f72347b7e679dda08ca43be
	Issue introduced in 5.16 with commit 55d1cbbbb29e6656c662ee8f73ba1fc4777532eb and fixed in 6.3.4 with commit 3a9d68d84b2e41ba3f2a727b36f035fad6800492
	Issue introduced in 5.16 with commit 55d1cbbbb29e6656c662ee8f73ba1fc4777532eb and fixed in 6.4 with commit 81b21c0f0138ff5a499eafc3eb0578ad2a99622c

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53683
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	fs/hfsplus/inode.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/61af77acd039ffd221bf7adf0dc95d0a4d377505
	https://git.kernel.org/stable/c/c074913b12db3632b11588b31bbfb0fa80a0a1c9
	https://git.kernel.org/stable/c/a75d9211a07fed513c08c5d4861c4a36ac6a74fe
	https://git.kernel.org/stable/c/c8daee66585897a4c90d937c91e762100237bff9
	https://git.kernel.org/stable/c/37cab61a52d6f42b2d961c51bcf369f09e235fb5
	https://git.kernel.org/stable/c/48960a503fcec76d3f72347b7e679dda08ca43be
	https://git.kernel.org/stable/c/3a9d68d84b2e41ba3f2a727b36f035fad6800492
	https://git.kernel.org/stable/c/81b21c0f0138ff5a499eafc3eb0578ad2a99622c
