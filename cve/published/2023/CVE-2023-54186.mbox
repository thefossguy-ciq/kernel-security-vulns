From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-54186: usb: typec: altmodes/displayport: fix pin_assignment_show

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

usb: typec: altmodes/displayport: fix pin_assignment_show

This patch fixes negative indexing of buf array in pin_assignment_show
when get_current_pin_assignments returns 0 i.e. no compatible pin
assignments are found.

BUG: KASAN: use-after-free in pin_assignment_show+0x26c/0x33c
...
Call trace:
dump_backtrace+0x110/0x204
dump_stack_lvl+0x84/0xbc
print_report+0x358/0x974
kasan_report+0x9c/0xfc
__do_kernel_fault+0xd4/0x2d4
do_bad_area+0x48/0x168
do_tag_check_fault+0x24/0x38
do_mem_abort+0x6c/0x14c
el1_abort+0x44/0x68
el1h_64_sync_handler+0x64/0xa4
el1h_64_sync+0x78/0x7c
pin_assignment_show+0x26c/0x33c
dev_attr_show+0x50/0xc0

The Linux kernel CVE team has assigned CVE-2023-54186 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.19 with commit 0e3bb7d6894d9b6e67d6382bb03a46a1dc989588 and fixed in 4.19.284 with commit 0e61a7432fcd4bca06f05b7f1c7d7cb461880fe2
	Issue introduced in 4.19 with commit 0e3bb7d6894d9b6e67d6382bb03a46a1dc989588 and fixed in 5.4.244 with commit 4f9c0a7c272626cb6716ffc7800e8c73260cdce6
	Issue introduced in 4.19 with commit 0e3bb7d6894d9b6e67d6382bb03a46a1dc989588 and fixed in 5.10.181 with commit ff466f77d0a56719979c4234abd412abd98eae8f
	Issue introduced in 4.19 with commit 0e3bb7d6894d9b6e67d6382bb03a46a1dc989588 and fixed in 5.15.113 with commit fc0e18f95c88435bd8a1ceb540243cd7fbcd9781
	Issue introduced in 4.19 with commit 0e3bb7d6894d9b6e67d6382bb03a46a1dc989588 and fixed in 6.1.30 with commit 08bd1be1c716fd50a7df48f82dcbc59a103082b5
	Issue introduced in 4.19 with commit 0e3bb7d6894d9b6e67d6382bb03a46a1dc989588 and fixed in 6.3.4 with commit 54ee23e4ab263a495ace1eed43d3883212ece17f
	Issue introduced in 4.19 with commit 0e3bb7d6894d9b6e67d6382bb03a46a1dc989588 and fixed in 6.4 with commit d8f28269dd4bf9b55c3fb376ae31512730a96fce

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-54186
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/usb/typec/altmodes/displayport.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/0e61a7432fcd4bca06f05b7f1c7d7cb461880fe2
	https://git.kernel.org/stable/c/4f9c0a7c272626cb6716ffc7800e8c73260cdce6
	https://git.kernel.org/stable/c/ff466f77d0a56719979c4234abd412abd98eae8f
	https://git.kernel.org/stable/c/fc0e18f95c88435bd8a1ceb540243cd7fbcd9781
	https://git.kernel.org/stable/c/08bd1be1c716fd50a7df48f82dcbc59a103082b5
	https://git.kernel.org/stable/c/54ee23e4ab263a495ace1eed43d3883212ece17f
	https://git.kernel.org/stable/c/d8f28269dd4bf9b55c3fb376ae31512730a96fce
