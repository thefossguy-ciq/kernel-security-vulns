From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-54294: md/raid10: fix memleak of md thread

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

md/raid10: fix memleak of md thread

In raid10_run(), if setup_conf() succeed and raid10_run() failed before
setting 'mddev->thread', then in the error path 'conf->thread' is not
freed.

Fix the problem by setting 'mddev->thread' right after setup_conf().

The Linux kernel CVE team has assigned CVE-2023-54294 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 4.16 with commit 43a521238aca0e24d50add1db125a61bda2a3527 and fixed in 4.19.283 with commit abf4d67060c8f63caff096e5fca1564bfef1e5d4
	Issue introduced in 4.16 with commit 43a521238aca0e24d50add1db125a61bda2a3527 and fixed in 5.4.243 with commit 3725b35fc0e5e4eea0434ef625f3d92f3059d080
	Issue introduced in 4.16 with commit 43a521238aca0e24d50add1db125a61bda2a3527 and fixed in 5.10.180 with commit 2a65555f7e0f4a05b663879908a991e6d9f81e51
	Issue introduced in 4.16 with commit 43a521238aca0e24d50add1db125a61bda2a3527 and fixed in 5.15.111 with commit d6cfcf98b824591cffa4c1e9889fb4fa619359fe
	Issue introduced in 4.16 with commit 43a521238aca0e24d50add1db125a61bda2a3527 and fixed in 6.1.28 with commit 36ba0c7b86acd9c2ea80a273204d52c21c955471
	Issue introduced in 4.16 with commit 43a521238aca0e24d50add1db125a61bda2a3527 and fixed in 6.2.15 with commit 5d763f708b0f918fb87799e33c25113ae6081216
	Issue introduced in 4.16 with commit 43a521238aca0e24d50add1db125a61bda2a3527 and fixed in 6.3.2 with commit ec473e82e10d39a02eb59b0b95e546119a3bdb79
	Issue introduced in 4.16 with commit 43a521238aca0e24d50add1db125a61bda2a3527 and fixed in 6.4 with commit f0ddb83da3cbbf8a1f9087a642c448ff52ee9abd

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-54294
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/md/raid10.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/abf4d67060c8f63caff096e5fca1564bfef1e5d4
	https://git.kernel.org/stable/c/3725b35fc0e5e4eea0434ef625f3d92f3059d080
	https://git.kernel.org/stable/c/2a65555f7e0f4a05b663879908a991e6d9f81e51
	https://git.kernel.org/stable/c/d6cfcf98b824591cffa4c1e9889fb4fa619359fe
	https://git.kernel.org/stable/c/36ba0c7b86acd9c2ea80a273204d52c21c955471
	https://git.kernel.org/stable/c/5d763f708b0f918fb87799e33c25113ae6081216
	https://git.kernel.org/stable/c/ec473e82e10d39a02eb59b0b95e546119a3bdb79
	https://git.kernel.org/stable/c/f0ddb83da3cbbf8a1f9087a642c448ff52ee9abd
