From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53712: ARM: 9317/1: kexec: Make smp stop calls asynchronous

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

ARM: 9317/1: kexec: Make smp stop calls asynchronous

If a panic is triggered by a hrtimer interrupt all online cpus will be
notified and set offline. But as highlighted by commit 19dbdcb8039c
("smp: Warn on function calls from softirq context") this call should
not be made synchronous with disabled interrupts:

 softdog: Initiating panic
 Kernel panic - not syncing: Software Watchdog Timer expired
 WARNING: CPU: 1 PID: 0 at kernel/smp.c:753 smp_call_function_many_cond
   unwind_backtrace:
     show_stack
     dump_stack_lvl
     __warn
     warn_slowpath_fmt
     smp_call_function_many_cond
     smp_call_function
     crash_smp_send_stop.part.0
     machine_crash_shutdown
     __crash_kexec
     panic
     softdog_fire
     __hrtimer_run_queues
     hrtimer_interrupt

Make the smp call for machine_crash_nonpanic_core() asynchronous.

The Linux kernel CVE team has assigned CVE-2023-53712 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.38 with commit b23065313297e750edd57ab6edfd36224826724e and fixed in 5.15.133 with commit 46870eea5496ff277e86187a49ac5a667cfe60c4
	Issue introduced in 2.6.38 with commit b23065313297e750edd57ab6edfd36224826724e and fixed in 6.1.55 with commit ee378f45a70d09b51373ba495d30d99ef12219c1
	Issue introduced in 2.6.38 with commit b23065313297e750edd57ab6edfd36224826724e and fixed in 6.5.5 with commit 5590ba4560eefbd19a4ed07c7e7c8e4c51ffc628
	Issue introduced in 2.6.38 with commit b23065313297e750edd57ab6edfd36224826724e and fixed in 6.6 with commit 8922ba71c969d2a0c01a94372a71477d879470de

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53712
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	arch/arm/kernel/machine_kexec.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/46870eea5496ff277e86187a49ac5a667cfe60c4
	https://git.kernel.org/stable/c/ee378f45a70d09b51373ba495d30d99ef12219c1
	https://git.kernel.org/stable/c/5590ba4560eefbd19a4ed07c7e7c8e4c51ffc628
	https://git.kernel.org/stable/c/8922ba71c969d2a0c01a94372a71477d879470de
