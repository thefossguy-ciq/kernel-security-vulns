{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nfirmware: arm_ffa: Fix FFA device names for logical partitions\n\nEach physical partition can provide multiple services each with UUID.\nEach such service can be presented as logical partition with a unique\ncombination of VM ID and UUID. The number of distinct UUID in a system\nwill be less than or equal to the number of logical partitions.\n\nHowever, currently it fails to register more than one logical partition\nor service within a physical partition as the device name contains only\nVM ID while both VM ID and UUID are maintained in the partition information.\nThe kernel complains with the below message:\n\n  | sysfs: cannot create duplicate filename '/devices/arm-ffa-8001'\n  | CPU: 1 PID: 1 Comm: swapper/0 Not tainted 6.3.0-rc7 #8\n  | Hardware name: FVP Base RevC (DT)\n  | Call trace:\n  |  dump_backtrace+0xf8/0x118\n  |  show_stack+0x18/0x24\n  |  dump_stack_lvl+0x50/0x68\n  |  dump_stack+0x18/0x24\n  |  sysfs_create_dir_ns+0xe0/0x13c\n  |  kobject_add_internal+0x220/0x3d4\n  |  kobject_add+0x94/0x100\n  |  device_add+0x144/0x5d8\n  |  device_register+0x20/0x30\n  |  ffa_device_register+0x88/0xd8\n  |  ffa_setup_partitions+0x108/0x1b8\n  |  ffa_init+0x2ec/0x3a4\n  |  do_one_initcall+0xcc/0x240\n  |  do_initcall_level+0x8c/0xac\n  |  do_initcalls+0x54/0x94\n  |  do_basic_setup+0x1c/0x28\n  |  kernel_init_freeable+0x100/0x16c\n  |  kernel_init+0x20/0x1a0\n  |  ret_from_fork+0x10/0x20\n  | kobject_add_internal failed for arm-ffa-8001 with -EEXIST, don't try to\n  | register things with the same name in the same directory.\n  | arm_ffa arm-ffa: unable to register device arm-ffa-8001 err=-17\n  | ARM FF-A: ffa_setup_partitions: failed to register partition ID 0x8001\n\nBy virtue of being random enough to avoid collisions when generated in a\ndistributed system, there is no way to compress UUID keys to the number\nof bits required to identify each. We can eliminate '-' in the name but\nit is not worth eliminating 4 bytes and add unnecessary logic for doing\nthat. Also v1.0 doesn't provide the UUID of the partitions which makes\nit hard to use the same for the device name.\n\nSo to keep it simple, let us alloc an ID using ida_alloc() and append the\nsame to \"arm-ffa\" to make up a unique device name. Also stash the id value\nin ffa_dev to help freeing the ID later when the device is destroyed."
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/firmware/arm_ffa/bus.c",
                  "include/linux/arm_ffa.h"
               ],
               "versions": [
                  {
                     "version": "e781858488b918e30a6ff28e9eab6058b787e3b3",
                     "lessThan": "c2f65991097a62efbdb2bed3c06fc86b08c9593b",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "e781858488b918e30a6ff28e9eab6058b787e3b3",
                     "lessThan": "dfc5aaa57f52a5800c339369d235fa30fb734feb",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "e781858488b918e30a6ff28e9eab6058b787e3b3",
                     "lessThan": "93d0cbe88118fcef234d3ebcbdadcb9ebe9d34f1",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "e781858488b918e30a6ff28e9eab6058b787e3b3",
                     "lessThan": "19b8766459c41c6f318f8a548cc1c66dffd18363",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "drivers/firmware/arm_ffa/bus.c",
                  "include/linux/arm_ffa.h"
               ],
               "versions": [
                  {
                     "version": "5.14",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "5.14",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "5.15.114",
                     "lessThanOrEqual": "5.15.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.1.31",
                     "lessThanOrEqual": "6.1.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.3.5",
                     "lessThanOrEqual": "6.3.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.4",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.14",
                           "versionEndExcluding": "5.15.114"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.14",
                           "versionEndExcluding": "6.1.31"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.14",
                           "versionEndExcluding": "6.3.5"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "5.14",
                           "versionEndExcluding": "6.4"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/c2f65991097a62efbdb2bed3c06fc86b08c9593b"
            },
            {
               "url": "https://git.kernel.org/stable/c/dfc5aaa57f52a5800c339369d235fa30fb734feb"
            },
            {
               "url": "https://git.kernel.org/stable/c/93d0cbe88118fcef234d3ebcbdadcb9ebe9d34f1"
            },
            {
               "url": "https://git.kernel.org/stable/c/19b8766459c41c6f318f8a548cc1c66dffd18363"
            }
         ],
         "title": "firmware: arm_ffa: Fix FFA device names for logical partitions",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-53256",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
