From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53153: wifi: cfg80211: Fix use after free for wext

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

wifi: cfg80211: Fix use after free for wext

Key information in wext.connect is not reset on (re)connect and can hold
data from a previous connection.

Reset key data to avoid that drivers or mac80211 incorrectly detect a
WEP connection request and access the freed or already reused memory.

Additionally optimize cfg80211_sme_connect() and avoid an useless
schedule of conn_work.

The Linux kernel CVE team has assigned CVE-2023-53153 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 2.6.32 with commit fffd0934b9390f34bec45762192b7edd3b12b4b5 and fixed in 4.14.308 with commit 66af4a2ab1d65d556d638cb9555a3b823c2557a9
	Issue introduced in 2.6.32 with commit fffd0934b9390f34bec45762192b7edd3b12b4b5 and fixed in 4.19.276 with commit a2a92b3e9d8e03ee3f9ee407fc46a9b4bd02d8b6
	Issue introduced in 2.6.32 with commit fffd0934b9390f34bec45762192b7edd3b12b4b5 and fixed in 5.4.235 with commit 6f1959c17d4cb5b74af6fc31dc787e1dc3e4f6e2
	Issue introduced in 2.6.32 with commit fffd0934b9390f34bec45762192b7edd3b12b4b5 and fixed in 5.10.173 with commit 2cfe78619b0de6d2da773978bc2d22797212eaa7
	Issue introduced in 2.6.32 with commit fffd0934b9390f34bec45762192b7edd3b12b4b5 and fixed in 5.15.99 with commit fd081afd21eb35b968b0330700c43ec94986e1c4
	Issue introduced in 2.6.32 with commit fffd0934b9390f34bec45762192b7edd3b12b4b5 and fixed in 6.1.16 with commit 22dfb21bf1cd876616d45cda1bc6daa89eec6747
	Issue introduced in 2.6.32 with commit fffd0934b9390f34bec45762192b7edd3b12b4b5 and fixed in 6.2.3 with commit f4b6a138efb8a32507b8946104e32cb926308da7
	Issue introduced in 2.6.32 with commit fffd0934b9390f34bec45762192b7edd3b12b4b5 and fixed in 6.3 with commit 015b8cc5e7c4d7bb671f1984d7b7338c310b185b

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53153
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	net/wireless/sme.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/66af4a2ab1d65d556d638cb9555a3b823c2557a9
	https://git.kernel.org/stable/c/a2a92b3e9d8e03ee3f9ee407fc46a9b4bd02d8b6
	https://git.kernel.org/stable/c/6f1959c17d4cb5b74af6fc31dc787e1dc3e4f6e2
	https://git.kernel.org/stable/c/2cfe78619b0de6d2da773978bc2d22797212eaa7
	https://git.kernel.org/stable/c/fd081afd21eb35b968b0330700c43ec94986e1c4
	https://git.kernel.org/stable/c/22dfb21bf1cd876616d45cda1bc6daa89eec6747
	https://git.kernel.org/stable/c/f4b6a138efb8a32507b8946104e32cb926308da7
	https://git.kernel.org/stable/c/015b8cc5e7c4d7bb671f1984d7b7338c310b185b
