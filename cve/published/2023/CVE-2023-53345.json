{
   "containers": {
      "cna": {
         "providerMetadata": {
            "orgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038"
         },
         "descriptions": [
            {
               "lang": "en",
               "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nrxrpc: Fix potential data race in rxrpc_wait_to_be_connected()\n\nInside the loop in rxrpc_wait_to_be_connected() it checks call->error to\nsee if it should exit the loop without first checking the call state.  This\nis probably safe as if call->error is set, the call is dead anyway, but we\nshould probably wait for the call state to have been set to completion\nfirst, lest it cause surprise on the way out.\n\nFix this by only accessing call->error if the call is complete.  We don't\nactually need to access the error inside the loop as we'll do that after.\n\nThis caused the following report:\n\n    BUG: KCSAN: data-race in rxrpc_send_data / rxrpc_set_call_completion\n\n    write to 0xffff888159cf3c50 of 4 bytes by task 25673 on cpu 1:\n     rxrpc_set_call_completion+0x71/0x1c0 net/rxrpc/call_state.c:22\n     rxrpc_send_data_packet+0xba9/0x1650 net/rxrpc/output.c:479\n     rxrpc_transmit_one+0x1e/0x130 net/rxrpc/output.c:714\n     rxrpc_decant_prepared_tx net/rxrpc/call_event.c:326 [inline]\n     rxrpc_transmit_some_data+0x496/0x600 net/rxrpc/call_event.c:350\n     rxrpc_input_call_event+0x564/0x1220 net/rxrpc/call_event.c:464\n     rxrpc_io_thread+0x307/0x1d80 net/rxrpc/io_thread.c:461\n     kthread+0x1ac/0x1e0 kernel/kthread.c:376\n     ret_from_fork+0x1f/0x30 arch/x86/entry/entry_64.S:308\n\n    read to 0xffff888159cf3c50 of 4 bytes by task 25672 on cpu 0:\n     rxrpc_send_data+0x29e/0x1950 net/rxrpc/sendmsg.c:296\n     rxrpc_do_sendmsg+0xb7a/0xc20 net/rxrpc/sendmsg.c:726\n     rxrpc_sendmsg+0x413/0x520 net/rxrpc/af_rxrpc.c:565\n     sock_sendmsg_nosec net/socket.c:724 [inline]\n     sock_sendmsg net/socket.c:747 [inline]\n     ____sys_sendmsg+0x375/0x4c0 net/socket.c:2501\n     ___sys_sendmsg net/socket.c:2555 [inline]\n     __sys_sendmmsg+0x263/0x500 net/socket.c:2641\n     __do_sys_sendmmsg net/socket.c:2670 [inline]\n     __se_sys_sendmmsg net/socket.c:2667 [inline]\n     __x64_sys_sendmmsg+0x57/0x60 net/socket.c:2667\n     do_syscall_x64 arch/x86/entry/common.c:50 [inline]\n     do_syscall_64+0x41/0xc0 arch/x86/entry/common.c:80\n     entry_SYSCALL_64_after_hwframe+0x63/0xcd\n\n    value changed: 0x00000000 -> 0xffffffea"
            }
         ],
         "affected": [
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "unaffected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/rxrpc/sendmsg.c"
               ],
               "versions": [
                  {
                     "version": "9d35d880e0e4a3ab32d8c12f9e4d76198aadd42d",
                     "lessThan": "3e8ba61a3fe4475a9b5c9fbfc664435c6795d872",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "9d35d880e0e4a3ab32d8c12f9e4d76198aadd42d",
                     "lessThan": "454e48a9ff04c5fa1631bb172070fcb6389b97f9",
                     "status": "affected",
                     "versionType": "git"
                  },
                  {
                     "version": "9d35d880e0e4a3ab32d8c12f9e4d76198aadd42d",
                     "lessThan": "2b5fdc0f5caa505afe34d608e2eefadadf2ee67a",
                     "status": "affected",
                     "versionType": "git"
                  }
               ]
            },
            {
               "product": "Linux",
               "vendor": "Linux",
               "defaultStatus": "affected",
               "repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
               "programFiles": [
                  "net/rxrpc/sendmsg.c"
               ],
               "versions": [
                  {
                     "version": "6.2",
                     "status": "affected"
                  },
                  {
                     "version": "0",
                     "lessThan": "6.2",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.2.16",
                     "lessThanOrEqual": "6.2.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.3.3",
                     "lessThanOrEqual": "6.3.*",
                     "status": "unaffected",
                     "versionType": "semver"
                  },
                  {
                     "version": "6.4",
                     "lessThanOrEqual": "*",
                     "status": "unaffected",
                     "versionType": "original_commit_for_fix"
                  }
               ]
            }
         ],
         "cpeApplicability": [
            {
               "nodes": [
                  {
                     "operator": "OR",
                     "negate": false,
                     "cpeMatch": [
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.2",
                           "versionEndExcluding": "6.2.16"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.2",
                           "versionEndExcluding": "6.3.3"
                        },
                        {
                           "vulnerable": true,
                           "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*",
                           "versionStartIncluding": "6.2",
                           "versionEndExcluding": "6.4"
                        }
                     ]
                  }
               ]
            }
         ],
         "references": [
            {
               "url": "https://git.kernel.org/stable/c/3e8ba61a3fe4475a9b5c9fbfc664435c6795d872"
            },
            {
               "url": "https://git.kernel.org/stable/c/454e48a9ff04c5fa1631bb172070fcb6389b97f9"
            },
            {
               "url": "https://git.kernel.org/stable/c/2b5fdc0f5caa505afe34d608e2eefadadf2ee67a"
            }
         ],
         "title": "rxrpc: Fix potential data race in rxrpc_wait_to_be_connected()",
         "x_generator": {
            "engine": "bippy-1.2.0"
         }
      }
   },
   "cveMetadata": {
      "assignerOrgId": "f4215fc3-5b6b-47ff-a258-f7189bd81038",
      "cveID": "CVE-2023-53345",
      "requesterUserId": "gregkh@kernel.org",
      "serial": "1",
      "state": "PUBLISHED"
   },
   "dataType": "CVE_RECORD",
   "dataVersion": "5.0"
}
