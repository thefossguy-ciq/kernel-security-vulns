From bippy-1.2.0 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@kernel.org>
To: <linux-cve-announce@vger.kernel.org>
Reply-to: <cve@kernel.org>, <linux-kernel@vger.kernel.org>
Subject: CVE-2023-53654: octeontx2-af: Add validation before accessing cgx and lmac

Description
===========

In the Linux kernel, the following vulnerability has been resolved:

octeontx2-af: Add validation before accessing cgx and lmac

with the addition of new MAC blocks like CN10K RPM and CN10KB
RPM_USX, LMACs are noncontiguous and CGX blocks are also
noncontiguous. But during RVU driver initialization, the driver
is assuming they are contiguous and trying to access
cgx or lmac with their id which is resulting in kernel panic.

This patch fixes the issue by adding proper checks.

[   23.219150] pc : cgx_lmac_read+0x38/0x70
[   23.219154] lr : rvu_program_channels+0x3f0/0x498
[   23.223852] sp : ffff000100d6fc80
[   23.227158] x29: ffff000100d6fc80 x28: ffff00010009f880 x27:
000000000000005a
[   23.234288] x26: ffff000102586768 x25: 0000000000002500 x24:
fffffffffff0f000

The Linux kernel CVE team has assigned CVE-2023-53654 to this issue.


Affected and fixed versions
===========================

	Issue introduced in 5.12 with commit 91c6945ea1f9059fea886630d0fd8070740e2aaf and fixed in 5.15.121 with commit e425e2ba933618ee5ec8e4f3eb341efeb6c9ddef
	Issue introduced in 5.12 with commit 91c6945ea1f9059fea886630d0fd8070740e2aaf and fixed in 6.1.39 with commit a5485a943193e55c79150382e6461e8ea759e96e
	Issue introduced in 5.12 with commit 91c6945ea1f9059fea886630d0fd8070740e2aaf and fixed in 6.4.4 with commit b04872e15f3df62cb2fd530950f769626e1ef489
	Issue introduced in 5.12 with commit 91c6945ea1f9059fea886630d0fd8070740e2aaf and fixed in 6.5 with commit 79ebb53772c95d3a6ae51b3c65f9985fdd430df6

Please see https://www.kernel.org for a full list of currently supported
kernel versions by the kernel community.

Unaffected versions might change over time as fixes are backported to
older supported kernel versions.  The official CVE entry at
	https://cve.org/CVERecord/?id=CVE-2023-53654
will be updated if fixes are backported, please check that for the most
up to date information about this issue.


Affected files
==============

The file(s) affected by this issue are:
	drivers/net/ethernet/marvell/octeontx2/af/cgx.c


Mitigation
==========

The Linux kernel CVE team recommends that you update to the latest
stable kernel version for this, and many other bugfixes.  Individual
changes are never tested alone, but rather are part of a larger kernel
release.  Cherry-picking individual commits is not recommended or
supported by the Linux kernel community at all.  If however, updating to
the latest release is impossible, the individual changes to resolve this
issue can be found at these commits:
	https://git.kernel.org/stable/c/e425e2ba933618ee5ec8e4f3eb341efeb6c9ddef
	https://git.kernel.org/stable/c/a5485a943193e55c79150382e6461e8ea759e96e
	https://git.kernel.org/stable/c/b04872e15f3df62cb2fd530950f769626e1ef489
	https://git.kernel.org/stable/c/79ebb53772c95d3a6ae51b3c65f9985fdd430df6
